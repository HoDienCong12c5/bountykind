{"version":3,"file":"pixi3d.min.js","sources":["../../src/compatibility/versions/version-530.ts","../../node_modules/tslib/tslib.es6.js","../../src/compatibility/versions/version-600.ts","../../src/compatibility/compatibility-access.ts","../../src/compatibility/versions/version-650.ts","../../src/compatibility/compatibility.ts","../../src/gltf/gltf-asset.ts","../../src/loader/gltf-loader.ts","../../src/loader/gltf-binary-loader.ts","../../src/transform/observable-point.ts","../../node_modules/gl-matrix/esm/common.js","../../node_modules/gl-matrix/esm/mat4.js","../../node_modules/gl-matrix/esm/vec3.js","../../node_modules/gl-matrix/esm/vec4.js","../../node_modules/gl-matrix/esm/quat.js","../../node_modules/gl-matrix/esm/mat3.js","../../src/math/quat.ts","../../src/transform/observable-quaternion.ts","../../src/math/mat4.ts","../../src/math/vec3.ts","../../src/math/vec4.ts","../../src/transform/matrix-component.ts","../../src/transform/matrix4.ts","../../src/transform/transform.ts","../../src/container.ts","../../src/math/ray.ts","../../src/camera/camera.ts","../../src/camera/camera-orbit-control.ts","../../src/mesh/geometry/plane-geometry.ts","../../src/mesh/geometry/cube-geometry.ts","../../src/mesh/geometry/quad-geometry.ts","../../src/mesh/geometry/mesh-geometry.ts","../../src/mesh/instanced-mesh.ts","../../src/lighting/light-type.ts","../../src/material/standard/standard-material-alpha-mode.ts","../../src/material/standard/standard-material-debug-mode.ts","../../src/capabilities.ts","../../src/compatibility/buffer-resource.ts","../../src/message.ts","../../src/material/standard/standard-material-feature-set.ts","../../src/material/standard/standard-material-matrix-texture.ts","../../src/debug.ts","../../src/mesh/mesh-shader.ts","../../src/material/standard/standard-shader-source.ts","../../src/material/standard/standard-shader-instancing.ts","../../src/material/standard/shader/metallic-roughness.frag","../../src/material/material-render-sort-type.ts","../../src/material/standard/shader/primitive.vert","../../src/material/standard/standard-shader.ts","../../src/material/material.ts","../../src/lighting/lighting-environment.ts","../../src/material/standard/standard-material-skin-uniforms.ts","../../src/mesh/geometry/sphere-geometry.ts","../../src/color.ts","../../src/material/standard/instanced-standard-material.ts","../../src/gltf/gltf-material.ts","../../src/math/mat3.ts","../../src/texture/texture-transform.ts","../../src/material/standard/standard-material-texture.ts","../../src/material/standard/standard-material-normal-texture.ts","../../src/material/standard/standard-material-occlusion-texture.ts","../../src/material/standard/standard-material-factory.ts","../../src/lighting/image-based-lighting.ts","../../src/lighting/assets/lut-ggx.png","../../src/material/standard/standard-material.ts","../../src/math/aabb.ts","../../src/mesh/mesh.ts","../../src/animation.ts","../../src/gltf/animation/gltf-animation.ts","../../src/gltf/gltf-attribute.ts","../../src/skinning/skin.ts","../../src/skinning/joint.ts","../../src/gltf/animation/gltf-linear.ts","../../src/gltf/animation/gltf-cubic-spline.ts","../../src/gltf/animation/gltf-step.ts","../../src/gltf/animation/gltf-interpolation-factory.ts","../../src/gltf/animation/gltf-channel.ts","../../src/gltf/animation/gltf-rotation.ts","../../src/gltf/animation/gltf-scale.ts","../../src/gltf/animation/gltf-spherical-linear.ts","../../src/gltf/animation/gltf-translation.ts","../../src/gltf/animation/gltf-weights.ts","../../src/gltf/animation/gltf-channel-factory.ts","../../src/gltf/gltf-parser.ts","../../src/instanced-model.ts","../../src/model.ts","../../src/lighting/light.ts","../../src/pipeline/material-render-pass.ts","../../src/shadow/shader/gaussian-blur.vert","../../src/shadow/shader/gaussian-blur.frag","../../src/shadow/shadow-filter.ts","../../src/shadow/shader/shadow.vert","../../src/shadow/shader/shadow.frag","../../src/shadow/shadow-shader.ts","../../src/shadow/skinning-shader.ts","../../src/shadow/texture-shader.ts","../../src/shadow/shadow-renderer.ts","../../src/shadow/shadow-render-pass.ts","../../src/sprite/post-processing-sprite.ts","../../src/sprite/sprite-batch-geometry.ts","../../src/sprite/shader/sprite.vert","../../src/sprite/shader/sprite.frag","../../src/sprite/sprite-batch-renderer.ts","../../src/pipeline/standard-pipeline.ts","../../src/compatibility/array-resource.ts","../../src/compatibility/base-image-resource.ts","../../src/cubemap/mipmap-resource.ts","../../src/cubemap/cubemap-resource.ts","../../src/compatibility/cube-resource.ts","../../src/cubemap/cubemap.ts","../../src/loader/cubemap-loader.ts","../../src/loader/shader-source-loader.ts","../../src/skybox/shader/skybox.vert","../../src/picking/picking-id.ts","../../src/skybox/shader/skybox.frag","../../src/skybox/skybox-material.ts","../../src/skybox/skybox.ts","../../src/picking/shader/picking.vert","../../src/picking/shader/picking.frag","../../src/picking/picking-map.ts","../../src/picking/picking-interaction.ts","../../src/picking/picking-hitarea.ts","../../src/shadow/shadow-quality.ts","../../src/shadow/shadow-texture.ts","../../src/shadow/shadow-math.ts","../../src/shadow/shadow-casting-light.ts","../../src/math/plane.ts","../../src/sprite/sprite-billboard-type.ts","../../src/sprite/projection-sprite.ts","../../src/sprite/sprite.ts"],"sourcesContent":["import { Renderer, RenderTexture } from \"@pixi/core\"\nimport { Loader } from \"@pixi/loaders\"\nimport { DisplayObject } from \"@pixi/display\"\nimport { CompatibilityVersion } from \"../compatibility-version\"\n\nexport class Version530 implements CompatibilityVersion {\n  installRendererPlugin(name: string, plugin: any): void {\n    Renderer.registerPlugin(name, plugin)\n  }\n  installLoaderPlugin(name: string, plugin: any): void {\n    Loader.registerPlugin(plugin)\n  }\n  render(renderer: Renderer, object: DisplayObject, renderTexture: RenderTexture): void {\n    renderer.render(object, renderTexture)\n  }\n}","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || from);\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { DisplayObject } from \"@pixi/display\"\nimport { Renderer, RenderTexture } from \"@pixi/core\"\nimport { Version530 } from \"./version-530\"\n\nexport class Version600 extends Version530 {\n  render(renderer: Renderer, object: DisplayObject, renderTexture: RenderTexture): void {\n    renderer.render(object, { renderTexture: renderTexture })\n  }\n}","\n/**\n * Used for not getting bundlers like webpack and rollup to report\n * warnings/errors about missing exports from PixiJS.\n */\nexport namespace CompatibilityAccess {\n  export function get<TObj, TKey extends keyof TObj>(obj: TObj, key: TKey) {\n    return obj[key]\n  }\n}","import * as PixiCore from \"@pixi/core\"\nimport { CompatibilityAccess } from \"../compatibility-access\"\nimport { Version600 } from \"./version-600\"\n\nexport class Version650 extends Version600 {\n  installRendererPlugin(name: string, plugin: any): void {\n    plugin.extension = {\n      type: CompatibilityAccess.get(PixiCore, \"ExtensionType\").RendererPlugin,\n      name: name\n    }\n    CompatibilityAccess.get(PixiCore, \"extensions\").add(plugin)\n  }\n  installLoaderPlugin(name: string, plugin: any): void {\n    plugin.extension = {\n      type: CompatibilityAccess.get(PixiCore, \"ExtensionType\").Loader,\n      name: name\n    }\n    CompatibilityAccess.get(PixiCore, \"extensions\").add(plugin)\n  }\n}","import * as PixiCore from \"@pixi/core\"\nimport { CompatibilityVersion } from \"./compatibility-version\"\nimport { Version530 } from \"./versions/version-530\"\nimport { Version600 } from \"./versions/version-600\"\nimport { Version650 } from \"./versions/version-650\"\n\nexport const Compatibility: CompatibilityVersion = \"extensions\" in PixiCore ? new Version650() : \"ArrayResource\" in PixiCore ? new Version600() : new Version530()","import { Texture } from \"@pixi/core\"\nimport { glTFResourceLoader } from \"./gltf-resource-loader\"\n\n/**\n * glTF assets are JSON files plus supporting external data.\n */\nexport class glTFAsset {\n  /**\n   * Creates a new glTF asset using the specified JSON descriptor.\n   * @param descriptor The JSON descriptor to create the asset from.\n   * @param buffers The buffers used by this asset.\n   * @param images The images used by this asset.\n   */\n  constructor(readonly descriptor: any, readonly buffers: ArrayBuffer[] = [], readonly images: Texture[] = []) { }\n\n  /**\n   * Loads a new glTF asset (including resources) using the specified JSON \n   * descriptor.\n   * @param descriptor The JSON descriptor to create the asset from.\n   * @param loader The resource loader to use for external resources. The \n   * loader can be empty when all resources in the descriptor is embedded.\n   * @param cb Callback when all resources have been loaded.\n   */\n  static load(descriptor: any, loader?: glTFResourceLoader, cb?: (asset: glTFAsset) => void) {\n    let asset = new glTFAsset(descriptor)\n    loadBuffers(descriptor, buffers => {\n      buffers.forEach(buffer => asset.buffers.push(buffer))\n      loadImages(descriptor, buffers, images => {\n        images.forEach(image => asset.images.push(image))\n        cb && cb(asset)\n      }, loader)\n    }, loader)\n    return asset\n  }\n\n  /**\n   * Returns a value indicating if the specified data buffer is a valid glTF.\n   * @param buffer The buffer data to validate.\n   */\n  static isValidBuffer(buffer: ArrayBuffer) {\n    const header = new Uint32Array(buffer, 0, 3)\n    if (header[0] === 0x46546C67 && header[1] === 2) {\n      return true\n    }\n    return false\n  }\n\n  /**\n   * Returns a value indicating if the specified uri is embedded.\n   * @param uri The uri to check.\n   */\n  static isEmbeddedResource(uri: string) {\n    return uri && uri.startsWith(\"data:\")\n  }\n\n  /**\n   * Creates a new glTF asset from binary (glb) buffer data.\n   * @param data The binary buffer data to read from.\n   * @param cb The function which gets called when the asset has been \n   * created.\n   */\n  static fromBuffer(data: ArrayBuffer, cb: (gltf: glTFAsset) => void) {\n    const chunks: { type: number, offset: number, length: number }[] = []\n    let offset = 3 * 4\n    while (offset < data.byteLength) {\n      const header = new Uint32Array(data, offset, 3)\n      chunks.push({\n        length: header[0], type: header[1], offset: offset + 2 * 4\n      })\n      offset += header[0] + 2 * 4\n    }\n    const json = new Uint8Array(data, chunks[0].offset, chunks[0].length)\n    const descriptor = JSON.parse(new TextDecoder(\"utf-8\").decode(json))\n    const buffers: ArrayBuffer[] = []\n    for (let i = 1; i < chunks.length; i++) {\n      buffers.push(data.slice(chunks[i].offset, chunks[i].offset + chunks[i].length))\n    }\n    loadImages(descriptor, buffers, images => {\n      cb(new glTFAsset(descriptor, buffers, images))\n    })\n  }\n}\n\nfunction loadImages(descriptor: any, buffers: ArrayBuffer[], cb: (images: Texture[]) => void, loader?: glTFResourceLoader) {\n  const images: Texture[] = []\n\n  if (!descriptor.images || descriptor.images.length === 0) {\n    return cb(images)\n  }\n\n  let embeddedImages = descriptor.images\n    .filter((img: any) => typeof img.bufferView !== \"number\" && glTFAsset.isEmbeddedResource(img.uri))\n    .map((img: any, index: number) => index)\n\n  let externalImages = descriptor.images\n    .filter((img: any) => typeof img.bufferView !== \"number\" && !glTFAsset.isEmbeddedResource(img.uri))\n    .map((img: any, index: number) => index)\n\n  let bufferImages = descriptor.images\n    .filter((img: any) => typeof img.bufferView === \"number\")\n    .map((img: any, index: number) => index)\n\n  for (let i = 0; i < embeddedImages.length; i++) {\n    let index = embeddedImages[i]\n    let image: { uri: string } = descriptor.images[index]\n    images[index] = Texture.from(image.uri)\n  }\n\n  if (bufferImages.length === 0 && externalImages.length === 0) {\n    return cb(images)\n  }\n  if (externalImages.length > 0 && !loader) {\n    throw new Error(\"PIXI3D: A resource loader is required when image is external.\")\n  }\n\n  const loadExternalImage = (image: any, index: number, cb: () => void) => {\n    loader?.load(image.uri, (resource) => {\n      if (resource.texture) {\n        images[index] = resource.texture; cb()\n      }\n    })\n  }\n  const loadBufferImage = (image: any, index: number, cb: () => void) => {\n    loadImageFromBuffer(image, descriptor, buffers, image => {\n      images[index] = image; cb()\n    })\n  }\n  let externalImagesCount = externalImages.length\n  let bufferImagesCount = bufferImages.length\n\n  for (let i = 0; i < externalImages.length; i++) {\n    let index = externalImages[i]\n    let image: { bufferView: number, uri: string } = descriptor.images[index]\n    loadExternalImage(image, index, () => {\n      if (--externalImagesCount === 0 && bufferImagesCount === 0) {\n        cb(images)\n      }\n    })\n  }\n  for (let i = 0; i < bufferImages.length; i++) {\n    let index = bufferImages[i]\n    let image: { bufferView: number, uri: string } = descriptor.images[index]\n    loadBufferImage(image, index, () => {\n      if (--bufferImagesCount === 0 && externalImagesCount === 0) {\n        cb(images)\n      }\n    })\n  }\n}\n\nfunction loadBuffers(descriptor: any, cb: (buffers: ArrayBuffer[]) => void, loader?: glTFResourceLoader) {\n  const buffers: ArrayBuffer[] = []\n\n  const embeddedBuffers = descriptor.buffers\n    .filter((buffer: any) => glTFAsset.isEmbeddedResource(buffer.uri))\n    .map((buffer: any, index: number) => index)\n\n  for (let i = 0; i < embeddedBuffers.length; i++) {\n    let index = embeddedBuffers[i]\n    let buffer = descriptor.buffers[index]\n    buffers[index] = createBufferFromBase64(buffer.uri)\n  }\n\n  const externalBuffers = descriptor.buffers\n    .filter((buffer: any) => !glTFAsset.isEmbeddedResource(buffer.uri))\n    .map((buffer: any, index: number) => index)\n\n  if (externalBuffers.length === 0) {\n    return cb(buffers)\n  }\n  if (!loader) {\n    throw new Error(\"PIXI3D: A resource loader is required when buffer is not embedded.\")\n  }\n\n  const loadExternalBuffer = (uri: string, index: number, cb: () => void) => {\n    loader.load(uri, (resource) => {\n      buffers[index] = resource.data\n      cb()\n    })\n  }\n\n  let externalBuffersCount = externalBuffers.length\n  for (let i = 0; i < externalBuffers.length; i++) {\n    let index = externalBuffers[i]\n    let buffer = descriptor.buffers[index]\n    loadExternalBuffer(buffer.uri, index, () => {\n      if (--externalBuffersCount === 0) {\n        cb(buffers)\n      }\n    })\n  }\n}\n\nfunction loadImageFromBuffer(image: any, descriptor: any, buffers: ArrayBuffer[], cb: (image: Texture) => void) {\n  const view = descriptor.bufferViews[image.bufferView]\n  const array = new Uint8Array(buffers[view.buffer], view.byteOffset, view.byteLength)\n  const blob = new Blob([array], { \"type\": image.mimeType })\n  const reader = new FileReader()\n  reader.onload = () => {\n    cb(Texture.from(<string>reader.result))\n  }\n  reader.readAsDataURL(blob)\n}\n\nfunction createBufferFromBase64(value: string) {\n  return Uint8Array.from(atob(value.split(\",\")[1]), c => c.charCodeAt(0)).buffer\n}","import { ILoaderResource, LoaderResource, Loader } from \"@pixi/loaders\"\nimport { Compatibility } from \"../compatibility/compatibility\"\nimport { glTFAsset } from \"../gltf/gltf-asset\"\nimport { glTFResourceLoader } from \"../gltf/gltf-resource-loader\"\n\nexport const glTFLoader = {\n  use: function (resource: ILoaderResource, next: () => void) {\n    if (resource.extension !== \"gltf\") {\n      return next()\n    }\n    let loader = <Loader><unknown>this\n    glTFAsset.load(resource.data, new glTFExternalResourceLoader(loader, resource), gltf => {\n      Object.assign(resource, { gltf }); next()\n    })\n  },\n  add: function () {\n    LoaderResource.setExtensionXhrType(\n      \"bin\", LoaderResource.XHR_RESPONSE_TYPE.BUFFER)\n    LoaderResource.setExtensionXhrType(\n      \"gltf\", LoaderResource.XHR_RESPONSE_TYPE.JSON)\n  }\n}\n\nCompatibility.installLoaderPlugin(\"gltf\", glTFLoader)\n\nclass glTFExternalResourceLoader implements glTFResourceLoader {\n  constructor(private _loader: Loader, private _resource: ILoaderResource) {\n  }\n\n  load(uri: string, onComplete: (resource: ILoaderResource) => void) {\n    const url = this._resource.url.substring(\n      0, this._resource.url.lastIndexOf(\"/\") + 1) + uri\n\n    if (!this._loader.resources[url]) {\n      // The resource does not exists and needs to be loaded.\n      // @ts-ignore\n      this._loader.add({ parentResource: this._resource, url, onComplete })\n    } else if (this._loader.resources[url].data) {\n      // The resource already exists, just use that one.\n      onComplete(this._loader.resources[url])\n    } else {\n      // The resource is in queue to be loaded, wait for it.\n      let binding = this._loader.onProgress.add((_, resource) => {\n        if (resource.url === url) {\n          onComplete(resource); binding.detach()\n        }\n      })\n    }\n  }\n}","import { ILoaderResource, LoaderResource } from \"@pixi/loaders\"\nimport { glTFAsset } from \"../gltf/gltf-asset\"\nimport { Compatibility } from \"../compatibility/compatibility\"\n\nexport const glTFBinaryLoader = {\n  use: function (resource: ILoaderResource, next: () => void) {\n    if (resource.extension !== \"glb\") {\n      return next()\n    }\n    if (glTFAsset.isValidBuffer(resource.data)) {\n      glTFAsset.fromBuffer(resource.data, gltf => {\n        Object.assign(resource, { gltf }); next()\n      })\n    } else {\n      return next()\n    }\n  },\n  add: function () {\n    LoaderResource.setExtensionXhrType(\n      \"glb\", LoaderResource.XHR_RESPONSE_TYPE.BUFFER)\n  }\n}\n\nCompatibility.installLoaderPlugin(\"cubemap\", glTFBinaryLoader)","import { ObservablePoint, IPoint } from \"@pixi/math\"\n\n/**\n * Represents a point in 3D space.\n */\nexport class ObservablePoint3D extends ObservablePoint {\n  private _array = new Float32Array(3)\n\n  /** Array containing the x, y, z values. */\n  get array() {\n    return this._array\n  }\n\n  set array(value: Float32Array) {\n    this.setFrom(value)\n  }\n\n  /**\n   * Creates a new observable point.\n   * @param cb The callback when changed.\n   * @param scope The owner of callback.\n   * @param x The position on the x axis.\n   * @param y The position on the y axis.\n   * @param z The position on the z axis.\n   */\n  constructor(cb: () => void, scope: any, x = 0, y = 0, z = 0) {\n    super(cb, scope)\n    this._array.set([x, y, z])\n  }\n\n  /**\n   * Position on the x axis relative to the local coordinates of the parent.\n   */\n  get x() {\n    return this._array[0]\n  }\n\n  set x(value: number) {\n    if (this._array[0] !== value) {\n      this._array[0] = value\n      this.cb.call(this.scope)\n    }\n  }\n\n  /**\n   * Position on the y axis relative to the local coordinates of the parent.\n   */\n  get y() {\n    return this._array[1]\n  }\n\n  set y(value: number) {\n    if (this._array[1] !== value) {\n      this._array[1] = value\n      this.cb.call(this.scope)\n    }\n  }\n\n  /**\n   * Position on the z axis relative to the local coordinates of the parent.\n   */\n  get z() {\n    return this._array[2]\n  }\n\n  set z(value: number) {\n    if (this._array[2] !== value) {\n      this._array[2] = value\n      this.cb.call(this.scope)\n    }\n  }\n\n  clone(cb = this.cb, scope = this.scope) {\n    return new ObservablePoint3D(cb, scope, this.x, this.y, this.z)\n  }\n\n  copyFrom(p: ObservablePoint3D) {\n    if (this._array[0] !== p.x || this._array[1] !== p.y || this._array[2] !== p.z) {\n      this._array[0] = p.x\n      this._array[1] = p.y\n      this._array[2] = p.z\n      this.cb.call(this.scope)\n    }\n    return this\n  }\n\n  copyTo<T extends IPoint>(p: T) {\n    if (p instanceof ObservablePoint3D) {\n      p.set(this.x, this.y, this.z)\n    }\n    return <T>p\n  }\n\n  equals(p: ObservablePoint3D): boolean {\n    return p.x === this.x && p.y === this.y && p.z === this.z\n  }\n\n  /**\n   * Sets the point to a new x, y and z position.\n   * @param x The position on the x axis.\n   * @param y The position on the y axis.\n   * @param z The position on the z axis.\n   */\n  set(x: number, y = x, z = x) {\n    if (this._array[0] !== x || this._array[1] !== y || this._array[2] !== z) {\n      this._array[0] = x\n      this._array[1] = y\n      this._array[2] = z\n      this.cb.call(this.scope)\n    }\n    return this\n  }\n\n  /**\n   * Sets the point to a new x, y and z position.\n   * @param array The array containing x, y and z, expected length is 3.\n   */\n  setFrom(array: ArrayLike<number>) {\n    this.set(array[0], array[1], array[2]); return this\n  }\n}","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import { quat } from \"gl-matrix\"\n\nexport class Quat {\n  static set(x: number, y: number, z: number, w: number, out = new Float32Array(4)) {\n    return <Float32Array>quat.set(out, x, y, z, w)\n  }\n  static fromValues(x: number, y: number, z: number, w: number) {\n    return <Float32Array>quat.fromValues(x, y, z, w)\n  }\n  static create() {\n    return <Float32Array>quat.create()\n  }\n  static normalize(a: Float32Array, out = new Float32Array(4)) {\n    return <Float32Array>quat.normalize(out, a)\n  }\n  static slerp(a: Float32Array, b: Float32Array, t: number, out = new Float32Array(4)) {\n    return <Float32Array>quat.slerp(out, a, b, t)\n  }\n  static fromEuler(x: number, y: number, z: number, out = new Float32Array(4)) {\n    return <Float32Array>quat.fromEuler(out, x, y, z)\n  }\n  static conjugate(a: Float32Array, out = new Float32Array(4)) {\n    return <Float32Array>quat.conjugate(out, a)\n  }\n  static rotateX(a: Float32Array, rad: number, out = new Float32Array(4)) {\n    return <Float32Array>quat.rotateX(out, a, rad)\n  }\n  static rotateY(a: Float32Array, rad: number, out = new Float32Array(4)) {\n    return <Float32Array>quat.rotateY(out, a, rad)\n  }\n  static rotateZ(a: Float32Array, rad: number, out = new Float32Array(4)) {\n    return <Float32Array>quat.rotateZ(out, a, rad)\n  }\n}","import { ObservablePoint, IPoint } from \"@pixi/math\"\nimport { Quat } from \"../math/quat\"\n\n/**\n * Represents a rotation quaternion in 3D space.\n */\nexport class ObservableQuaternion extends ObservablePoint {\n  private _array = new Float32Array(4)\n\n  /** Array containing the x, y, z, w values. */\n  get array() {\n    return this._array\n  }\n\n  set array(value: Float32Array) {\n    this.setFrom(value)\n  }\n\n  /**\n   * Creates a new observable quaternion.\n   * @param cb The callback when changed.\n   * @param scope The owner of callback.\n   * @param x The x component.\n   * @param y The y component.\n   * @param z The z component.\n   * @param w The w component.\n   */\n  constructor(cb: () => void, scope: any, x = 0, y = 0, z = 0, w = 1) {\n    super(cb, scope)\n    this._array.set([x, y, z, w])\n  }\n\n  /** The x component of the quaternion. */\n  get x() {\n    return this._array[0]\n  }\n\n  set x(value: number) {\n    if (this._array[0] !== value) {\n      this._array[0] = value\n      this.cb.call(this.scope)\n    }\n  }\n\n  /** The y component of the quaternion. */\n  get y() {\n    return this._array[1]\n  }\n\n  set y(value: number) {\n    if (this._array[1] !== value) {\n      this._array[1] = value\n      this.cb.call(this.scope)\n    }\n  }\n\n  /** The z component of the quaternion. */\n  get z() {\n    return this._array[2]\n  }\n\n  set z(value: number) {\n    if (this._array[2] !== value) {\n      this._array[2] = value\n      this.cb.call(this.scope)\n    }\n  }\n\n  /** The w component of the quaternion. */\n  get w() {\n    return this._array[3]\n  }\n\n  set w(value: number) {\n    if (this._array[3] !== value) {\n      this._array[3] = value\n      this.cb.call(this.scope)\n    }\n  }\n\n  /**\n   * Sets the euler angles in degrees.\n   * @param x The x angle.\n   * @param y The y angle.\n   * @param z The z angle.\n   */\n  setEulerAngles(x: number, y: number, z: number) {\n    Quat.fromEuler(x, y, z, this._array); this.cb.call(this.scope)\n  }\n\n  /**\n   * Creates a clone of this quaternion.\n   * @param cb Callback when changed.\n   * @param scope Owner of callback.\n   */\n  clone(cb = this.cb, scope = this.scope) {\n    return new ObservableQuaternion(cb, scope, this.x, this.y, this.z, this.w)\n  }\n\n  /**\n   * Copies x, y, z, and w from the given quaternion.\n   * @param p The quaternion to copy from.\n   */\n  copyFrom(p: ObservableQuaternion) {\n    if (this._array[0] !== p.x || this._array[1] !== p.y || this._array[2] !== p.z || this._array[3] !== p.w) {\n      this._array[0] = p.x\n      this._array[1] = p.y\n      this._array[2] = p.z\n      this._array[3] = p.w\n      this.cb.call(this.scope)\n    }\n    return this\n  }\n\n  /**\n   * Copies x, y, z and w into the given quaternion.\n   * @param p The quaternion to copy to.\n   */\n  copyTo<T extends IPoint>(p: T) {\n    if (p instanceof ObservableQuaternion) {\n      p.set(this.x, this.y, this.z, this.w)\n    }\n    return <T>p\n  }\n\n  /**\n   * Returns true if the given quaternion is equal to this quaternion.\n   * @param p The quaternion to check.\n   */\n  equals(p: ObservableQuaternion) {\n    return p.x === this.x && p.y === this.y && p.z === this.z && p.w === this.w\n  }\n\n  /**\n   * Sets the quaternion to new x, y, z and w components.\n   * @param x X component to set.\n   * @param y Y component to set.\n   * @param z Z component to set.\n   * @param w W component to set.\n   */\n  set(x: number, y = x, z = x, w = x) {\n    if (this._array[0] !== x || this._array[1] !== y || this._array[2] !== z || this._array[3] !== w) {\n      this._array[0] = x\n      this._array[1] = y\n      this._array[2] = z\n      this._array[3] = w\n      this.cb.call(this.scope)\n    }\n    return this\n  }\n\n  /**\n   * Sets the quaternion to a new x, y, z and w components.\n   * @param array The array containing x, y, z and w, expected length is 4.\n   */\n  setFrom(array: ArrayLike<number>) {\n    this.set(array[0], array[1], array[2], array[3]); return this\n  }\n}","import { mat4 } from \"gl-matrix\"\n\nexport class Mat4 {\n  static getTranslation(mat: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>mat4.getTranslation(out, mat)\n  }\n  static create() {\n    return <Float32Array>mat4.create()\n  }\n  static translate(mat: Float32Array, v: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.translate(out, mat, v)\n  }\n  static getScaling(mat: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>mat4.getScaling(out, mat)\n  }\n  static getRotation(mat: Float32Array, out = new Float32Array(4)) {\n    return <Float32Array>mat4.getRotation(out, mat)\n  }\n  static copy(a: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.copy(out, a)\n  }\n  static fromQuat(q: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.fromQuat(out, q)\n  }\n  static fromRotationTranslationScale(q: Float32Array, v: Float32Array, s: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.fromRotationTranslationScale(out, q, v, s)\n  }\n  static fromRotation(rad: number, axis: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.fromRotation(out, rad, axis)\n  }\n  static fromScaling(v: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.fromScaling(out, v)\n  }\n  static fromTranslation(v: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.fromTranslation(out, v)\n  }\n  static multiply(a: Float32Array, b: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.multiply(out, a, b)\n  }\n  static lookAt(eye: Float32Array, center: Float32Array, up: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.lookAt(out, eye, center, up)\n  }\n  static identity(out = new Float32Array(16)) {\n    return <Float32Array>mat4.identity(out)\n  }\n  static perspective(fovy: number, aspect: number, near: number, far: number, out = new Float32Array(16)) {\n    return <Float32Array>mat4.perspective(out, fovy, aspect, near, far)\n  }\n  static ortho(left: number, right: number, bottom: number, top: number, near: number, far: number, out = new Float32Array(16)) {\n    return <Float32Array>mat4.ortho(out, left, right, bottom, top, near, far)\n  }\n  static invert(a: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.invert(out, a)\n  }\n  static transpose(a: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.transpose(out, a)\n  }\n  static targetTo(eye: Float32Array, target: Float32Array, up: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.targetTo(out, eye, target, up)\n  }\n  static rotateX(a: Float32Array, rad: number, out = new Float32Array(16)) {\n    return <Float32Array>mat4.rotateX(out, a, rad)\n  }\n  static rotateY(a: Float32Array, rad: number, out = new Float32Array(16)) {\n    return <Float32Array>mat4.rotateY(out, a, rad)\n  }\n  static rotateZ(a: Float32Array, rad: number, out = new Float32Array(16)) {\n    return <Float32Array>mat4.rotateZ(out, a, rad)\n  }\n  static rotate(a: Float32Array, rad: number, axis: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.rotate(out, a, rad, axis)\n  }\n  static scale(a: Float32Array, v: Float32Array, out = new Float32Array(16)) {\n    return <Float32Array>mat4.scale(out, a, v)\n  }\n}","import { vec3 } from \"gl-matrix\"\n\nexport class Vec3 {\n  static set(x: number, y: number, z: number, out = new Float32Array(3)) {\n    return <Float32Array>vec3.set(out, x, y, z)\n  }\n  static fromValues(x: number, y: number, z: number) {\n    return <Float32Array>vec3.fromValues(x, y, z)\n  }\n  static create() {\n    return <Float32Array>vec3.create()\n  }\n  static add(a: Float32Array, b: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.add(out, a, b)\n  }\n  static transformQuat(a: Float32Array, q: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.transformQuat(out, a, q)\n  }\n  static subtract(a: Float32Array, b: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.subtract(out, a, b)\n  }\n  static scale(a: Float32Array, b: number, out = new Float32Array(3)) {\n    return <Float32Array>vec3.scale(out, a, b)\n  }\n  static dot(a: Float32Array, b: Float32Array) {\n    return vec3.dot(a, b)\n  }\n  static normalize(a: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.normalize(out, a)\n  }\n  static cross(a: Float32Array, b: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.cross(out, a, b)\n  }\n  static transformMat4(a: Float32Array, m: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.transformMat4(out, a, m)\n  }\n  static copy(a: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.copy(out, a)\n  }\n  static magnitude(a: Float32Array) {\n    return vec3.length(a)\n  }\n  static squaredMagnitude(a: Float32Array) {\n    return vec3.squaredLength(a)\n  }\n  static inverse(a: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.inverse(out, a)\n  }\n  static negate(a: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.negate(out, a)\n  }\n  static multiply(a: Float32Array, b: Float32Array, out = new Float32Array(3)) {\n    return <Float32Array>vec3.multiply(out, a, b)\n  }\n  static distance(a: Float32Array, b: Float32Array) {\n    return vec3.distance(a, b)\n  }\n  static squaredDistance(a: Float32Array, b: Float32Array) {\n    return vec3.squaredDistance(a, b)\n  }\n  static lerp(a: Float32Array, b: Float32Array, t: number, out = new Float32Array(3)) {\n    return vec3.lerp(out, a, b, t)\n  }\n}","import { vec4 } from \"gl-matrix\"\n\nexport class Vec4 {\n  static set(x: number, y: number, z: number, w: number, out = new Float32Array(4)) {\n    return <Float32Array>vec4.set(out, x, y, z, w)\n  }\n  static transformMat4(a: Float32Array, m: Float32Array, out = new Float32Array(4)) {\n    return <Float32Array>vec4.transformMat4(out, a, m)\n  }\n  static fromValues(x: number, y: number, z: number, w: number) {\n    return <Float32Array>vec4.fromValues(x, y, z, w)\n  }\n}","import { TransformId } from \"./transform-id\"\n\nexport class MatrixComponent {\n  private _id?: number\n  private _array: Float32Array\n\n  constructor(private _parent: TransformId, size: number, private _update: (array: Float32Array) => void) {\n    this._array = new Float32Array(size)\n  }\n\n  get array() {\n    if (this._id !== this._parent.transformId) {\n      this._update(this._array); this._id = this._parent.transformId\n    }\n    return this._array\n  }\n}","import { Matrix } from \"@pixi/math\"\nimport { ObservablePoint3D } from \"./observable-point\"\nimport { ObservableQuaternion } from \"./observable-quaternion\"\nimport { Mat4 } from \"../math/mat4\"\nimport { Vec3 } from \"../math/vec3\"\nimport { Vec4 } from \"../math/vec4\"\nimport { MatrixComponent } from \"./matrix-component\"\nimport { Quat } from \"../math/quat\"\nimport { TransformId } from \"./transform-id\"\n\n/**\n * Represents a 4x4 matrix.\n */\nexport class Matrix4 extends Matrix implements TransformId {\n  private _transformId = 0\n  private _position?: MatrixComponent\n  private _scaling?: MatrixComponent\n  private _rotation?: MatrixComponent\n  private _up?: MatrixComponent\n  private _down?: MatrixComponent\n  private _forward?: MatrixComponent\n  private _left?: MatrixComponent\n  private _right?: MatrixComponent\n  private _backward?: MatrixComponent\n\n  get transformId() {\n    return this._transformId\n  }\n\n  /** The array containing the matrix data. */\n  public array: Float32Array\n\n  /**\n   * Creates a new transform matrix using the specified matrix array.\n   * @param array The matrix array, expected length is 16. If empty, an identity \n   * matrix is used by default.\n   */\n  constructor(array?: ArrayLike<number>) {\n    super()\n    if (array) {\n      this.array = new Float32Array(array)\n    } else {\n      this.array = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])\n    }\n  }\n\n  toArray(transpose: boolean, out?: Float32Array) {\n    if (transpose) {\n      return Mat4.transpose(this.array, out)\n    }\n    return out ? Mat4.copy(this.array, out) : this.array\n  }\n\n  /** Returns the position component of the matrix. */\n  get position() {\n    if (!this._position) {\n      this._position = new MatrixComponent(this, 3, data => {\n        Mat4.getTranslation(this.array, data)\n      })\n    }\n    return this._position.array\n  }\n\n  /** Returns the scaling component of the matrix. */\n  get scaling() {\n    if (!this._scaling) {\n      this._scaling = new MatrixComponent(this, 3, data => {\n        Mat4.getScaling(this.array, data)\n      })\n    }\n    return this._scaling.array\n  }\n\n  /** Returns the rotation quaternion of the matrix. */\n  get rotation() {\n    if (!this._rotation) {\n      let matrix = new Float32Array(16)\n      this._rotation = new MatrixComponent(this, 4, data => {\n        // To extract a correct rotation, the scaling component must be eliminated.\n        for (let col of [0, 1, 2]) {\n          matrix[col + 0] = this.array[col + 0] / this.scaling[0]\n          matrix[col + 4] = this.array[col + 4] / this.scaling[1]\n          matrix[col + 8] = this.array[col + 8] / this.scaling[2]\n        }\n        Quat.normalize(Mat4.getRotation(matrix, data), data)\n      })\n    }\n    return this._rotation.array\n  }\n\n  /** Returns the up vector of the matrix. */\n  get up() {\n    if (!this._up) {\n      this._up = new MatrixComponent(this, 3, data => {\n        Vec3.normalize(Vec3.set(this.array[4], this.array[5], this.array[6], data), data)\n      })\n    }\n    return this._up.array\n  }\n\n  /** Returns the down vector of the matrix. */\n  get down() {\n    if (!this._down) {\n      this._down = new MatrixComponent(this, 3, data => {\n        Vec3.negate(this.up, data)\n      })\n    }\n    return this._down.array\n  }\n\n  /** Returns the left vector of the matrix. */\n  get right() {\n    if (!this._right) {\n      this._right = new MatrixComponent(this, 3, data => {\n        Vec3.negate(this.left, data)\n      })\n    }\n    return this._right.array\n  }\n\n  /** Returns the right vector of the matrix. */\n  get left() {\n    if (!this._left) {\n      this._left = new MatrixComponent(this, 3, data => {\n        Vec3.normalize(Vec3.cross(this.up, this.forward, data), data)\n      })\n    }\n    return this._left.array\n  }\n\n  /** Returns the forward vector of the matrix. */\n  get forward() {\n    if (!this._forward) {\n      this._forward = new MatrixComponent(this, 3, data => {\n        Vec3.normalize(Vec3.set(this.array[8], this.array[9], this.array[10], data), data)\n      })\n    }\n    return this._forward.array\n  }\n\n  /** Returns the backward vector of the matrix. */\n  get backward() {\n    if (!this._backward) {\n      this._backward = new MatrixComponent(this, 3, data => {\n        Vec3.negate(this.forward, data)\n      })\n    }\n    return this._backward.array\n  }\n\n  copyFrom(matrix: Matrix4) {\n    if (matrix instanceof Matrix4) {\n      Mat4.copy(matrix.array, this.array); this._transformId++\n    }\n    return this\n  }\n\n  /**\n   * Sets the rotation, position and scale components. \n   * @param rotation The rotation to set.\n   * @param position The position to set.\n   * @param scaling The scale to set.\n   */\n  setFromRotationPositionScale(rotation: ObservableQuaternion, position: ObservablePoint3D, scaling: ObservablePoint3D) {\n    Vec4.set(rotation.x, rotation.y, rotation.z, rotation.w, this.rotation)\n    Vec3.set(scaling.x, scaling.y, scaling.z, this.scaling)\n    Vec3.set(position.x, position.y, position.z, this.position)\n    Mat4.fromRotationTranslationScale(this.rotation, this.position, this.scaling, this.array); this._transformId++\n  }\n\n  /**\n   * Multiplies this matrix with another matrix.\n   * @param matrix The matrix to multiply with.\n   */\n  multiply(matrix: Matrix4) {\n    Mat4.multiply(matrix.array, this.array, this.array); this._transformId++\n  }\n}","import { Transform } from \"@pixi/math\"\nimport { Matrix4 } from \"./matrix4\"\nimport { ObservablePoint3D } from \"./observable-point\"\nimport { ObservableQuaternion } from \"./observable-quaternion\"\nimport { Mat4 } from \"../math/mat4\"\n\n/**\n * Handles position, scaling and rotation in 3D.\n */\nexport class Transform3D extends Transform {\n\n  /** The position in local space. */\n  position = new ObservablePoint3D(this.onChange, this, 0, 0, 0)\n\n  /** The scale in local space. */\n  scale = new ObservablePoint3D(this.onChange, this, 1, 1, 1)\n\n  /** The rotation in local space. */\n  rotationQuaternion = new ObservableQuaternion(this.onChange, this, 0, 0, 0, 1)\n\n  /** The transformation matrix in world space. */\n  worldTransform = new Matrix4()\n\n  /** The transformation matrix in local space. */\n  localTransform = new Matrix4()\n\n  /** The inverse transformation matrix in world space. */\n  inverseWorldTransform = new Matrix4()\n\n  /** The normal transformation matrix. */\n  normalTransform = new Matrix4()\n\n  /**\n   * Updates the local transformation matrix.\n   */\n  updateLocalTransform() {\n    if (this._localID === this._currentLocalID) {\n      return\n    }\n    this.localTransform.setFromRotationPositionScale(\n      this.rotationQuaternion, this.position, this.scale)\n\n    this._parentID = -1\n    this._currentLocalID = this._localID\n  }\n\n  /**\n   * Sets position, rotation and scale from a matrix array.\n   * @param matrix The matrix to set.\n   */\n  setFromMatrix(matrix: Matrix4) {\n    this.localTransform.copyFrom(matrix)\n\n    this.position.set(this.localTransform.position[0], this.localTransform.position[1], this.localTransform.position[2])\n    this.scale.set(this.localTransform.scaling[0], this.localTransform.scaling[1], this.localTransform.scaling[2])\n    this.rotationQuaternion.set(this.localTransform.rotation[0], this.localTransform.rotation[1], this.localTransform.rotation[2], this.localTransform.rotation[3])\n  }\n\n  /**\n   * Updates the world transformation matrix.\n   * @param parentTransform The parent transform.\n   */\n  updateTransform(parentTransform?: Transform) {\n    this.updateLocalTransform()\n    if (parentTransform && this._parentID === parentTransform._worldID) {\n      return\n    }\n    this.worldTransform.copyFrom(this.localTransform)\n    if (parentTransform instanceof Transform3D) {\n      this.worldTransform.multiply(parentTransform.worldTransform)\n    }\n    Mat4.invert(this.worldTransform.array, this.inverseWorldTransform.array)\n    Mat4.transpose(this.inverseWorldTransform.array, this.normalTransform.array)\n    this._worldID++\n    if (parentTransform) {\n      this._parentID = parentTransform._worldID\n    }\n  }\n\n  /**\n   * Rotates the transform so the forward vector points at specified point.\n   * @param point The point to look at.\n   * @param up The upward direction.\n   */\n  lookAt(point: ObservablePoint3D, up = new Float32Array([0, 1, 0])) {\n    let rot = Mat4.getRotation(\n      Mat4.targetTo(point.array, this.worldTransform.position, up))\n    this.rotationQuaternion.set(rot[0], rot[1], rot[2], rot[3])\n  }\n}","import { Container } from '@pixi/display';\n\nimport { ObservableQuaternion } from \"./transform/observable-quaternion\"\nimport { Transform3D } from \"./transform/transform\"\nimport { ObservablePoint3D } from \"./transform/observable-point\"\n\n/**\n * A container represents a collection of 3D objects.\n */\nexport class Container3D extends Container {\n  transform = new Transform3D()\n\n  set position(value: ObservablePoint3D) {\n    this.transform.position.copyFrom(value)\n  }\n\n  get position(): ObservablePoint3D {\n    return this.transform.position\n  }\n\n  set scale(value: ObservablePoint3D) {\n    this.transform.scale.copyFrom(value)\n  }\n\n  get scale(): ObservablePoint3D {\n    return this.transform.scale\n  }\n\n  set rotationQuaternion(value: ObservableQuaternion) {\n    this.transform.rotationQuaternion.copyFrom(value)\n  }\n\n  /** The quaternion rotation of the object. */\n  get rotationQuaternion(): ObservableQuaternion {\n    return this.transform.rotationQuaternion\n  }\n\n  /** The position of the object on the z axis relative to the local \n   * coordinates of the parent. */\n  get z() {\n    return this.transform.position.z\n  }\n\n  set z(value: number) {\n    this.transform.position.z = value\n  }\n\n  get localTransform() {\n    return this.transform.localTransform\n  }\n\n  get worldTransform() {\n    return this.transform.worldTransform\n  }\n}","import { Vec3 } from \"./vec3\"\n\nexport class Ray {\n  private _direction = new Float32Array(3)\n  private _origin = new Float32Array(3)\n\n  constructor(origin: Float32Array, direction: Float32Array) {\n    Vec3.copy(origin, this._origin)\n    Vec3.normalize(direction, this._direction)\n  }\n\n  get origin() {\n    return this._origin\n  }\n\n  get direction() {\n    return this._direction\n  }\n\n  getPoint(distance: number, point = new Float32Array(3)) {\n    return Vec3.add(this._origin, Vec3.scale(\n      this._direction, distance, point), point)\n  }\n}","import { IPointData, Point, ObservablePoint, DEG_TO_RAD } from \"@pixi/math\"\nimport { Renderer } from \"@pixi/core\"\nimport { IDestroyOptions } from \"@pixi/display\"\nimport { Container3D } from \"../container\"\nimport { Mat4 } from \"../math/mat4\"\nimport { Ray } from \"../math/ray\"\nimport { Vec3 } from \"../math/vec3\"\nimport { Vec4 } from \"../math/vec4\"\nimport { MatrixComponent } from \"../transform/matrix-component\"\nimport { ObservablePoint3D } from \"../transform/observable-point\"\nimport { TransformId } from \"../transform/transform-id\"\nimport { Compatibility } from \"../compatibility/compatibility\"\n\nconst vec3 = new Float32Array(3)\nconst mat4 = new Float32Array(16)\nconst vec4 = new Float32Array(4)\n\n/**\n * Camera is a device from which the world is viewed.\n */\nexport class Camera extends Container3D implements TransformId {\n  private _transformId = 0\n\n  get transformId() {\n    return this.transform._worldID + this._transformId\n  }\n\n  private _projection?: MatrixComponent\n  private _view?: MatrixComponent\n  private _viewProjection?: MatrixComponent\n  private _orthographic = false\n  private _orthographicSize = 10\n  private _obliqueness = new ObservablePoint(() => {\n    this._transformId++\n  }, undefined)\n\n  /**\n   * Used for making the frustum oblique, which means that one side is at a\n   * smaller angle to the centre line than the opposite side. Only works with\n   * perspective projection.\n   */\n  get obliqueness() {\n    return this._obliqueness\n  }\n\n  set obliqueness(value: IPointData) {\n    this._obliqueness.copyFrom(value)\n  }\n\n  /** Main camera which is used by default. */\n  static main: Camera\n\n  /**\n   * Creates a new camera using the specified renderer. By default the camera\n   * looks towards negative z and is positioned at z = 5.\n   * @param renderer Renderer to use.\n   */\n  constructor(public renderer: Renderer) {\n    super()\n\n    let aspect = renderer.width / renderer.height\n    let localID = -1\n\n    this.renderer.on(\"prerender\", () => {\n      if (!this._aspect) {\n        // When there is no specific aspect set, this is used for the \n        // projection matrix to always update each frame (in case when the \n        // renderer aspect ratio has changed).\n        if (renderer.width / renderer.height !== aspect) {\n          this._transformId++\n          aspect = renderer.width / renderer.height\n        }\n      }\n      // @ts-ignore: _localID do exist, but be careful if this changes.\n      if (!this.parent && localID !== this.transform._localID) {\n        // When the camera is not attached to the scene hierarchy the transform \n        // needs to be updated manually.\n        this.transform.updateTransform()\n        // @ts-ignore: _localID do exist, but be careful if this changes.\n        localID = this.transform._localID\n      }\n    })\n    if (!Camera.main) {\n      Camera.main = this\n    }\n    this.transform.position.z = 5\n    this.transform.rotationQuaternion.setEulerAngles(0, 180, 0)\n  }\n\n  destroy(options?: boolean | IDestroyOptions) {\n    super.destroy(options)\n    if (this === Camera.main) {\n      // @ts-ignore It's ok, main camera was destroyed.\n      Camera.main = undefined\n    }\n  }\n\n  /**\n   * The camera's half-size when in orthographic mode. The visible area from \n   * center of the screen to the top.\n   */\n  get orthographicSize() {\n    return this._orthographicSize\n  }\n\n  set orthographicSize(value: number) {\n    if (this._orthographicSize !== value) {\n      this._orthographicSize = value; this._transformId++\n    }\n  }\n\n  /**\n   * Camera will render objects uniformly, with no sense of perspective.\n   */\n  get orthographic() {\n    return this._orthographic\n  }\n\n  set orthographic(value: boolean) {\n    if (this._orthographic !== value) {\n      this._orthographic = value; this._transformId++\n    }\n  }\n\n  /**\n   * Converts screen coordinates to a ray.\n   * @param x Screen x coordinate.\n   * @param y Screen y coordinate.\n   * @param viewSize The size of the view when not rendering to the entire screen.\n   */\n  screenToRay(x: number, y: number, viewSize: { width: number, height: number } = this.renderer.screen) {\n    let screen = this.screenToWorld(x, y, 1, undefined, viewSize)\n    if (screen) {\n      if (this.orthographic) {\n        return new Ray(screen.array, this.worldTransform.forward)\n      }\n      return new Ray(this.worldTransform.position,\n        Vec3.subtract(screen.array, this.worldTransform.position, vec3))\n    }\n  }\n\n  /**\n   * Converts screen coordinates to world coordinates.\n   * @param x Screen x coordinate.\n   * @param y Screen y coordinate.\n   * @param distance Distance from the camera.\n   * @param point Point to set.\n   * @param viewSize The size of the view when not rendering to the entire screen.\n   */\n  screenToWorld(x: number, y: number, distance: number, point = new ObservablePoint3D(() => { }, undefined), viewSize: { width: number, height: number } = this.renderer.screen) {\n    // Make sure the transform is updated in case something has been changed, \n    // otherwise it may be using wrong values.\n    this.transform.updateTransform(this.parent?.transform)\n\n    let far = this.far\n\n    // Before doing the calculations, the far clip plane is changed to the same \n    // value as distance from the camera. By doing this we can just set z value \n    // for the clip space to 1 and the desired z position will be correct.\n    this.far = distance\n\n    let invertedViewProjection = Mat4.invert(this.viewProjection, mat4)\n    if (invertedViewProjection === null) {\n      return\n    }\n    let clipSpace = Vec4.set(\n      (x / viewSize.width) * 2 - 1, ((y / viewSize.height) * 2 - 1) * -1, 1, 1, vec4\n    )\n    this.far = far\n\n    let worldSpace = Vec4.transformMat4(clipSpace, invertedViewProjection, vec4)\n    worldSpace[3] = 1.0 / worldSpace[3]\n    for (let i = 0; i < 3; i++) {\n      worldSpace[i] *= worldSpace[3]\n    }\n    return point.set(worldSpace[0], worldSpace[1], worldSpace[2])\n  }\n\n  /**\n   * Converts world coordinates to screen coordinates.\n   * @param x World x coordinate.\n   * @param y World y coordinate.\n   * @param z World z coordinate.\n   * @param point Point to set.\n   * @param viewSize The size of the view when not rendering to the entire screen.\n   */\n  worldToScreen(x: number, y: number, z: number, point = new Point(), viewSize: { width: number, height: number } = this.renderer.screen) {\n    // Make sure the transform is updated in case something has been changed, \n    // otherwise it may be using wrong values.\n    this.transform.updateTransform(this.parent?.transform)\n\n    let worldSpace = Vec4.set(x, y, z, 1, vec4)\n    let clipSpace = Vec4.transformMat4(\n      Vec4.transformMat4(worldSpace, this.view, vec4), this.projection, vec4\n    )\n    if (clipSpace[3] !== 0) {\n      for (let i = 0; i < 3; i++) {\n        clipSpace[i] /= clipSpace[3]\n      }\n    }\n    return point.set((\n      clipSpace[0] + 1) / 2 * viewSize.width, viewSize.height - (clipSpace[1] + 1) / 2 * viewSize.height)\n  }\n\n  private _fieldOfView = 60\n  private _near = 0.1\n  private _far = 1000\n  private _aspect?: number\n\n  /**\n   * The aspect ratio (width divided by height). If not set, the aspect ratio of \n   * the renderer will be used by default.\n   */\n  get aspect() {\n    return this._aspect\n  }\n\n  set aspect(value: number | undefined) {\n    if (this._aspect !== value) {\n      this._aspect = value; this._transformId++\n    }\n  }\n\n  /** The vertical field of view in degrees, 60 is the default value. */\n  get fieldOfView() {\n    return this._fieldOfView\n  }\n\n  set fieldOfView(value: number) {\n    if (this._fieldOfView !== value) {\n      this._fieldOfView = value; this._transformId++\n    }\n  }\n\n  /** The near clipping plane distance, 0.1 is the default value. */\n  get near() {\n    return this._near\n  }\n\n  set near(value: number) {\n    if (this._near !== value) {\n      this._near = value; this._transformId++\n    }\n  }\n\n  /** The far clipping plane distance, 1000 is the default value. */\n  get far() {\n    return this._far\n  }\n\n  set far(value: number) {\n    if (this._far !== value) {\n      this._far = value; this._transformId++\n    }\n  }\n\n  /** Returns the projection matrix. */\n  get projection() {\n    if (!this._projection) {\n      this._projection = new MatrixComponent(this, 16, data => {\n        const aspect = this._aspect || this.renderer.width / this.renderer.height\n        if (this._orthographic) {\n          Mat4.ortho(-this._orthographicSize * aspect, this._orthographicSize * aspect, -this._orthographicSize, this._orthographicSize, this._near, this._far, data)\n        } else {\n          Mat4.perspective(this._fieldOfView * DEG_TO_RAD, aspect, this._near, this._far, data)\n          data[8] = this._obliqueness.x\n          data[9] = this._obliqueness.y\n        }\n      })\n    }\n    return this._projection.array\n  }\n\n  /** Returns the view matrix. */\n  get view() {\n    if (!this._view) {\n      this._view = new MatrixComponent(this, 16, data => {\n        const target = Vec3.add(\n          this.worldTransform.position, this.worldTransform.forward, vec3)\n        Mat4.lookAt(this.worldTransform.position,\n          target, this.worldTransform.up, data)\n      })\n    }\n    return this._view.array\n  }\n\n  /** Returns the view projection matrix. */\n  get viewProjection() {\n    if (!this._viewProjection) {\n      this._viewProjection = new MatrixComponent(this, 16, data => {\n        Mat4.multiply(this.projection, this.view, data)\n      })\n    }\n    return this._viewProjection.array\n  }\n}\n\nCompatibility.installRendererPlugin(\"camera\", Camera)","import { ObservablePoint } from \"@pixi/math\"\nimport { InteractionEvent } from \"@pixi/interaction\"\n\nimport { Camera } from \"./camera\"\nimport { Quat } from \"../math/quat\"\nimport { Vec3 } from \"../math/vec3\"\n\n/**\n * Allows the user to control the camera by orbiting the target.\n */\nexport class CameraOrbitControl {\n  private _distance = 5\n  private _grabbed = false\n\n  private _angles = new ObservablePoint(() => {\n    this._angles.x = Math.min(Math.max(-85, this._angles.x), 85)\n  }, undefined, 0, 180)\n\n  /**\n   * Orientation euler angles (x-axis and y-axis). The angle for the x-axis \n   * will be clamped between -85 and 85 degrees.\n   */\n  get angles() {\n    return this._angles\n  }\n\n  /** Target position (x, y, z) to orbit. */\n  target = { x: 0, y: 0, z: 0 }\n\n  /** Allows the camera to be controlled by user. */\n  allowControl = true\n\n  /**\n   * Creates a new camera orbit control.\n   * @param element The element for listening to user events.\n   * @param camera The camera to control. If not set, the main camera will be used \n   * by default.\n   */\n  constructor(element: HTMLElement, public camera = Camera.main) {\n    this.camera.renderer.on(\"prerender\", () => {\n      this.updateCamera()\n    })\n    this.camera.renderer.plugins.interaction.on(\"mousedown\", (e: InteractionEvent) => {\n      if (!e.stopped) {\n        this._grabbed = true\n      }\n    })\n    element.addEventListener(\"mouseup\", () => {\n      this._grabbed = false\n    })\n    element.addEventListener(\"mousemove\", (event) => {\n      if (this.allowControl && event.buttons === 1 && this._grabbed) {\n        this._angles.x += event.movementY * 0.5\n        this._angles.y -= event.movementX * 0.5\n      }\n    })\n    element.addEventListener(\"wheel\", (event) => {\n      if (this.allowControl) {\n        this.distance += event.deltaY * 0.01\n        event.preventDefault()\n      }\n    })\n  }\n\n  /**\n   * Updates the position and rotation of the camera.\n   */\n  updateCamera() {\n    let rot = Quat.fromEuler(this._angles.x, this._angles.y, 0, new Float32Array(4))\n    let dir = Vec3.transformQuat(\n      Vec3.set(0, 0, 1, new Float32Array(3)), rot, new Float32Array(3))\n    let pos = Vec3.subtract(\n      Vec3.set(this.target.x, this.target.y, this.target.z, new Float32Array(3)), Vec3.scale(dir, this.distance, new Float32Array(3)), new Float32Array(3))\n\n    this.camera.position.set(pos[0], pos[1], pos[2])\n    this.camera.rotationQuaternion.set(rot[0], rot[1], rot[2], rot[3])\n  }\n\n  /**\n   * Distance between camera and the target. Default value is 5.\n   */\n  get distance() {\n    return this._distance\n  }\n\n  set distance(value: number) {\n    this._distance = Math.min(\n      Math.max(value, 0.01), Number.MAX_SAFE_INTEGER)\n  }\n}","import { MeshGeometry3D } from \"./mesh-geometry\"\n\nexport namespace PlaneGeometry {\n  export function create() {\n    return Object.assign(new MeshGeometry3D(), {\n      positions: {\n        buffer: new Float32Array([-1, 0, 1, 1, 0, -1, -1, 0, -1, 1, 0, 1])\n      },\n      indices: {\n        buffer: new Uint8Array([0, 1, 2, 0, 3, 1])\n      },\n      normals: {\n        buffer: new Float32Array([0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0])\n      },\n      uvs: [{\n        buffer: new Float32Array([0, 1, 1, 0, 0, 0, 1, 1])\n      }]\n    })\n  }\n}","import { MeshGeometry3D } from \"./mesh-geometry\"\n\nexport namespace CubeGeometry {\n  export function create() {\n    return Object.assign(new MeshGeometry3D(), {\n      positions: {\n        buffer: new Float32Array([-1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, 1, 1, -1, 1, 1, -1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, 1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, 1, 1, 1, 1, -1, -1, 1, -1, 1, 1, 1])\n      },\n      indices: {\n        buffer: new Uint8Array([0, 1, 2, 0, 3, 1, 4, 5, 6, 4, 7, 5, 8, 9, 10, 8, 11, 9, 12, 13, 14, 12, 15, 13, 16, 17, 18, 16, 19, 17, 20, 21, 22, 20, 23, 21])\n      },\n      normals: {\n        buffer: new Float32Array([-1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0])\n      },\n      uvs: [{\n        buffer: new Float32Array([0.625, 1, 0.375, 0.75, 0.375, 1, 0.625, 0.75, 0.625, 0.75, 0.375, 0.5, 0.375, 0.75, 0.625, 0.5, 0.625, 0.5, 0.375, 0.25, 0.375, 0.5, 0.625, 0.25, 0.625, 0.25, 0.375, 0, 0.375, 0.25, 0.625, 0, 0.375, 0.25, 0.125, 0.5, 0.375, 0.5, 0.125, 0.25, 0.875, 0.25, 0.625, 0.5, 0.875, 0.5, 0.625, 0.25])\n      }],\n      tangents: {\n        buffer: new Float32Array([0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, -1, 0, 0, 1, -1, 0, 0, 1, -1, 0, 0, 1, -1, 0, 0, 1])\n      }\n    })\n  }\n}","import { MeshGeometry3D } from \"./mesh-geometry\"\n\nexport namespace QuadGeometry {\n  export function create() {\n    return Object.assign(new MeshGeometry3D(), {\n      positions: {\n        buffer: new Float32Array([-1, 1, 0, 1, -1, 0, -1, -1, 0, 1, 1, 0])\n      },\n      indices: {\n        buffer: new Uint8Array([0, 2, 1, 0, 1, 3])\n      },\n      normals: {\n        buffer: new Float32Array([0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1])\n      },\n      uvs: [{\n        buffer: new Float32Array([0, 0, 1, 1, 0, 1, 1, 0])\n      }]\n    })\n  }\n}","import { Geometry } from \"@pixi/core\"\nimport { MeshShader } from \"../mesh-shader\"\nimport { MeshGeometryAttribute } from \"./mesh-geometry-attribute\"\nimport { MeshGeometryTarget } from \"./mesh-geometry-target\"\n\n/**\n * Geometry with mesh data (i.e. positions, normals, uvs).\n */\nexport class MeshGeometry3D {\n  private _shaderGeometry: { [id: string]: Geometry } = {}\n\n  indices?: MeshGeometryAttribute\n  positions?: MeshGeometryAttribute\n  uvs?: MeshGeometryAttribute[]\n  normals?: MeshGeometryAttribute\n  tangents?: MeshGeometryAttribute\n  targets?: MeshGeometryTarget[]\n  joints?: MeshGeometryAttribute\n  weights?: MeshGeometryAttribute\n  colors?: MeshGeometryAttribute\n\n  /**\n   * Returns geometry with attributes required by the specified shader.\n   * @param shader The shader to use.\n   */\n  getShaderGeometry(shader: MeshShader) {\n    return this._shaderGeometry[shader.name]\n  }\n\n  /**\n   * Creates geometry with attributes required by the specified shader.\n   * @param shader The shader to use.\n   * @param instanced Value indicating if the geometry will be instanced.\n   */\n  addShaderGeometry(shader: MeshShader, instanced: boolean) {\n    this._shaderGeometry[shader.name] = shader.createShaderGeometry(this, instanced)\n  }\n\n  /**\n   * Returns a value indicating if geometry with required attributes has been\n   * created by the specified shader.\n   * @param shader The shader to test.\n   * @param instanced Value indicating if the geometry is instanced.\n   */\n  hasShaderGeometry(shader: MeshShader, instanced: boolean) {\n    if (this._shaderGeometry[shader.name]) {\n      return !instanced || (instanced && this._shaderGeometry[shader.name].instanced)\n    }\n    return false\n  }\n\n  /**\n   * Destroys the geometry and it's used resources.\n   */\n  destroy() {\n    for (let name in this._shaderGeometry) {\n      this._shaderGeometry[name].destroy()\n    }\n    this._shaderGeometry = {}\n  }\n}","import { IDestroyOptions } from \"@pixi/display\"\nimport { Container3D } from \"../container\"\nimport { Mesh3D } from \"./mesh\"\n\nexport class InstancedMesh3D extends Container3D {\n  constructor(readonly mesh: Mesh3D, readonly material: unknown) {\n    super()\n  }\n\n  destroy(options: boolean | IDestroyOptions | undefined) {\n    super.destroy(options)\n    this.mesh.removeInstance(this)\n  }\n}","export enum LightType {\n  /**\n   * A light that is located at a point and emits light in a cone shape.\n   */\n  spot = \"spot\",\n\n  /**\n   * A light that is located infinitely far away, and emits light in one \n   * direction only.\n   */\n  directional = \"directional\",\n\n  /** \n   * A light that is located at a point and emits light in all directions \n   * equally.\n   */\n  point = \"point\"\n}","export enum StandardMaterialAlphaMode {\n  /**\n   * The rendered output is fully opaque and any alpha value is ignored.\n   */\n  opaque = \"opaque\",\n  /**\n   * The rendered output is either fully opaque or fully transparent depending \n   * on the alpha value and the specified alpha cutoff value. This mode is used \n   * to simulate geometry such as tree leaves or wire fences.\n   */\n  mask = \"mask\",\n  /**\n   * The rendered output is combined with the background using the normal \n   * painting operation (i.e. the Porter and Duff over operator). This mode is \n   * used to simulate geometry such as guaze cloth or animal fur.\n   */\n  blend = \"blend\"\n}","export enum StandardMaterialDebugMode {\n  alpha = \"alpha\",\n  emissive = \"emissive\",\n  f0 = \"f0\",\n  metallic = \"metallic\",\n  normal = \"normal\",\n  occlusion = \"occlusion\",\n  roughness = \"roughness\"\n}","import { Renderer } from \"@pixi/core\"\n\nexport namespace Capabilities {\n  let _maxVertexUniformVectors: number | undefined\n\n  export function getMaxVertexUniformVectors(renderer: Renderer) {\n    if (_maxVertexUniformVectors !== undefined) {\n      return _maxVertexUniformVectors\n    }\n    const gl = renderer.gl\n    _maxVertexUniformVectors = <number>gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS)\n    return _maxVertexUniformVectors\n  }\n\n  let _isFloatTextureSupported: boolean | undefined\n\n  export function isFloatingPointTextureSupported(renderer: Renderer) {\n    if (renderer.context.webGLVersion === 2) {\n      return true\n    }\n    if (_isFloatTextureSupported !== undefined) {\n      return _isFloatTextureSupported\n    }\n    const gl = renderer.gl\n    _isFloatTextureSupported = !!gl.getExtension(\"OES_texture_float\")\n    return _isFloatTextureSupported\n  }\n\n  let _isHalfFloatFramebufferSupported: boolean | undefined\n\n  export function isHalfFloatFramebufferSupported(renderer: Renderer) {\n    if (renderer.context.webGLVersion === 2) {\n      return true\n    }\n    if (_isHalfFloatFramebufferSupported !== undefined) {\n      return _isHalfFloatFramebufferSupported\n    }\n    const gl = renderer.gl\n    const ext = gl.getExtension(\"OES_texture_half_float\")\n    if (!ext) {\n      return false\n    }\n    const texture = gl.createTexture()\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 8, 8, 0, gl.RGBA, ext.HALF_FLOAT_OES, null)\n    const fb = gl.createFramebuffer()\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fb)\n    const attachmentPoint = gl.COLOR_ATTACHMENT0\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, attachmentPoint, gl.TEXTURE_2D, texture, 0)\n    _isHalfFloatFramebufferSupported = gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE\n    return _isHalfFloatFramebufferSupported\n  }\n\n  let _isFloatFramebufferSupported: boolean | undefined\n\n  export function isFloatFramebufferSupported(renderer: Renderer) {\n    if (renderer.context.webGLVersion === 2) {\n      return true\n    }\n    if (_isFloatFramebufferSupported !== undefined) {\n      return _isFloatFramebufferSupported\n    }\n    const gl = renderer.gl\n    const ext = gl.getExtension(\"OES_texture_float\")\n    if (!ext) {\n      return false\n    }\n    const texture = gl.createTexture()\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 8, 8, 0, gl.RGBA, gl.FLOAT, null)\n    const fb = gl.createFramebuffer()\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fb)\n    const attachmentPoint = gl.COLOR_ATTACHMENT0\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, attachmentPoint, gl.TEXTURE_2D, texture, 0)\n    _isFloatFramebufferSupported = gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE\n    return _isFloatFramebufferSupported\n  }\n\n  let _isFloatLinearSupported: boolean | undefined\n\n  export function supportsFloatLinear(renderer: Renderer) {\n    if (_isFloatLinearSupported !== undefined) {\n      return _isFloatLinearSupported\n    }\n    const gl = renderer.gl\n    _isFloatLinearSupported = gl.getExtension(\"OES_texture_float_linear\") !== null\n    return _isFloatLinearSupported\n  }\n\n  export function isShaderTextureLodSupported(renderer: Renderer) {\n    if (renderer.context.webGLVersion === 2) {\n      return true\n    }\n    return renderer.gl.getExtension(\"EXT_shader_texture_lod\") !== null\n  }\n\n  let _isInstancingSupported: boolean | undefined\n\n  export function isInstancingSupported(renderer: Renderer) {\n    if (_isInstancingSupported !== undefined) {\n      return _isInstancingSupported\n    }\n    const gl = renderer.gl\n    _isInstancingSupported = gl.getExtension(\"ANGLE_instanced_arrays\") !== undefined\n    return _isInstancingSupported\n  }\n}","import * as PixiCore from \"@pixi/core\"\nimport { CompatibilityAccess } from \"./compatibility-access\"\n\nexport const BufferResource: typeof PixiCore.BufferResource =\n  CompatibilityAccess.get(PixiCore, \"BufferResource\") ||\n  //@ts-ignore \n  CompatibilityAccess.get(PixiCore, \"resources\").BufferResource","export enum Message {\n  meshVertexSkinningFloatingPointTexturesNotSupported = `Mesh is using vertex skinning but floating point textures is not supported on this device/environment. In case of errors, try changing the environment in PixiJS settings. Set \"PIXI.settings.PREFER_ENV = PIXI.ENV.WEBGL2\" before creating a renderer/application.`,\n  meshVertexSkinningNumberOfJointsNotSupported = `Mesh is using vertex skinning but the number of joints ({joints}) is not supported on this device/environment. Max number of supported joints is {maxJoints}, try reducing the number of joints.`,\n  imageBasedLightingShaderTextureLodNotSupported = `Image based lighting is used but shader texture lod is not supported on this device/environment, the material may not be displayed correctly. Try changing the environment in PixiJS settings. Set \"PIXI.settings.PREFER_ENV = PIXI.ENV.WEBGL2\" before creating a renderer/application.`\n}","import { Renderer } from \"@pixi/core\"\nimport { settings } from \"@pixi/settings\"\nimport { MeshGeometry3D } from \"../../mesh/geometry/mesh-geometry\"\nimport { StandardMaterialAlphaMode } from \"./standard-material-alpha-mode\"\nimport { StandardMaterialDebugMode } from \"./standard-material-debug-mode\"\nimport { StandardMaterial } from \"./standard-material\"\nimport { LightingEnvironment } from \"../../lighting/lighting-environment\"\nimport { Mesh3D } from \"../../mesh/mesh\"\nimport { Capabilities } from \"../../capabilities\"\nimport { StandardMaterialMatrixTexture } from \"./standard-material-matrix-texture\"\nimport { Debug } from \"../../debug\"\nimport { Message } from \"../../message\"\n\nexport namespace StandardMaterialFeatureSet {\n  export function build(renderer: Renderer, mesh: Mesh3D, geometry: MeshGeometry3D, material: StandardMaterial, lightingEnvironment: LightingEnvironment) {\n    let features: string[] = []\n\n    if (mesh.instances.length > 0) {\n      features.push(\"USE_INSTANCING 1\")\n    }\n    if (renderer.context.webGLVersion === 1) {\n      features.push(\"WEBGL1 1\")\n    }\n    if (renderer.context.webGLVersion === 2) {\n      features.push(\"WEBGL2 1\")\n    }\n    if (geometry.colors) {\n      // Need to figure out how to detect if vec3 or vec4 should be\n      // used. For now disable vec4.\n      features.push(\"HAS_VERTEX_COLOR_VEC3 1\")\n      // features.push(\"HAS_VERTEX_COLOR_VEC4 1\") \n    }\n    if (geometry.normals) {\n      features.push(\"HAS_NORMALS 1\")\n    }\n    if (geometry.uvs && geometry.uvs[0]) {\n      features.push(\"HAS_UV_SET1 1\")\n    }\n    if (geometry.uvs && geometry.uvs[1]) {\n      features.push(\"HAS_UV_SET2 1\")\n    }\n    if (geometry.tangents) {\n      features.push(\"HAS_TANGENTS 1\")\n    }\n    if (geometry.targets) {\n      for (let i = 0; i < geometry.targets.length; i++) {\n        if (geometry.targets[i].positions) {\n          features.push(\"HAS_TARGET_POSITION\" + i)\n        }\n        if (geometry.targets[i].normals) {\n          features.push(\"HAS_TARGET_NORMAL\" + i)\n        }\n        if (geometry.targets[i].tangents) {\n          features.push(\"HAS_TARGET_TANGENT\" + i)\n        }\n      }\n      if (mesh.targetWeights) {\n        features.push(`WEIGHT_COUNT ${mesh.targetWeights.length}`)\n        features.push(\"USE_MORPHING 1\")\n      }\n    }\n    if (geometry.joints) {\n      features.push(\"HAS_JOINT_SET1 1\")\n    }\n    if (geometry.weights) {\n      features.push(\"HAS_WEIGHT_SET1 1\")\n    }\n    if (mesh.skin) {\n      addSkinningFeatures(mesh, features, renderer)\n    }\n    if (material.unlit) {\n      features.push(\"MATERIAL_UNLIT 1\")\n    }\n    features.push(\"MATERIAL_METALLICROUGHNESS 1\")\n    if (lightingEnvironment.lights.length > 0) {\n      features.push(`LIGHT_COUNT ${lightingEnvironment.lights.length}`)\n      features.push(\"USE_PUNCTUAL 1\")\n    }\n    if (lightingEnvironment.imageBasedLighting) {\n      if (!lightingEnvironment.imageBasedLighting.valid) {\n        return undefined\n      }\n      if (Capabilities.isShaderTextureLodSupported(renderer)) {\n        features.push(\"USE_TEX_LOD 1\")\n      } else {\n        Debug.warn(Message.imageBasedLightingShaderTextureLodNotSupported)\n      }\n      features.push(\"USE_IBL 1\")\n    }\n    if (material.shadowCastingLight) {\n      features.push(\"USE_SHADOW_MAPPING 1\")\n    }\n    if (material.baseColorTexture) {\n      if (!material.baseColorTexture.valid) {\n        return undefined\n      }\n      if (material.baseColorTexture.transform) {\n        features.push(\"HAS_BASECOLOR_UV_TRANSFORM 1\");\n      }\n      features.push(\"HAS_BASE_COLOR_MAP 1\")\n    }\n    if (material.emissiveTexture) {\n      if (!material.emissiveTexture.valid) {\n        return undefined\n      }\n      if (material.emissiveTexture.transform) {\n        features.push(\"HAS_EMISSIVE_UV_TRANSFORM 1\");\n      }\n      features.push(\"HAS_EMISSIVE_MAP 1\")\n    }\n    if (material.normalTexture) {\n      if (!material.normalTexture.valid) {\n        return undefined\n      }\n      if (material.normalTexture.transform) {\n        features.push(\"HAS_NORMAL_UV_TRANSFORM 1\");\n      }\n      features.push(\"HAS_NORMAL_MAP 1\")\n    }\n    if (material.metallicRoughnessTexture) {\n      if (!material.metallicRoughnessTexture.valid) {\n        return undefined\n      }\n      if (material.metallicRoughnessTexture.transform) {\n        features.push(\"HAS_METALLICROUGHNESS_UV_TRANSFORM 1\");\n      }\n      features.push(\"HAS_METALLIC_ROUGHNESS_MAP 1\")\n    }\n    if (material.occlusionTexture) {\n      if (!material.occlusionTexture.valid) {\n        return undefined\n      }\n      if (material.occlusionTexture.transform) {\n        features.push(\"HAS_OCCLUSION_UV_TRANSFORM 1\");\n      }\n      features.push(\"HAS_OCCLUSION_MAP 1\")\n    }\n    switch (material.alphaMode) {\n      case StandardMaterialAlphaMode.opaque: {\n        features.push(\"ALPHAMODE_OPAQUE 1\")\n        break\n      }\n      case StandardMaterialAlphaMode.mask: {\n        features.push(\"ALPHAMODE_MASK 1\")\n        break\n      }\n    }\n    if (material.debugMode) {\n      features.push(\"DEBUG_OUTPUT 1\")\n    }\n    switch (material.debugMode) {\n      case StandardMaterialDebugMode.alpha: {\n        features.push(\"DEBUG_ALPHA 1\")\n        break\n      }\n      case StandardMaterialDebugMode.emissive: {\n        features.push(\"DEBUG_EMISSIVE 1\")\n        break\n      }\n      case StandardMaterialDebugMode.f0: {\n        features.push(\"DEBUG_F0 1\")\n        break\n      }\n      case StandardMaterialDebugMode.metallic: {\n        features.push(\"DEBUG_METALLIC 1\")\n        break\n      }\n      case StandardMaterialDebugMode.normal: {\n        features.push(\"DEBUG_NORMAL 1\")\n        break\n      }\n      case StandardMaterialDebugMode.occlusion: {\n        features.push(\"DEBUG_OCCLUSION 1\")\n        break\n      }\n      case StandardMaterialDebugMode.roughness: {\n        features.push(\"DEBUG_ROUGHNESS 1\")\n        break\n      }\n    }\n    return features\n  }\n\n  function addSkinningFeatures(mesh: Mesh3D, features: string[], renderer: Renderer) {\n    if (!mesh.skin) {\n      return\n    }\n    let uniformsRequiredForOtherFeatures = 20\n    let availableVertexUniforms =\n      Capabilities.getMaxVertexUniformVectors(renderer) - uniformsRequiredForOtherFeatures\n    let uniformsRequiredPerJoint = 8 // 4 per matrix times 2 (matrices and normals)\n    let maxJointCount = Math.floor(availableVertexUniforms / uniformsRequiredPerJoint)\n    let uniformsSupported = mesh.skin.joints.length <= maxJointCount\n\n    const addFeatureSetForUniforms = () => {\n      features.push(\"USE_SKINNING 1\")\n      features.push(`JOINT_COUNT ${mesh.skin?.joints.length}`)\n    }\n\n    const addFeatureSetForTextures = () => {\n      features.push(\"USE_SKINNING 1\")\n      features.push(`JOINT_COUNT ${mesh.skin?.joints.length}`)\n      features.push(\"USE_SKINNING_TEXTURE 1\")\n    }\n\n    // @ts-ignore Use PixiJS's already existing settings object for now.\n    if (settings.PREFER_UNIFORMS_WHEN_UPLOADING_SKIN_JOINTS) {\n      if (uniformsSupported) {\n        addFeatureSetForUniforms(); return\n      }\n      if (StandardMaterialMatrixTexture.isSupported(renderer)) {\n        addFeatureSetForTextures(); return\n      } else {\n        Debug.error(Message.meshVertexSkinningNumberOfJointsNotSupported, {\n          joints: mesh.skin.joints.length,\n          maxJoints: maxJointCount\n        })\n      }\n    } else {\n      if (StandardMaterialMatrixTexture.isSupported(renderer)) {\n        addFeatureSetForTextures(); return\n      }\n      Debug.warn(Message.meshVertexSkinningFloatingPointTexturesNotSupported)\n      if (uniformsSupported) {\n        addFeatureSetForUniforms()\n      } else {\n        Debug.error(Message.meshVertexSkinningNumberOfJointsNotSupported, {\n          joints: mesh.skin.joints.length,\n          maxJoints: maxJointCount\n        })\n      }\n    }\n  }\n\n  export function hasSkinningTextureFeature(features: string[]) {\n    return features.includes(\"USE_SKINNING_TEXTURE 1\")\n  }\n}","import { BufferResource } from \"../../compatibility/buffer-resource\"\nimport { MIPMAP_MODES, WRAP_MODES, SCALE_MODES, FORMATS, TYPES, ALPHA_MODES } from \"@pixi/constants\"\nimport { Texture, Renderer, BaseTexture } from \"@pixi/core\"\nimport { Capabilities } from \"../../capabilities\"\n\nexport class StandardMaterialMatrixTexture extends Texture {\n  private _buffer: Float32Array\n\n  static isSupported(renderer: Renderer) {\n    return Capabilities.isFloatingPointTextureSupported(renderer)\n  }\n\n  constructor(matrixCount: number) {\n    let buffer = new Float32Array(matrixCount * 16)\n    let resource = new BufferResource(buffer, { width: 4, height: matrixCount })\n    super(new BaseTexture(resource, {\n      mipmap: MIPMAP_MODES.OFF,\n      wrapMode: WRAP_MODES.CLAMP,\n      scaleMode: SCALE_MODES.NEAREST,\n      format: FORMATS.RGBA,\n      type: TYPES.FLOAT,\n      alphaMode: ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,\n      resolution: 1\n    }))\n    this._buffer = buffer\n  }\n\n  updateBuffer(buffer: Float32Array) {\n    this._buffer.set(buffer)\n    this.baseTexture.resource.update()\n  }\n}","import { EventEmitter } from '@pixi/utils';\nimport { Message } from \"./message\"\n\nexport namespace Debug {\n  const messages: Message[] = []\n  const eventEmitter = new EventEmitter()\n\n  export function on(event: string | symbol, fn: EventEmitter.ListenerFn, context: any) {\n    eventEmitter.on(event, fn, context)\n  }\n\n  export function warn(message: Message, args?: any) {\n    if (!messages.includes(message)) {\n      messages.push(message)\n      let formatted = formatMessage(message, args)\n      console.warn(`PIXI3D: ${formatted}`)\n      eventEmitter.emit(\"warn\", formatted)\n    }\n  }\n\n  export function error(message: Message, args?: any) {\n    if (!messages.includes(message)) {\n      messages.push(message)\n      let formatted = formatMessage(message, args)\n      console.error(`PIXI3D: ${formatted}`)\n      eventEmitter.emit(\"error\", formatted)\n    }\n  }\n\n  function formatMessage(message: Message, args?: any) {\n    let formatted = <string>message\n    let match: RegExpExecArray | null\n    while ((match = /{(\\w*)}/g.exec(formatted)) !== null && args) {\n      formatted = formatted.replace(match[0], args[match[1]])\n    }\n    return formatted\n  }\n}","import { Shader, State, Geometry, Buffer, Renderer } from \"@pixi/core\"\nimport { DRAW_MODES } from \"@pixi/constants\"\nimport { Mesh3D } from \"./mesh\"\nimport { MeshGeometry3D } from \"./geometry/mesh-geometry\"\n\n/**\n * Shader used specifically to render a mesh.\n */\nexport class MeshShader extends Shader {\n  private _state = Object.assign(new State(), {\n    culling: true, clockwiseFrontFace: false, depthTest: true\n  })\n\n  /** The name of the mesh shader. Used for figuring out if geometry attributes is compatible with the shader. This needs to be set to something different than default value when custom attributes is used. */\n  get name() {\n    return \"mesh-shader\"\n  }\n\n  /**\n   * Creates geometry with required attributes used by this shader. Override when using custom attributes.\n   * @param geometry The geometry with mesh data.\n   * @param instanced Value indicating if the geometry will be instanced.\n   */\n  createShaderGeometry(geometry: MeshGeometry3D, instanced: boolean) {\n    let result = new Geometry()\n    if (geometry.indices) {\n      if (geometry.indices.buffer.BYTES_PER_ELEMENT === 1) {\n        // PixiJS seems to have problems with Uint8Array, let's convert to UNSIGNED_SHORT.\n        result.addIndex(new Buffer(new Uint16Array(geometry.indices.buffer)))\n      } else {\n        result.addIndex(new Buffer(geometry.indices.buffer))\n      }\n    }\n    if (geometry.positions) {\n      result.addAttribute(\"a_Position\", new Buffer(geometry.positions.buffer),\n        3, false, geometry.positions.componentType, geometry.positions.stride)\n    }\n    if (geometry.uvs && geometry.uvs[0]) {\n      result.addAttribute(\"a_UV1\", new Buffer(geometry.uvs[0].buffer),\n        2, false, geometry.uvs[0].componentType, geometry.uvs[0].stride)\n    }\n    if (geometry.normals) {\n      result.addAttribute(\"a_Normal\", new Buffer(geometry.normals.buffer),\n        3, false, geometry.normals.componentType, geometry.normals.stride)\n    }\n    if (geometry.tangents) {\n      result.addAttribute(\"a_Tangent\", new Buffer(geometry.tangents.buffer),\n        4, false, geometry.tangents.componentType, geometry.tangents.stride)\n    }\n    if (geometry.colors) {\n      result.addAttribute(\"a_Color\", new Buffer(geometry.colors.buffer),\n        4, true, geometry.colors.componentType, geometry.colors.stride)\n    }\n    return result\n  }\n\n  /**\n   * Renders the geometry of the specified mesh.\n   * @param mesh Mesh to render.\n   * @param renderer Renderer to use.\n   * @param state Rendering state to use.\n   * @param drawMode Draw mode to use.\n   */\n  render(mesh: Mesh3D, renderer: Renderer, state: State = this._state, drawMode = DRAW_MODES.TRIANGLES) {\n    const instanceCount = mesh.instances.filter(i =>\n      i.worldVisible && i.renderable).length\n    const instancing = mesh.instances.length > 0\n    if (!mesh.geometry.hasShaderGeometry(this, instancing)) {\n      mesh.geometry.addShaderGeometry(this, instancing)\n    }\n    let geometry = mesh.geometry.getShaderGeometry(this)\n    renderer.shader.bind(this, false)\n    renderer.state.set(state)\n    renderer.geometry.bind(geometry, this)\n    renderer.geometry.draw(drawMode, undefined, undefined, instanceCount)\n  }\n}","import { Renderer } from \"@pixi/core\"\n\nexport namespace StandardShaderSource {\n  export function build(source: string, features: string[], renderer: Renderer) {\n    if (renderer.context.webGLVersion === 1) {\n      source = source.replace(/VERSION/, \"100\")\n        .replace(/VERT_IN/g, \"attribute\")\n        .replace(/VERT_OUT/g, \"varying\")\n        .replace(/FRAG_COLOR/g, \"gl_FragColor\")\n        .replace(/FRAG_IN/g, \"varying\")\n    }\n    if (renderer.context.webGLVersion === 2) {\n      source = source.replace(/VERSION/, \"300 es\")\n        .replace(/VERT_IN/g, \"in\")\n        .replace(/VERT_OUT/g, \"out\")\n        .replace(/FRAG_COLOR/g, \"g_finalColor\")\n        .replace(/FRAG_IN/g, \"in\")\n    }\n    return source.replace(/#define FEATURES/,\n      features.map(value => `#define ${value}`).join(\"\\n\"))\n  }\n}","import { Buffer, Geometry } from \"@pixi/core\"\n\nimport { InstancedMesh3D } from \"../../mesh/instanced-mesh\"\nimport { InstancedStandardMaterial } from \"./instanced-standard-material\"\n\nexport class StandardShaderInstancing {\n  private _maxInstances = 200\n\n  private _modelMatrix: Buffer[] = [\n    new Buffer(), new Buffer(), new Buffer(), new Buffer()\n  ]\n  private _normalMatrix: Buffer[] = [\n    new Buffer(), new Buffer(), new Buffer(), new Buffer()\n  ]\n  private _baseColor = new Buffer()\n\n  constructor() {\n    this.expandBuffers(this._maxInstances)\n  }\n\n  expandBuffers(instanceCount: number) {\n    while (instanceCount > this._maxInstances) {\n      this._maxInstances += Math.floor(this._maxInstances * 0.5)\n    }\n    for (let i = 0; i < 4; i++) {\n      this._modelMatrix[i].update(new Float32Array(4 * this._maxInstances))\n      this._normalMatrix[i].update(new Float32Array(4 * this._maxInstances))\n    }\n    this._baseColor.update(new Float32Array(4 * this._maxInstances))\n  }\n\n  updateBuffers(instances: InstancedMesh3D[]) {\n    if (instances.length > this._maxInstances) {\n      this.expandBuffers(instances.length)\n    }\n    let bufferIndex = 0\n    for (let i = 0; i < instances.length; i++) {\n      const normal = instances[i].transform.normalTransform.array\n      for (let j = 0; j < 4; j++) {\n        (<Float32Array>this._normalMatrix[j].data)\n          .set(normal.slice(j * 4, j * 4 + 4), bufferIndex * 4)\n      }\n      const model = instances[i].worldTransform.array\n      for (let j = 0; j < 4; j++) {\n        (<Float32Array>this._modelMatrix[j].data)\n          .set(model.slice(j * 4, j * 4 + 4), bufferIndex * 4)\n      }\n      const material = <InstancedStandardMaterial>instances[i].material;\n      (<Float32Array>this._baseColor.data)\n        .set(material.baseColor.rgba, bufferIndex * 4)\n      bufferIndex++\n    }\n\n    for (let i = 0; i < 4; i++) {\n      this._modelMatrix[i].update()\n      this._normalMatrix[i].update()\n    }\n    this._baseColor.update()\n  }\n\n  addGeometryAttributes(geometry: Geometry) {\n    for (let i = 0; i < 4; i++) {\n      geometry.addAttribute(`a_ModelMatrix${i}`,\n        this._modelMatrix[i], 4, false, undefined, 0, undefined, true)\n    }\n    for (let i = 0; i < 4; i++) {\n      geometry.addAttribute(`a_NormalMatrix${i}`,\n        this._normalMatrix[i], 4, false, undefined, 0, undefined, true)\n    }\n    geometry.addAttribute(\"a_BaseColorFactor\",\n      this._baseColor, 4, false, undefined, 0, undefined, true)\n  }\n}","export var Shader = {\"source\":\"#version VERSION\\n\\n//\\n// This fragment shader defines a reference implementation for Physically Based Shading of\\n// a microfacet surface material defined by a glTF model.\\n//\\n// References:\\n// [1] Real Shading in Unreal Engine 4\\n//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\\n// [2] Physically Based Shading at Disney\\n//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\\n// [3] README.md - Environment Maps\\n//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\\n// [4] \\\"An Inexpensive BRDF Model for Physically based Rendering\\\" by Christophe Schlick\\n//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\\n\\n#define FEATURES\\n\\n#if defined(WEBGL1) //&& defined(USE_TEX_LOD)\\n#extension GL_EXT_shader_texture_lod : enable\\n#endif\\n\\n#if defined(WEBGL1)\\n#extension GL_OES_standard_derivatives : enable\\n#endif\\n\\n#if defined(WEBGL1) && defined(USE_HDR)\\n#extension GL_OES_texture_float : enable\\n#extension GL_OES_texture_float_linear : enable\\n#endif\\n\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\n  precision highp float;\\n#else\\n  precision mediump float;\\n#endif\\n\\nvec4 _texture(sampler2D sampler, vec2 coord)\\n{\\n#ifdef WEBGL2\\n    return texture(sampler, coord);\\n#else\\n    return texture2D(sampler, coord);\\n#endif\\n}\\n\\nvec4 _texture(samplerCube sampler, vec3 coord)\\n{\\n#ifdef WEBGL2\\n    return texture(sampler, coord);\\n#else\\n    return textureCube(sampler, coord);\\n#endif\\n}\\nvec4 _textureLod(sampler2D sampler, vec2 coord, float lod)\\n{\\n#ifdef WEBGL2\\n    return textureLod(sampler, coord, lod);\\n#endif\\n#if defined(WEBGL1) && defined(GL_EXT_shader_texture_lod) \\n    return texture2DLodEXT(sampler, coord, lod);\\n#endif\\n    return vec4(0.0);\\n}\\n\\nvec4 _textureLod(samplerCube sampler, vec3 coord, float lod)\\n{\\n#ifdef WEBGL2\\n    return textureLod(sampler, coord, lod);\\n#endif\\n#if defined(WEBGL1) && defined(GL_EXT_shader_texture_lod) \\n    return textureCubeLodEXT(sampler, coord, lod);\\n#endif\\n    return vec4(0.0);\\n}\\nvec3 _dFdx(vec3 coord)\\n{\\n#if defined(WEBGL2) || defined(GL_OES_standard_derivatives)\\n    return dFdx(coord);\\n#endif\\n    return vec3(0.0);\\n}\\n\\nvec3 _dFdy(vec3 coord)\\n{\\n#if defined(WEBGL2) || defined(GL_OES_standard_derivatives)\\n    return dFdy(coord);\\n#endif\\n    return vec3(0.0);\\n}\\nFRAG_IN vec2 v_UVCoord1;\\nFRAG_IN vec2 v_UVCoord2;\\n\\n// General Material\\n#ifdef HAS_NORMAL_MAP\\nuniform sampler2D u_NormalSampler;\\nuniform float u_NormalScale;\\nuniform int u_NormalUVSet;\\nuniform mat3 u_NormalUVTransform;\\n#endif\\n\\n#ifdef HAS_EMISSIVE_MAP\\nuniform sampler2D u_EmissiveSampler;\\nuniform int u_EmissiveUVSet;\\nuniform vec3 u_EmissiveFactor;\\nuniform mat3 u_EmissiveUVTransform;\\n#endif\\n\\n#ifdef HAS_OCCLUSION_MAP\\nuniform sampler2D u_OcclusionSampler;\\nuniform int u_OcclusionUVSet;\\nuniform float u_OcclusionStrength;\\nuniform mat3 u_OcclusionUVTransform;\\n#endif\\n\\n// Metallic Roughness Material\\n#ifdef HAS_BASE_COLOR_MAP\\nuniform sampler2D u_BaseColorSampler;\\nuniform int u_BaseColorUVSet;\\nuniform mat3 u_BaseColorUVTransform;\\n#endif\\n\\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\\nuniform sampler2D u_MetallicRoughnessSampler;\\nuniform int u_MetallicRoughnessUVSet;\\nuniform mat3 u_MetallicRoughnessUVTransform;\\n#endif\\n\\n// Specular Glossiness Material\\n#ifdef HAS_DIFFUSE_MAP\\nuniform sampler2D u_DiffuseSampler;\\nuniform int u_DiffuseUVSet;\\nuniform mat3 u_DiffuseUVTransform;\\n#endif\\n\\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\\nuniform sampler2D u_SpecularGlossinessSampler;\\nuniform int u_SpecularGlossinessUVSet;\\nuniform mat3 u_SpecularGlossinessUVTransform;\\n#endif\\n\\n// IBL\\n#ifdef USE_IBL\\nuniform samplerCube u_DiffuseEnvSampler;\\nuniform samplerCube u_SpecularEnvSampler;\\nuniform sampler2D u_brdfLUT;\\n#endif\\n\\n#ifdef USE_SHADOW_MAPPING\\nuniform sampler2D u_ShadowSampler;\\n#endif\\n\\nvec2 getNormalUV()\\n{\\n    vec3 uv = vec3(v_UVCoord1, 1.0);\\n#ifdef HAS_NORMAL_MAP\\n    uv.xy = u_NormalUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\\n    #ifdef HAS_NORMAL_UV_TRANSFORM\\n    uv = u_NormalUVTransform * uv;\\n    #endif\\n#endif\\n    return uv.xy;\\n}\\n\\nvec2 getEmissiveUV()\\n{\\n    vec3 uv = vec3(v_UVCoord1, 1.0);\\n#ifdef HAS_EMISSIVE_MAP\\n    uv.xy = u_EmissiveUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\\n    #ifdef HAS_EMISSIVE_UV_TRANSFORM\\n    uv = u_EmissiveUVTransform * uv;\\n    #endif\\n#endif\\n\\n    return uv.xy;\\n}\\n\\nvec2 getOcclusionUV()\\n{\\n    vec3 uv = vec3(v_UVCoord1, 1.0);\\n#ifdef HAS_OCCLUSION_MAP\\n    uv.xy = u_OcclusionUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\\n    #ifdef HAS_OCCLUSION_UV_TRANSFORM\\n    uv = u_OcclusionUVTransform * uv;\\n    #endif\\n#endif\\n    return uv.xy;\\n}\\n\\nvec2 getBaseColorUV()\\n{\\n    vec3 uv = vec3(v_UVCoord1, 1.0);\\n#ifdef HAS_BASE_COLOR_MAP\\n    uv.xy = u_BaseColorUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\\n    #ifdef HAS_BASECOLOR_UV_TRANSFORM\\n    uv = u_BaseColorUVTransform * uv;\\n    #endif\\n#endif\\n    return uv.xy;\\n}\\n\\nvec2 getMetallicRoughnessUV()\\n{\\n    vec3 uv = vec3(v_UVCoord1, 1.0);\\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\\n    uv.xy = u_MetallicRoughnessUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\\n    #ifdef HAS_METALLICROUGHNESS_UV_TRANSFORM\\n    uv = u_MetallicRoughnessUVTransform * uv;\\n    #endif\\n#endif\\n    return uv.xy;\\n}\\n\\nvec2 getSpecularGlossinessUV()\\n{\\n    vec3 uv = vec3(v_UVCoord1, 1.0);\\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\\n    uv.xy = u_SpecularGlossinessUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\\n    #ifdef HAS_SPECULARGLOSSINESS_UV_TRANSFORM\\n    uv = u_SpecularGlossinessUVTransform * uv;\\n    #endif\\n#endif\\n    return uv.xy;\\n}\\n\\nvec2 getDiffuseUV()\\n{\\n    vec3 uv = vec3(v_UVCoord1, 1.0);\\n#ifdef HAS_DIFFUSE_MAP\\n    uv.xy = u_DiffuseUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\\n    #ifdef HAS_DIFFUSE_UV_TRANSFORM\\n    uv = u_DiffuseUVTransform * uv;\\n    #endif\\n#endif\\n    return uv.xy;\\n}\\n\\n// textures.glsl needs to be included\\n\\nconst float M_PI = 3.141592653589793;\\nconst float c_MinReflectance = 0.04;\\n\\nFRAG_IN vec3 v_Position;\\n\\n#ifdef HAS_NORMALS\\n#ifdef HAS_TANGENTS\\nFRAG_IN mat3 v_TBN;\\n#else\\nFRAG_IN vec3 v_Normal;\\n#endif\\n#endif\\n\\n#ifdef HAS_VERTEX_COLOR_VEC3\\nFRAG_IN vec3 v_Color;\\n#endif\\n#ifdef HAS_VERTEX_COLOR_VEC4\\nFRAG_IN vec4 v_Color;\\n#endif\\n\\nstruct AngularInfo\\n{\\n    float NdotL;                  // cos angle between normal and light direction\\n    float NdotV;                  // cos angle between normal and view direction\\n    float NdotH;                  // cos angle between normal and half vector\\n    float LdotH;                  // cos angle between light direction and half vector\\n\\n    float VdotH;                  // cos angle between view direction and half vector\\n\\n    vec3 padding;\\n};\\n\\nvec4 getVertexColor()\\n{\\n   vec4 color = vec4(1.0, 1.0, 1.0, 1.0);\\n\\n#ifdef HAS_VERTEX_COLOR_VEC3\\n    color.rgb = v_Color;\\n#endif\\n#ifdef HAS_VERTEX_COLOR_VEC4\\n    color = v_Color;\\n#endif\\n\\n   return color;\\n}\\n\\n// Find the normal for this fragment, pulling either from a predefined normal map\\n// or from the interpolated mesh normal and tangent attributes.\\nvec3 getNormal()\\n{\\n    vec2 UV = getNormalUV();\\n\\n    // Retrieve the tangent space matrix\\n#ifndef HAS_TANGENTS\\n    vec3 pos_dx = _dFdx(v_Position);\\n    vec3 pos_dy = _dFdy(v_Position);\\n    vec3 tex_dx = _dFdx(vec3(UV, 0.0));\\n    vec3 tex_dy = _dFdy(vec3(UV, 0.0));\\n    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\\n\\n#ifdef HAS_NORMALS\\n    vec3 ng = normalize(v_Normal);\\n#else\\n    vec3 ng = cross(pos_dx, pos_dy);\\n#endif\\n\\n    t = normalize(t - ng * dot(ng, t));\\n    vec3 b = normalize(cross(ng, t));\\n    mat3 tbn = mat3(t, b, ng);\\n#else // HAS_TANGENTS\\n    mat3 tbn = v_TBN;\\n#endif\\n\\n#ifdef HAS_NORMAL_MAP\\n    vec3 n = _texture(u_NormalSampler, UV).rgb;\\n    n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\\n#else\\n    // The tbn matrix is linearly interpolated, so we need to re-normalize\\n    vec3 n = normalize(tbn[2].xyz);\\n#endif\\n\\n    return n;\\n}\\n\\nfloat getPerceivedBrightness(vec3 vector)\\n{\\n    return sqrt(0.299 * vector.r * vector.r + 0.587 * vector.g * vector.g + 0.114 * vector.b * vector.b);\\n}\\n\\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness/examples/convert-between-workflows/js/three.pbrUtilities.js#L34\\nfloat solveMetallic(vec3 diffuse, vec3 specular, float oneMinusSpecularStrength) {\\n    float specularBrightness = getPerceivedBrightness(specular);\\n\\n    if (specularBrightness < c_MinReflectance) {\\n        return 0.0;\\n    }\\n\\n    float diffuseBrightness = getPerceivedBrightness(diffuse);\\n\\n    float a = c_MinReflectance;\\n    float b = diffuseBrightness * oneMinusSpecularStrength / (1.0 - c_MinReflectance) + specularBrightness - 2.0 * c_MinReflectance;\\n    float c = c_MinReflectance - specularBrightness;\\n    float D = b * b - 4.0 * a * c;\\n\\n    return clamp((-b + sqrt(D)) / (2.0 * a), 0.0, 1.0);\\n}\\n\\nAngularInfo getAngularInfo(vec3 pointToLight, vec3 normal, vec3 view)\\n{\\n    // Standard one-letter names\\n    vec3 n = normalize(normal);           // Outward direction of surface point\\n    vec3 v = normalize(view);             // Direction from surface point to view\\n    vec3 l = normalize(pointToLight);     // Direction from surface point to light\\n    vec3 h = normalize(l + v);            // Direction of the vector between l and v\\n\\n    float NdotL = clamp(dot(n, l), 0.0, 1.0);\\n    float NdotV = clamp(dot(n, v), 0.0, 1.0);\\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\\n\\n    return AngularInfo(\\n        NdotL,\\n        NdotV,\\n        NdotH,\\n        LdotH,\\n        VdotH,\\n        vec3(0, 0, 0)\\n    );\\n}\\n\\n#ifdef USE_SHADOW_MAPPING\\nFRAG_IN vec4 v_PositionLightSpace;\\n#endif\\n\\nfloat linstep(float low, float high, float v)\\n{\\n    return clamp((v-low) / (high-low), 0.0, 1.0);\\n}\\n\\n#ifdef USE_SHADOW_MAPPING\\nfloat getShadowContribution()\\n{\\n    vec3 coords = v_PositionLightSpace.xyz / v_PositionLightSpace.w * 0.5 + 0.5;\\n    if (coords.z < 0.01 || coords.z > 0.99 || coords.x < 0.01 || coords.x > 0.99 || coords.y < 0.01 || coords.y > 0.99) {\\n        return 1.0;\\n    }\\n    vec2 moments = vec2(1.0) - _texture(u_ShadowSampler, coords.xy).xy;\\n    float p = step(coords.z, moments.x);\\n    float variance = max(moments.y - moments.x * moments.x, 0.00002);\\n    float d = coords.z - moments.x;\\n    float pMax = linstep(0.2, 1.0, variance / (variance + d*d));\\n    return min(max(p, pMax), 1.0);\\n}\\n#endif\\nuniform float u_Exposure;\\n\\nconst float GAMMA = 2.2;\\nconst float INV_GAMMA = 1.0 / GAMMA;\\n\\n// linear to sRGB approximation\\n// see http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\\nvec3 LINEARtoSRGB(vec3 color)\\n{\\n    return pow(color, vec3(INV_GAMMA));\\n}\\n\\n// sRGB to linear approximation\\n// see http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\\nvec4 SRGBtoLINEAR(vec4 srgbIn)\\n{\\n    return vec4(pow(srgbIn.xyz, vec3(GAMMA)), srgbIn.w);\\n}\\n\\n// Uncharted 2 tone map\\n// see: http://filmicworlds.com/blog/filmic-tonemapping-operators/\\nvec3 toneMapUncharted2Impl(vec3 color)\\n{\\n    const float A = 0.15;\\n    const float B = 0.50;\\n    const float C = 0.10;\\n    const float D = 0.20;\\n    const float E = 0.02;\\n    const float F = 0.30;\\n    return ((color*(A*color+C*B)+D*E)/(color*(A*color+B)+D*F))-E/F;\\n}\\n\\nvec3 toneMapUncharted(vec3 color)\\n{\\n    const float W = 11.2;\\n    color = toneMapUncharted2Impl(color * 2.0);\\n    vec3 whiteScale = 1.0 / toneMapUncharted2Impl(vec3(W));\\n    return LINEARtoSRGB(color * whiteScale);\\n}\\n\\n// Hejl Richard tone map\\n// see: http://filmicworlds.com/blog/filmic-tonemapping-operators/\\nvec3 toneMapHejlRichard(vec3 color)\\n{\\n    color = max(vec3(0.0), color - vec3(0.004));\\n    return (color*(6.2*color+.5))/(color*(6.2*color+1.7)+0.06);\\n}\\n\\n// ACES tone map\\n// see: https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/\\nvec3 toneMapACES(vec3 color)\\n{\\n    const float A = 2.51;\\n    const float B = 0.03;\\n    const float C = 2.43;\\n    const float D = 0.59;\\n    const float E = 0.14;\\n    return LINEARtoSRGB(clamp((color * (A * color + B)) / (color * (C * color + D) + E), 0.0, 1.0));\\n}\\n\\nvec3 toneMap(vec3 color)\\n{\\n    color *= u_Exposure;\\n\\n#ifdef TONEMAP_UNCHARTED\\n    return toneMapUncharted(color);\\n#endif\\n\\n#ifdef TONEMAP_HEJLRICHARD\\n    return toneMapHejlRichard(color);\\n#endif\\n\\n#ifdef TONEMAP_ACES\\n    return toneMapACES(color);\\n#endif\\n\\n    return LINEARtoSRGB(color);\\n}\\n\\n\\n// KHR_lights_punctual extension.\\n// see https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\\n\\nstruct Light\\n{\\n    vec3 direction;\\n    float range;\\n\\n    vec3 color;\\n    float intensity;\\n\\n    vec3 position;\\n    float innerConeCos;\\n\\n    float outerConeCos;\\n    int type;\\n\\n    vec2 padding;\\n};\\n\\nconst int LightType_Directional = 0;\\nconst int LightType_Point = 1;\\nconst int LightType_Spot = 2;\\n\\n#ifdef USE_PUNCTUAL\\nuniform Light u_Lights[LIGHT_COUNT];\\n#endif\\n\\n#if defined(MATERIAL_SPECULARGLOSSINESS) || defined(MATERIAL_METALLICROUGHNESS)\\nuniform float u_MetallicFactor;\\nuniform float u_RoughnessFactor;\\nuniform vec4 u_BaseColorFactor;\\n#endif\\n\\n#ifdef USE_INSTANCING\\nFRAG_IN vec4 v_BaseColorFactor;\\n#endif\\n\\n#ifdef MATERIAL_SPECULARGLOSSINESS\\nuniform vec3 u_SpecularFactor;\\nuniform vec4 u_DiffuseFactor;\\nuniform float u_GlossinessFactor;\\n#endif\\n\\n#ifdef ALPHAMODE_MASK\\nuniform float u_AlphaCutoff;\\n#endif\\n\\n#ifdef USE_SHADOW_MAPPING\\nuniform int u_ShadowLightIndex;\\n#endif\\n\\nuniform vec3 u_Camera;\\n\\nuniform int u_MipCount;\\n\\nstruct MaterialInfo\\n{\\n    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\\n    vec3 reflectance0;            // full reflectance color (normal incidence angle)\\n\\n    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\\n    vec3 diffuseColor;            // color contribution from diffuse lighting\\n\\n    vec3 reflectance90;           // reflectance color at grazing angle\\n    vec3 specularColor;           // color contribution from specular lighting\\n};\\n\\n// Calculation of the lighting contribution from an optional Image Based Light source.\\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\\n// See our README.md on Environment Maps [3] for additional discussion.\\n#ifdef USE_IBL\\nvec3 getIBLContribution(MaterialInfo materialInfo, vec3 n, vec3 v)\\n{\\n    float NdotV = clamp(dot(n, v), 0.0, 1.0);\\n\\n    float lod = clamp(materialInfo.perceptualRoughness * float(u_MipCount), 0.0, float(u_MipCount));\\n    vec3 reflection = normalize(reflect(-v, n));\\n\\n    vec2 brdfSamplePoint = clamp(vec2(NdotV, materialInfo.perceptualRoughness), vec2(0.0, 0.0), vec2(1.0, 1.0));\\n    // retrieve a scale and bias to F0. See [1], Figure 3\\n    vec2 brdf = _texture(u_brdfLUT, brdfSamplePoint).rg;\\n\\n    vec4 diffuseSample = _texture(u_DiffuseEnvSampler, n);\\n\\n#ifdef USE_TEX_LOD\\n    vec4 specularSample = _textureLod(u_SpecularEnvSampler, reflection, lod);\\n#else\\n    vec4 specularSample = _texture(u_SpecularEnvSampler, reflection);\\n#endif\\n\\n#ifdef USE_HDR\\n    // Already linear.\\n    vec3 diffuseLight = diffuseSample.rgb;\\n    vec3 specularLight = specularSample.rgb;\\n#else\\n    vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\\n    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\\n#endif\\n\\n    vec3 diffuse = diffuseLight * materialInfo.diffuseColor;\\n    vec3 specular = specularLight * (materialInfo.specularColor * brdf.x + brdf.y);\\n\\n    return diffuse + specular;\\n}\\n#endif\\n\\n// Lambert lighting\\n// see https://seblagarde.wordpress.com/2012/01/08/pi-or-not-to-pi-in-game-lighting-equation/\\nvec3 diffuse(MaterialInfo materialInfo)\\n{\\n    return materialInfo.diffuseColor / M_PI;\\n}\\n\\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\\n// Implementation of fresnel from [4], Equation 15\\nvec3 specularReflection(MaterialInfo materialInfo, AngularInfo angularInfo)\\n{\\n    return materialInfo.reflectance0 + (materialInfo.reflectance90 - materialInfo.reflectance0) * pow(clamp(1.0 - angularInfo.VdotH, 0.0, 1.0), 5.0);\\n}\\n\\n// Smith Joint GGX\\n// Note: Vis = G / (4 * NdotL * NdotV)\\n// see Eric Heitz. 2014. Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs. Journal of Computer Graphics Techniques, 3\\n// see Real-Time Rendering. Page 331 to 336.\\n// see https://google.github.io/filament/Filament.md.html#materialsystem/specularbrdf/geometricshadowing(specularg)\\nfloat visibilityOcclusion(MaterialInfo materialInfo, AngularInfo angularInfo)\\n{\\n    float NdotL = angularInfo.NdotL;\\n    float NdotV = angularInfo.NdotV;\\n    float alphaRoughnessSq = materialInfo.alphaRoughness * materialInfo.alphaRoughness;\\n\\n    float GGXV = NdotL * sqrt(NdotV * NdotV * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\\n    float GGXL = NdotV * sqrt(NdotL * NdotL * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\\n\\n    float GGX = GGXV + GGXL;\\n    if (GGX > 0.0)\\n    {\\n        return 0.5 / GGX;\\n    }\\n    return 0.0;\\n}\\n\\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\\n// Implementation from \\\"Average Irregularity Representation of a Roughened Surface for Ray Reflection\\\" by T. S. Trowbridge, and K. P. Reitz\\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\\nfloat microfacetDistribution(MaterialInfo materialInfo, AngularInfo angularInfo)\\n{\\n    float alphaRoughnessSq = materialInfo.alphaRoughness * materialInfo.alphaRoughness;\\n    float f = (angularInfo.NdotH * alphaRoughnessSq - angularInfo.NdotH) * angularInfo.NdotH + 1.0;\\n    return alphaRoughnessSq / (M_PI * f * f);\\n}\\n\\nvec3 getPointShade(vec3 pointToLight, MaterialInfo materialInfo, vec3 normal, vec3 view)\\n{\\n    AngularInfo angularInfo = getAngularInfo(pointToLight, normal, view);\\n\\n    if (angularInfo.NdotL > 0.0 || angularInfo.NdotV > 0.0)\\n    {\\n        // Calculate the shading terms for the microfacet specular shading model\\n        vec3 F = specularReflection(materialInfo, angularInfo);\\n        float Vis = visibilityOcclusion(materialInfo, angularInfo);\\n        float D = microfacetDistribution(materialInfo, angularInfo);\\n\\n        // Calculation of analytical lighting contribution\\n        vec3 diffuseContrib = (1.0 - F) * diffuse(materialInfo);\\n        vec3 specContrib = F * Vis * D;\\n\\n        // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\\n        return angularInfo.NdotL * (diffuseContrib + specContrib);\\n    }\\n\\n    return vec3(0.0, 0.0, 0.0);\\n}\\n\\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_lights_punctual/README.md#range-property\\nfloat getRangeAttenuation(float range, float distance)\\n{\\n    if (range <= 0.0)\\n    {\\n        // negative range means unlimited\\n        return 1.0;\\n    }\\n    return max(min(1.0 - pow(distance / range, 4.0), 1.0), 0.0) / pow(distance, 2.0);\\n}\\n\\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_lights_punctual/README.md#inner-and-outer-cone-angles\\nfloat getSpotAttenuation(vec3 pointToLight, vec3 spotDirection, float outerConeCos, float innerConeCos)\\n{\\n    float actualCos = dot(normalize(spotDirection), normalize(-pointToLight));\\n    if (actualCos > outerConeCos)\\n    {\\n        if (actualCos < innerConeCos)\\n        {\\n            return smoothstep(outerConeCos, innerConeCos, actualCos);\\n        }\\n        return 1.0;\\n    }\\n    return 0.0;\\n}\\n\\nvec3 applyDirectionalLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view, float shadow)\\n{\\n    vec3 pointToLight = -light.direction;\\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view) * shadow;\\n    return light.intensity * light.color * shade;\\n}\\n\\nvec3 applyPointLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view)\\n{\\n    vec3 pointToLight = light.position - v_Position;\\n    float distance = length(pointToLight);\\n    float attenuation = getRangeAttenuation(light.range, distance);\\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view);\\n    return attenuation * light.intensity * light.color * shade;\\n}\\n\\nvec3 applySpotLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view, float shadow)\\n{\\n    vec3 pointToLight = light.position - v_Position;\\n    float distance = length(pointToLight);\\n    float rangeAttenuation = getRangeAttenuation(light.range, distance);\\n    float spotAttenuation = getSpotAttenuation(pointToLight, light.direction, light.outerConeCos, light.innerConeCos);\\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view) * shadow;\\n    return rangeAttenuation * spotAttenuation * light.intensity * light.color * shade;\\n}\\n\\n#ifdef WEBGL2\\n    out vec4 FRAG_COLOR;\\n#endif\\n\\nvoid main()\\n{\\n    // Metallic and Roughness material properties are packed together\\n    // In glTF, these factors can be specified by fixed scalar values\\n    // or from a metallic-roughness map\\n    float perceptualRoughness = 0.0;\\n    float metallic = 0.0;\\n    vec4 baseColor = vec4(0.0, 0.0, 0.0, 1.0);\\n    vec3 diffuseColor = vec3(0.0);\\n    vec3 specularColor= vec3(0.0);\\n    vec3 f0 = vec3(0.04);\\n\\n#ifdef MATERIAL_SPECULARGLOSSINESS\\n\\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\\n    vec4 sgSample = SRGBtoLINEAR(_texture(u_SpecularGlossinessSampler, getSpecularGlossinessUV()));\\n    perceptualRoughness = (1.0 - sgSample.a * u_GlossinessFactor); // glossiness to roughness\\n    f0 = sgSample.rgb * u_SpecularFactor; // specular\\n#else\\n    f0 = u_SpecularFactor;\\n    perceptualRoughness = 1.0 - u_GlossinessFactor;\\n#endif // ! HAS_SPECULAR_GLOSSINESS_MAP\\n\\n#ifdef HAS_DIFFUSE_MAP\\n    baseColor = SRGBtoLINEAR(_texture(u_DiffuseSampler, getDiffuseUV())) * u_DiffuseFactor;\\n#else\\n    baseColor = u_DiffuseFactor;\\n#endif // !HAS_DIFFUSE_MAP\\n\\n    baseColor *= getVertexColor();\\n\\n    // f0 = specular\\n    specularColor = f0;\\n    float oneMinusSpecularStrength = 1.0 - max(max(f0.r, f0.g), f0.b);\\n    diffuseColor = baseColor.rgb * oneMinusSpecularStrength;\\n\\n#ifdef DEBUG_METALLIC\\n    // do conversion between metallic M-R and S-G metallic\\n    metallic = solveMetallic(baseColor.rgb, specularColor, oneMinusSpecularStrength);\\n#endif // ! DEBUG_METALLIC\\n\\n#endif // ! MATERIAL_SPECULARGLOSSINESS\\n\\n#ifdef MATERIAL_METALLICROUGHNESS\\n\\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\\n    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\\n    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\\n    vec4 mrSample = _texture(u_MetallicRoughnessSampler, getMetallicRoughnessUV());\\n    perceptualRoughness = mrSample.g * u_RoughnessFactor;\\n    metallic = mrSample.b * u_MetallicFactor;\\n#else\\n    metallic = u_MetallicFactor;\\n    perceptualRoughness = u_RoughnessFactor;\\n#endif\\n\\n    vec4 baseColorFactor = u_BaseColorFactor;\\n#ifdef USE_INSTANCING\\n    baseColorFactor = v_BaseColorFactor;\\n#endif\\n\\n    // The albedo may be defined from a base texture or a flat color\\n#ifdef HAS_BASE_COLOR_MAP\\n    baseColor = SRGBtoLINEAR(_texture(u_BaseColorSampler, getBaseColorUV())) * baseColorFactor;\\n#else\\n    baseColor = baseColorFactor;\\n#endif\\n\\n    baseColor *= getVertexColor();\\n\\n    diffuseColor = baseColor.rgb * (vec3(1.0) - f0) * (1.0 - metallic);\\n\\n    specularColor = mix(f0, baseColor.rgb, metallic);\\n\\n#endif // ! MATERIAL_METALLICROUGHNESS\\n\\n#ifdef ALPHAMODE_MASK\\n    if(baseColor.a < u_AlphaCutoff)\\n    {\\n        discard;\\n    }\\n    baseColor.a = 1.0;\\n#endif\\n\\n#ifdef ALPHAMODE_OPAQUE\\n    baseColor.a = 1.0;\\n#endif\\n\\n#ifdef MATERIAL_UNLIT\\n    FRAG_COLOR = vec4(LINEARtoSRGB(baseColor.rgb) * baseColor.a, baseColor.a);\\n    return;\\n#endif\\n\\n    perceptualRoughness = clamp(perceptualRoughness, 0.0, 1.0);\\n    metallic = clamp(metallic, 0.0, 1.0);\\n\\n    // Roughness is authored as perceptual roughness; as is convention,\\n    // convert to material roughness by squaring the perceptual roughness [2].\\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\\n\\n    // Compute reflectance.\\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\\n\\n    vec3 specularEnvironmentR0 = specularColor.rgb;\\n    // Anything less than 2% is physically impossible and is instead considered to be shadowing. Compare to \\\"Real-Time-Rendering\\\" 4th editon on page 325.\\n    vec3 specularEnvironmentR90 = vec3(clamp(reflectance * 50.0, 0.0, 1.0));\\n\\n    MaterialInfo materialInfo = MaterialInfo(\\n        perceptualRoughness,\\n        specularEnvironmentR0,\\n        alphaRoughness,\\n        diffuseColor,\\n        specularEnvironmentR90,\\n        specularColor\\n    );\\n\\n    // LIGHTING\\n\\n    vec3 color = vec3(0.0, 0.0, 0.0);\\n    vec3 normal = getNormal();\\n    vec3 view = normalize(u_Camera - v_Position);\\n\\n    float shadow = 1.0;\\n    #ifdef USE_SHADOW_MAPPING\\n        shadow = getShadowContribution();\\n    #endif\\n\\n#ifdef USE_PUNCTUAL\\n    for (int i = 0; i < LIGHT_COUNT; ++i)\\n    {\\n        float shadowContribution = shadow;\\n        #ifdef USE_SHADOW_MAPPING\\n        if (u_ShadowLightIndex != i) \\n        {\\n            shadowContribution = 1.0;\\n        }\\n        #endif\\n        Light light = u_Lights[i];\\n        if (light.type == LightType_Directional)\\n        {\\n            color += applyDirectionalLight(light, materialInfo, normal, view, shadowContribution);\\n        }\\n        else if (light.type == LightType_Point)\\n        {\\n            color += applyPointLight(light, materialInfo, normal, view);\\n        }\\n        else if (light.type == LightType_Spot)\\n        {\\n            color += applySpotLight(light, materialInfo, normal, view, shadowContribution);\\n        }\\n    }\\n#endif\\n\\n    // Calculate lighting contribution from image based lighting source (IBL)\\n#ifdef USE_IBL\\n    color += getIBLContribution(materialInfo, normal, view);\\n#endif\\n\\n    float ao = 1.0;\\n    // Apply optional PBR terms for additional (optional) shading\\n#ifdef HAS_OCCLUSION_MAP\\n    ao = _texture(u_OcclusionSampler,  getOcclusionUV()).r;\\n    color = mix(color, color * ao, u_OcclusionStrength);\\n#endif\\n\\n    vec3 emissive = vec3(0);\\n#ifdef HAS_EMISSIVE_MAP\\n    emissive = SRGBtoLINEAR(_texture(u_EmissiveSampler, getEmissiveUV())).rgb * u_EmissiveFactor;\\n    color += emissive;\\n#endif\\n\\n#ifndef DEBUG_OUTPUT // no debug\\n\\n   // regular shading\\n    FRAG_COLOR = vec4(toneMap(color) * baseColor.a, baseColor.a);\\n\\n#else // debug output\\n\\n    #ifdef DEBUG_METALLIC\\n        FRAG_COLOR.rgb = vec3(metallic);\\n    #endif\\n\\n    #ifdef DEBUG_ROUGHNESS\\n        FRAG_COLOR.rgb = vec3(perceptualRoughness);\\n    #endif\\n\\n    #ifdef DEBUG_NORMAL\\n        #ifdef HAS_NORMAL_MAP\\n            FRAG_COLOR.rgb = _texture(u_NormalSampler, getNormalUV()).rgb;\\n        #else\\n            FRAG_COLOR.rgb = vec3(0.5, 0.5, 1.0);\\n        #endif\\n    #endif\\n\\n    #ifdef DEBUG_BASECOLOR\\n        FRAG_COLOR.rgb = LINEARtoSRGB(baseColor.rgb);\\n    #endif\\n\\n    #ifdef DEBUG_OCCLUSION\\n        FRAG_COLOR.rgb = vec3(ao);\\n    #endif\\n\\n    #ifdef DEBUG_EMISSIVE\\n        FRAG_COLOR.rgb = LINEARtoSRGB(emissive);\\n    #endif\\n\\n    #ifdef DEBUG_F0\\n        FRAG_COLOR.rgb = vec3(f0);\\n    #endif\\n\\n    #ifdef DEBUG_ALPHA\\n        FRAG_COLOR.rgb = vec3(baseColor.a);\\n    #endif\\n\\n    FRAG_COLOR.a = 1.0;\\n\\n#endif // !DEBUG_OUTPUT\\n}\\n\"};","export enum MaterialRenderSortType {\n  opaque = \"opaque\",\n  transparent = \"transparent\"\n}","export var Shader = {\"source\":\"#version VERSION\\n\\n#define FEATURES\\n\\nvec4 _texture(sampler2D sampler, vec2 coord)\\n{\\n#ifdef WEBGL2\\n    return texture(sampler, coord);\\n#else\\n    return texture2D(sampler, coord);\\n#endif\\n}\\n\\nvec4 _texture(samplerCube sampler, vec3 coord)\\n{\\n#ifdef WEBGL2\\n    return texture(sampler, coord);\\n#else\\n    return textureCube(sampler, coord);\\n#endif\\n}\\n#ifdef HAS_TARGET_POSITION0\\nVERT_IN vec3 a_Target_Position0;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION1\\nVERT_IN vec3 a_Target_Position1;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION2\\nVERT_IN vec3 a_Target_Position2;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION3\\nVERT_IN vec3 a_Target_Position3;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION4\\nVERT_IN vec3 a_Target_Position4;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION5\\nVERT_IN vec3 a_Target_Position5;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION6\\nVERT_IN vec3 a_Target_Position6;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION7\\nVERT_IN vec3 a_Target_Position7;\\n#endif\\n\\n#ifdef HAS_TARGET_NORMAL0\\nVERT_IN vec3 a_Target_Normal0;\\n#endif\\n\\n#ifdef HAS_TARGET_NORMAL1\\nVERT_IN vec3 a_Target_Normal1;\\n#endif\\n\\n#ifdef HAS_TARGET_NORMAL2\\nVERT_IN vec3 a_Target_Normal2;\\n#endif\\n\\n#ifdef HAS_TARGET_NORMAL3\\nVERT_IN vec3 a_Target_Normal3;\\n#endif\\n\\n#ifdef HAS_TARGET_TANGENT0\\nVERT_IN vec3 a_Target_Tangent0;\\n#endif\\n\\n#ifdef HAS_TARGET_TANGENT1\\nVERT_IN vec3 a_Target_Tangent1;\\n#endif\\n\\n#ifdef HAS_TARGET_TANGENT2\\nVERT_IN vec3 a_Target_Tangent2;\\n#endif\\n\\n#ifdef HAS_TARGET_TANGENT3\\nVERT_IN vec3 a_Target_Tangent3;\\n#endif\\n\\n#ifdef USE_MORPHING\\nuniform float u_morphWeights[WEIGHT_COUNT];\\n#endif\\n\\n#ifdef HAS_JOINT_SET1\\nVERT_IN vec4 a_Joint1;\\n#endif\\n\\n#ifdef HAS_JOINT_SET2\\nVERT_IN vec4 a_Joint2;\\n#endif\\n\\n#ifdef HAS_WEIGHT_SET1\\nVERT_IN vec4 a_Weight1;\\n#endif\\n\\n#ifdef HAS_WEIGHT_SET2\\nVERT_IN vec4 a_Weight2;\\n#endif\\n\\n#ifdef USE_SKINNING\\n#ifdef USE_SKINNING_TEXTURE\\nuniform sampler2D u_jointMatrixSampler;\\nuniform sampler2D u_jointNormalMatrixSampler;\\n#else\\nuniform mat4 u_jointMatrix[JOINT_COUNT];\\nuniform mat4 u_jointNormalMatrix[JOINT_COUNT];\\n#endif\\n#endif\\n\\n// these offsets assume the texture is 4 pixels across\\n#define ROW0_U ((0.5 + 0.0) / 4.0)\\n#define ROW1_U ((0.5 + 1.0) / 4.0)\\n#define ROW2_U ((0.5 + 2.0) / 4.0)\\n#define ROW3_U ((0.5 + 3.0) / 4.0)\\n\\n#ifdef USE_SKINNING\\nmat4 getJointMatrix(float boneNdx) {\\n    #ifdef USE_SKINNING_TEXTURE\\n    float v = (boneNdx + 0.5) / float(JOINT_COUNT);\\n    return mat4(\\n        _texture(u_jointMatrixSampler, vec2(ROW0_U, v)),\\n        _texture(u_jointMatrixSampler, vec2(ROW1_U, v)),\\n        _texture(u_jointMatrixSampler, vec2(ROW2_U, v)),\\n        _texture(u_jointMatrixSampler, vec2(ROW3_U, v))\\n    );\\n    #else\\n    return u_jointMatrix[int(boneNdx)];\\n    #endif\\n}\\n\\nmat4 getJointNormalMatrix(float boneNdx) {\\n    #ifdef USE_SKINNING_TEXTURE\\n    float v = (boneNdx + 0.5) / float(JOINT_COUNT);\\n    return mat4(\\n        _texture(u_jointNormalMatrixSampler, vec2(ROW0_U, v)),\\n        _texture(u_jointNormalMatrixSampler, vec2(ROW1_U, v)),\\n        _texture(u_jointNormalMatrixSampler, vec2(ROW2_U, v)),\\n        _texture(u_jointNormalMatrixSampler, vec2(ROW3_U, v))\\n    );\\n    #else\\n    return u_jointNormalMatrix[int(boneNdx)];\\n    #endif\\n}\\n\\nmat4 getSkinningMatrix()\\n{\\n    mat4 skin = mat4(0);\\n\\n    #if defined(HAS_WEIGHT_SET1) && defined(HAS_JOINT_SET1)\\n    skin +=\\n        a_Weight1.x * getJointMatrix(a_Joint1.x) +\\n        a_Weight1.y * getJointMatrix(a_Joint1.y) +\\n        a_Weight1.z * getJointMatrix(a_Joint1.z) +\\n        a_Weight1.w * getJointMatrix(a_Joint1.w);\\n    #endif\\n\\n    return skin;\\n}\\n\\nmat4 getSkinningNormalMatrix()\\n{\\n    mat4 skin = mat4(0);\\n\\n    #if defined(HAS_WEIGHT_SET1) && defined(HAS_JOINT_SET1)\\n    skin +=\\n        a_Weight1.x * getJointNormalMatrix(a_Joint1.x) +\\n        a_Weight1.y * getJointNormalMatrix(a_Joint1.y) +\\n        a_Weight1.z * getJointNormalMatrix(a_Joint1.z) +\\n        a_Weight1.w * getJointNormalMatrix(a_Joint1.w);\\n    #endif\\n\\n    return skin;\\n}\\n#endif // !USE_SKINNING\\n\\n#ifdef USE_MORPHING\\nvec4 getTargetPosition()\\n{\\n    vec4 pos = vec4(0);\\n\\n#ifdef HAS_TARGET_POSITION0\\n    pos.xyz += u_morphWeights[0] * a_Target_Position0;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION1\\n    pos.xyz += u_morphWeights[1] * a_Target_Position1;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION2\\n    pos.xyz += u_morphWeights[2] * a_Target_Position2;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION3\\n    pos.xyz += u_morphWeights[3] * a_Target_Position3;\\n#endif\\n\\n#ifdef HAS_TARGET_POSITION4\\n    pos.xyz += u_morphWeights[4] * a_Target_Position4;\\n#endif\\n\\n    return pos;\\n}\\n\\nvec4 getTargetNormal()\\n{\\n    vec4 normal = vec4(0);\\n\\n#ifdef HAS_TARGET_NORMAL0\\n    normal.xyz += u_morphWeights[0] * a_Target_Normal0;\\n#endif\\n\\n#ifdef HAS_TARGET_NORMAL1\\n    normal.xyz += u_morphWeights[1] * a_Target_Normal1;\\n#endif\\n\\n#ifdef HAS_TARGET_NORMAL2\\n    normal.xyz += u_morphWeights[2] * a_Target_Normal2;\\n#endif\\n\\n#ifdef HAS_TARGET_NORMAL3\\n    normal.xyz += u_morphWeights[3] * a_Target_Normal3;\\n#endif\\n\\n#ifdef HAS_TARGET_NORMAL4\\n    normal.xyz += u_morphWeights[4] * a_Target_Normal4;\\n#endif\\n\\n    return normal;\\n}\\n\\nvec4 getTargetTangent()\\n{\\n    vec4 tangent = vec4(0);\\n\\n#ifdef HAS_TARGET_TANGENT0\\n    tangent.xyz += u_morphWeights[0] * a_Target_Tangent0;\\n#endif\\n\\n#ifdef HAS_TARGET_TANGENT1\\n    tangent.xyz += u_morphWeights[1] * a_Target_Tangent1;\\n#endif\\n\\n#ifdef HAS_TARGET_TANGENT2\\n    tangent.xyz += u_morphWeights[2] * a_Target_Tangent2;\\n#endif\\n\\n#ifdef HAS_TARGET_TANGENT3\\n    tangent.xyz += u_morphWeights[3] * a_Target_Tangent3;\\n#endif\\n\\n#ifdef HAS_TARGET_TANGENT4\\n    tangent.xyz += u_morphWeights[4] * a_Target_Tangent4;\\n#endif\\n\\n    return tangent;\\n}\\n\\n#endif // !USE_MORPHING\\n\\n\\nVERT_IN vec4 a_Position;\\nVERT_OUT vec3 v_Position;\\n\\n#ifdef USE_INSTANCING\\nVERT_IN vec4 a_ModelMatrix0;\\nVERT_IN vec4 a_ModelMatrix1;\\nVERT_IN vec4 a_ModelMatrix2;\\nVERT_IN vec4 a_ModelMatrix3;\\n#endif\\n\\n#ifdef USE_INSTANCING\\nVERT_IN vec4 a_BaseColorFactor;\\nVERT_OUT vec4 v_BaseColorFactor;\\n#endif\\n\\n#ifdef USE_INSTANCING\\nVERT_IN vec4 a_NormalMatrix0;\\nVERT_IN vec4 a_NormalMatrix1;\\nVERT_IN vec4 a_NormalMatrix2;\\nVERT_IN vec4 a_NormalMatrix3;\\n#endif\\n\\n#ifdef HAS_NORMALS\\nVERT_IN vec4 a_Normal;\\n#endif\\n\\n#ifdef HAS_TANGENTS\\nVERT_IN vec4 a_Tangent;\\n#endif\\n\\n#ifdef HAS_NORMALS\\n#ifdef HAS_TANGENTS\\nVERT_OUT mat3 v_TBN;\\n#else\\nVERT_OUT vec3 v_Normal;\\n#endif\\n#endif\\n\\n#ifdef HAS_UV_SET1\\nVERT_IN vec2 a_UV1;\\n#endif\\n\\n#ifdef HAS_UV_SET2\\nVERT_IN vec2 a_UV2;\\n#endif\\n\\nVERT_OUT vec2 v_UVCoord1;\\nVERT_OUT vec2 v_UVCoord2;\\n\\n#ifdef HAS_VERTEX_COLOR_VEC3\\nVERT_IN vec3 a_Color;\\nVERT_OUT vec3 v_Color;\\n#endif\\n\\n#ifdef HAS_VERTEX_COLOR_VEC4\\nVERT_IN vec4 a_Color;\\nVERT_OUT vec4 v_Color;\\n#endif\\n\\nuniform mat4 u_ViewProjectionMatrix;\\nuniform mat4 u_ModelMatrix;\\nuniform mat4 u_NormalMatrix;\\n\\n#ifdef USE_SHADOW_MAPPING\\nuniform mat4 u_LightViewProjectionMatrix;\\nVERT_OUT vec4 v_PositionLightSpace;\\n#endif\\n\\nvec4 getPosition()\\n{\\n    vec4 pos = a_Position;\\n\\n#ifdef USE_MORPHING\\n    pos += getTargetPosition();\\n#endif\\n\\n#ifdef USE_SKINNING\\n    pos = getSkinningMatrix() * pos;\\n#endif\\n\\n    return pos;\\n}\\n\\n#ifdef HAS_NORMALS\\nvec4 getNormal()\\n{\\n    vec4 normal = a_Normal;\\n\\n#ifdef USE_MORPHING\\n    normal += getTargetNormal();\\n#endif\\n\\n#ifdef USE_SKINNING\\n    normal = getSkinningNormalMatrix() * normal;\\n#endif\\n\\n    return normalize(normal);\\n}\\n#endif\\n\\n#ifdef HAS_TANGENTS\\nvec4 getTangent()\\n{\\n    vec4 tangent = a_Tangent;\\n\\n#ifdef USE_MORPHING\\n    tangent += getTargetTangent();\\n#endif\\n\\n#ifdef USE_SKINNING\\n    tangent = getSkinningMatrix() * tangent;\\n#endif\\n\\n    return normalize(tangent);\\n}\\n#endif\\n\\nvoid main()\\n{\\n    mat4 modelMatrix = u_ModelMatrix;\\n    #ifdef USE_INSTANCING\\n        modelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\\n    #endif\\n    vec4 pos = modelMatrix * getPosition();\\n    v_Position = vec3(pos.xyz) / pos.w;\\n\\n    mat4 normalMatrix = u_NormalMatrix;\\n    #ifdef USE_INSTANCING\\n        normalMatrix = mat4(a_NormalMatrix0, a_NormalMatrix1, a_NormalMatrix2, a_NormalMatrix3);\\n    #endif\\n\\n    #ifdef HAS_NORMALS\\n    #ifdef HAS_TANGENTS\\n    vec4 tangent = getTangent();\\n    vec3 normalW = normalize(vec3(normalMatrix * vec4(getNormal().xyz, 0.0)));\\n    vec3 tangentW = normalize(vec3(modelMatrix * vec4(tangent.xyz, 0.0)));\\n    vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\\n    v_TBN = mat3(tangentW, bitangentW, normalW);\\n    #else // !HAS_TANGENTS\\n    v_Normal = normalize(vec3(normalMatrix * vec4(getNormal().xyz, 0.0)));\\n    #endif\\n    #endif // !HAS_NORMALS\\n\\n    v_UVCoord1 = vec2(0.0, 0.0);\\n    v_UVCoord2 = vec2(0.0, 0.0);\\n\\n    #ifdef HAS_UV_SET1\\n    v_UVCoord1 = a_UV1;\\n    #endif\\n\\n    #ifdef HAS_UV_SET2\\n    v_UVCoord2 = a_UV2;\\n    #endif\\n\\n    #if defined(HAS_VERTEX_COLOR_VEC3) || defined(HAS_VERTEX_COLOR_VEC4)\\n    v_Color = a_Color;\\n    #endif\\n\\n    #ifdef USE_SHADOW_MAPPING\\n    v_PositionLightSpace = u_LightViewProjectionMatrix * pos;\\n    #endif\\n\\n    #ifdef USE_INSTANCING\\n    v_BaseColorFactor = a_BaseColorFactor;\\n    #endif\\n\\n    gl_Position = u_ViewProjectionMatrix * pos;\\n}\\n\"};","import { Program, Renderer, State, Buffer } from \"@pixi/core\"\nimport { DRAW_MODES } from \"@pixi/constants\"\n\nimport { MeshGeometry3D } from \"../../mesh/geometry/mesh-geometry\"\nimport { Mesh3D } from \"../../mesh/mesh\"\nimport { MeshShader } from \"../../mesh/mesh-shader\"\nimport { StandardShaderInstancing } from \"./standard-shader-instancing\"\nimport { StandardShaderSource } from \"./standard-shader-source\"\nimport { Shader as MetallicRoughness } from \"./shader/metallic-roughness.frag\"\nimport { Shader as Primitive } from \"./shader/primitive.vert\"\n\nexport class StandardShader extends MeshShader {\n  private _instancing = new StandardShaderInstancing()\n\n  static build(renderer: Renderer, features: string[]) {\n    let program = Program.from(\n      StandardShaderSource.build(Primitive.source, features, renderer),\n      StandardShaderSource.build(MetallicRoughness.source, features, renderer))\n\n    return new StandardShader(program)\n  }\n\n  get name() {\n    return \"standard-shader\"\n  }\n\n  createShaderGeometry(geometry: MeshGeometry3D, instanced: boolean) {\n    let result = super.createShaderGeometry(geometry, instanced)\n    if (instanced) {\n      this._instancing.addGeometryAttributes(result)\n    }\n    if (geometry.targets) {\n      for (let i = 0; i < geometry.targets.length; i++) {\n        let positions = geometry.targets[i].positions\n        if (positions) {\n          result.addAttribute(`a_Target_Position${i}`, new Buffer(positions.buffer),\n            3, false, positions.componentType, positions.stride)\n        }\n        let normals = geometry.targets[i].normals\n        if (normals) {\n          result.addAttribute(`a_Target_Normal${i}`, new Buffer(normals.buffer),\n            3, false, normals.componentType, normals.stride)\n        }\n        let tangents = geometry.targets[i].tangents\n        if (tangents) {\n          result.addAttribute(`a_Target_Tangent${i}`, new Buffer(tangents.buffer),\n            3, false, tangents.componentType, tangents.stride)\n        }\n      }\n    }\n    if (geometry.uvs && geometry.uvs[1]) {\n      result.addAttribute(\"a_UV2\", new Buffer(geometry.uvs[1].buffer),\n        2, false, geometry.uvs[1].componentType, geometry.uvs[1].stride)\n    }\n    if (geometry.joints) {\n      result.addAttribute(\"a_Joint1\", new Buffer(geometry.joints.buffer),\n        4, false, geometry.joints.componentType, geometry.joints.stride)\n    }\n    if (geometry.weights) {\n      result.addAttribute(\"a_Weight1\", new Buffer(geometry.weights.buffer),\n        4, false, geometry.weights.componentType, geometry.weights.stride)\n    }\n    return result\n  }\n\n  render(mesh: Mesh3D, renderer: Renderer, state: State, drawMode: DRAW_MODES) {\n    if (mesh.instances.length > 0) {\n      const filteredInstances = mesh.instances.filter((instance) => instance.worldVisible && instance.renderable);\n      if (filteredInstances.length === 0) {\n        //early exit - this avoids us drawing the last known instance in the instance buffer\n        return;\n      }\n      this._instancing.updateBuffers(filteredInstances)\n    }\n    super.render(mesh, renderer, state, drawMode)\n  }\n}","import { DRAW_MODES, BLEND_MODES } from \"@pixi/constants\"\nimport { State, Renderer, Program } from \"@pixi/core\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { MaterialRenderSortType } from \"./material-render-sort-type\"\nimport { MeshShader } from \"../mesh/mesh-shader\"\n\n/**\n * Materials are used to render a mesh with a specific visual appearance.\n */\nexport class Material {\n  protected _renderSortType = MaterialRenderSortType.opaque\n  protected _shader?: MeshShader\n\n  /** State used to render a mesh. */\n  state = Object.assign(new State(), {\n    culling: true, clockwiseFrontFace: false, depthTest: true\n  })\n\n  /** Draw mode used to render a mesh. */\n  drawMode = DRAW_MODES.TRIANGLES\n\n  /**\n   * Sort type used to render a mesh. Transparent materials will be rendered\n   * after opaque materials.\n   */\n  renderSortType = MaterialRenderSortType.opaque\n\n  /**\n   * Value indicating if writing into the depth buffer is enabled or disabled.\n   * Depth mask feature is only available in PixiJS 6.0+ and won't have any \n   * effects in previous versions.\n   */\n  get depthMask() {\n    return this.state.depthMask\n  }\n\n  set depthMask(value: boolean) {\n    this.state.depthMask = value\n  }\n\n  /**\n   * Value indicating if the material is double sided. When set to true, the\n   * culling state will be set to false.\n   */\n  get doubleSided() {\n    return !this.state.culling\n  }\n\n  set doubleSided(value: boolean) {\n    this.state.culling = !value\n  }\n\n  /** Blend mode used to render a mesh. */\n  get blendMode() {\n    return this.state.blendMode\n  }\n\n  set blendMode(value: BLEND_MODES) {\n    this.state.blendMode = value\n  }\n\n  /**\n   * Creates a shader used to render the specified mesh.\n   * @param mesh The mesh to create the shader for.\n   * @param renderer The renderer to use.\n   */\n  createShader(mesh: Mesh3D, renderer: Renderer): MeshShader | undefined {\n    return undefined\n  }\n\n  /**\n   * Updates the uniforms for the specified shader.\n   * @param mesh The mesh used for updating the uniforms.\n   * @param shader The shader to update.\n   */\n  updateUniforms?(mesh: Mesh3D, shader: MeshShader): void { }\n\n  /**\n   * Destroys the material and it's used resources.\n   */\n  destroy() { }\n\n  /**\n   * Returns a value indicating if this material supports instancing.\n   */\n  get isInstancingSupported() {\n    return false\n  }\n\n  /**\n   * Creates a new instanced version of this material.\n   */\n  createInstance(): unknown {\n    return undefined\n  }\n\n  /**\n   * Renders the specified mesh.\n   * @param mesh The mesh to render.\n   * @param renderer The renderer to use.\n   */\n  render(mesh: Mesh3D, renderer: Renderer) {\n    if (!this._shader) {\n      this._shader = this.createShader(mesh, renderer)\n      if (!this._shader) {\n        // The shader couldn't be created for some reason. Just ignore it and \n        // try again at next render. The required assets may not have been loaded \n        // yet, so maybe we are waiting for those.\n        return\n      }\n    }\n    if (this.updateUniforms) {\n      this.updateUniforms(mesh, this._shader)\n    }\n    this._shader.render(mesh, renderer, this.state, this.drawMode)\n  }\n\n  /**\n   * Creates a new material from the specified vertex/fragment source.\n   * @param vertexSrc The vertex shader source.\n   * @param fragmentSrc The fragment shader source.\n   * @param updateUniforms The function which will be called for updating the\n   * shader uniforms.\n   */\n  static from(vertexSrc: string, fragmentSrc: string, updateUniforms?: (mesh: Mesh3D, shader: MeshShader) => void): Material {\n    return Object.assign(new Material(), {\n      updateUniforms: updateUniforms || (() => { }),\n      _shader: new MeshShader(Program.from(vertexSrc, fragmentSrc)),\n    })\n  }\n}","import { Renderer, IRendererPlugin } from \"@pixi/core\"\nimport { Compatibility } from \"../compatibility/compatibility\"\nimport { ImageBasedLighting } from \"./image-based-lighting\"\nimport { Light } from \"./light\"\n\n/**\n * A lighting environment represents the different lighting conditions for a \n * specific object or an entire scene.\n */\nexport class LightingEnvironment implements IRendererPlugin {\n  /** The image-based lighting object. */\n  imageBasedLighting?: ImageBasedLighting\n\n  /** The lights affecting this lighting environment. */\n  lights: Light[] = []\n\n  /** The main lighting environment which is used by default. */\n  static main: LightingEnvironment\n\n  /**\n   * Creates a new lighting environment using the specified renderer.\n   * @param renderer The renderer to use.\n   */\n  constructor(public renderer: Renderer, imageBasedLighting?: ImageBasedLighting) {\n    this.renderer.on(\"prerender\", () => {\n      for (let light of this.lights) {\n        // Make sure the transform has been updated in the case where the light\n        // is not part of the stage hierarchy.\n        if (!light.parent) {\n          light.transform.updateTransform()\n        }\n      }\n    })\n    if (!LightingEnvironment.main) {\n      LightingEnvironment.main = this\n    }\n    this.imageBasedLighting = imageBasedLighting\n  }\n\n  destroy() {\n  }\n\n  /** Value indicating if this object is valid to be used for rendering. */\n  get valid() {\n    return !this.imageBasedLighting || this.imageBasedLighting.valid\n  }\n}\n\nCompatibility.installRendererPlugin(\"lighting\", LightingEnvironment)","import { Shader } from \"@pixi/core\"\n\nimport { Mesh3D } from \"../../mesh/mesh\"\nimport { StandardMaterialMatrixTexture } from \"./standard-material-matrix-texture\"\n\nexport class StandardMaterialSkinUniforms {\n  private _jointMatrixTexture?: StandardMaterialMatrixTexture\n  private _jointNormalTexture?: StandardMaterialMatrixTexture\n\n  enableJointMatrixTextures(jointsCount: number) {\n    if (!this._jointMatrixTexture) {\n      this._jointMatrixTexture = new StandardMaterialMatrixTexture(jointsCount)\n    }\n    if (!this._jointNormalTexture) {\n      this._jointNormalTexture = new StandardMaterialMatrixTexture(jointsCount)\n    }\n  }\n\n  destroy() {\n    this._jointNormalTexture?.destroy(true)\n    this._jointMatrixTexture?.destroy(true)\n  }\n\n  update(mesh: Mesh3D, shader: Shader) {\n    if (!mesh.skin) {\n      return\n    }\n    if (this._jointMatrixTexture) {\n      this._jointMatrixTexture.updateBuffer(mesh.skin.jointMatrices)\n      shader.uniforms.u_jointMatrixSampler = this._jointMatrixTexture\n    } else {\n      shader.uniforms.u_jointMatrix = mesh.skin.jointMatrices\n    }\n    if (this._jointNormalTexture) {\n      this._jointNormalTexture.updateBuffer(mesh.skin.jointNormalMatrices)\n      shader.uniforms.u_jointNormalMatrixSampler = this._jointNormalTexture\n    } else {\n      shader.uniforms.u_jointNormalMatrix = mesh.skin.jointNormalMatrices\n    }\n  }\n}","import { Vec3 } from \"../../math/vec3\"\nimport { MeshGeometry3D } from \"./mesh-geometry\"\n\nexport interface SphereGeometryOptions {\n  /** The radius of the sphere. */\n  radius?: number\n  /** The number of segments of the sphere. */\n  segments?: number\n  /** The number of rings of the sphere. */\n  rings?: number\n}\n\nexport namespace SphereGeometry {\n  export function create(options: SphereGeometryOptions = {}) {\n    const { radius = 1, segments = 32, rings = 16 } = options\n\n    // Based on https://github.com/mrdoob/three.js/blob/master/src/geometries/SphereGeometry.js\n\n    const grid = []\n    const indices = []\n    const positions = []\n    const uvs = []\n    const normals = []\n\n    let index = 0\n\n    for (let iy = 0; iy <= rings; iy++) {\n      const vertices = []\n      const v = iy / rings\n\n      let uOffset = 0\n\n      if (iy == 0) {\n        uOffset = 0.5 / segments\n      } else if (iy == rings) {\n        uOffset = - 0.5 / segments\n      }\n      for (let ix = 0; ix <= segments; ix++) {\n        const u = ix / segments\n\n        let x = - radius * Math.cos(u * Math.PI * 2) *\n          Math.sin(v * Math.PI)\n        let y = radius * Math.cos(v * Math.PI)\n        let z = radius * Math.sin(u * Math.PI * 2) *\n          Math.sin(v * Math.PI)\n\n        let pos = Vec3.fromValues(x, y, z)\n\n        positions.push(x, y, z)\n        normals.push(...Vec3.normalize(pos))\n        uvs.push(u + uOffset, 1 - v)\n\n        vertices.push(index++)\n      }\n      grid.push(vertices)\n    }\n\n    for (let iy = 0; iy < rings; iy++) {\n      for (let ix = 0; ix < segments; ix++) {\n        const a = grid[iy][ix + 1]\n        const b = grid[iy][ix]\n        const c = grid[iy + 1][ix]\n        const d = grid[iy + 1][ix + 1]\n        if (iy !== 0) {\n          indices.push(a, b, d)\n        }\n        if (iy !== rings - 1) {\n          indices.push(b, c, d)\n        }\n      }\n    }\n    return Object.assign(new MeshGeometry3D(), {\n      normals: {\n        buffer: new Float32Array(normals)\n      },\n      uvs: [{\n        buffer: new Float32Array(uvs)\n      }],\n      indices: {\n        buffer: new Uint16Array(indices)\n      },\n      positions: {\n        buffer: new Float32Array(positions)\n      }\n    })\n  }\n}","/**\n * Represents a color containing RGBA components.\n */\nexport class Color {\n  private _array4: Float32Array\n  private _array3: Float32Array\n\n  /**\n   * Creates a new color with the specified components (in range 0-1).\n   * @param r The R (red) component.\n   * @param g The G (green) component.\n   * @param b The B (blue) component.\n   * @param a The A (alpha) component.\n   */\n  constructor(r = 0, g = 0, b = 0, a = 1) {\n    this._array4 = new Float32Array([r, g, b, a])\n    this._array3 = this._array4.subarray(0, 3)\n  }\n\n  /**\n   * Creates a new color with the specified components (in range 0-255).\n   * @param r The R (red) component.\n   * @param g The G (green) component.\n   * @param b The B (blue) component.\n   * @param a The A (alpha) component.\n   */\n  static fromBytes(r = 0, g = 0, b = 0, a = 255) {\n    return new Color(r / 255, g / 255, b / 255, a / 255)\n  }\n\n  /**\n   * Creates a new color from the specified hex value.\n   * @param hex The hex value as a string or a number.\n   */\n  static fromHex(hex: number | string) {\n    if (typeof hex === \"string\") {\n      hex = parseInt(hex.replace(/[^0-9A-F]/gi, \"\"), 16)\n    }\n    return Color.fromBytes((hex >> 16) & 255, (hex >> 8) & 255, hex & 255)\n  }\n\n  /** The color as an typed array containing RGB. */\n  get rgb() {\n    return this._array3\n  }\n\n  /** The color as an typed array containing RGBA. */\n  get rgba() {\n    return this._array4\n  }\n\n  /** The R (red) component. */\n  get r() {\n    return this._array4[0]\n  }\n\n  set r(value: number) {\n    this._array4[0] = value\n  }\n\n  /** The G (green) component. */\n  get g() {\n    return this._array4[1]\n  }\n\n  set g(value: number) {\n    this._array4[1] = value\n  }\n\n  /** The B (blue) component. */\n  get b() {\n    return this._array4[2]\n  }\n\n  set b(value: number) {\n    this._array4[2] = value\n  }\n\n  /** The A (alpha) component. */\n  get a() {\n    return this._array4[3]\n  }\n\n  set a(value: number) {\n    this._array4[3] = value\n  }\n\n  /**\n   * Creates a new color from the specified source.\n   * @param source The source to create the color from.\n   */\n  static from(source: number[] | Float32Array) {\n    return new Color(...source)\n  }\n}","import { Color } from \"../../color\"\nimport { StandardMaterial } from \"./standard-material\"\n\n/** Material for instanced meshes which uses the standard material. */\nexport class InstancedStandardMaterial {\n  /** The base color of the material. */\n  baseColor: Color\n\n  /** Creates a new instanced standard material from the specified material. */\n  constructor(material: StandardMaterial) {\n    this.baseColor = new Color(...material.baseColor.rgba)\n  }\n}","import { glTFTexture } from \"./gltf-texture\"\n\n/**\n * glTF defines materials using a common set of parameters that are based on \n * widely used material representations from Physically-Based Rendering (PBR).\n */\nexport class glTFMaterial {\n  alphaCutoff = 0.5\n  alphaMode = \"OPAQUE\"\n  doubleSided = false\n  roughness = 1\n  metallic = 1\n  baseColorTexture?: glTFTexture\n  metallicRoughnessTexture?: glTFTexture\n  normalTexture?: glTFTexture & { scale?: number }\n  occlusionTexture?: glTFTexture & { strength?: number }\n  emissiveTexture?: glTFTexture\n  emissiveFactor = [0, 0, 0]\n  baseColor = [1, 1, 1, 1]\n  unlit = false\n}","import { mat3 } from \"gl-matrix\"\n\nexport class Mat3 {\n  static multiply(a: Float32Array, b: Float32Array, out = new Float32Array(9)) {\n    return <Float32Array>mat3.multiply(out, a, b)\n  }\n}","import { ObservablePoint, DEG_TO_RAD } from \"@pixi/math\"\nimport { Texture } from \"@pixi/core\"\nimport { Mat3 } from \"../math/mat3\"\n\n/**\n * Transform used to offset, rotate and scale texture coordinates.\n */\nexport class TextureTransform {\n  private _rotation = 0\n  private _array = new Float32Array(9)\n  private _dirty = true\n  private _translation = new Float32Array([\n    1, 0, 0, 0, 1, 0, 0, 0, 1\n  ])\n  private _scaling = new Float32Array([\n    1, 0, 0, 0, 1, 0, 0, 0, 1\n  ])\n  private _rotate = new Float32Array([\n    Math.cos(0), -Math.sin(0), 0, Math.sin(0), Math.cos(0), 0, 0, 0, 1\n  ])\n\n  /** The rotation for the texture coordinates. */\n  get rotation() {\n    return this._rotation\n  }\n\n  set rotation(value: number) {\n    this._rotation = value\n    this._rotate.set([\n      Math.cos(value), -Math.sin(value), 0, Math.sin(value), Math.cos(value), 0, 0, 0, 1\n    ])\n    this._dirty = true\n  }\n\n  /** The offset for the texture coordinates. */\n  offset = new ObservablePoint(() => {\n    this._translation.set([\n      1, 0, 0, 0, 1, 0, this.offset.x, this.offset.y, 1\n    ])\n    this._dirty = true\n  }, undefined)\n\n  /** The scale of the texture coordinates. */\n  scale = new ObservablePoint(() => {\n    this._scaling.set([\n      this.scale.x, 0, 0, 0, this.scale.y, 0, 0, 0, 1\n    ])\n    this._dirty = true\n  }, undefined, 1, 1)\n\n  /** The matrix array. */\n  get array() {\n    if (this._dirty) {\n      Mat3.multiply(\n        Mat3.multiply(this._translation, this._rotate, this._array), this._scaling, this._array)\n      this._dirty = false\n    }\n    return this._array\n  }\n\n  /**\n   * Creates a transform from the specified texture frame. Can be used when\n   * texture is in a spritesheet.\n   * @param texture The texture to use.\n   */\n  static fromTexture(texture: Texture) {\n    const transform = new TextureTransform()\n    if (!texture.frame || texture.noFrame) {\n      return transform\n    }\n    let { x, y, width, height } = texture.frame\n    if (texture.rotate === 0) {\n      transform.offset.set(\n        x / texture.baseTexture.width, y / texture.baseTexture.height\n      )\n      transform.scale.set(\n        width / texture.baseTexture.width, \n        height / texture.baseTexture.height\n      )\n    }\n    if (texture.rotate === 2) {\n      x = texture.frame.x + texture.frame.width\n      transform.offset.set(\n        x / texture.baseTexture.width, y / texture.baseTexture.height\n      )\n      transform.scale.set(\n        height / texture.baseTexture.height, \n        width / texture.baseTexture.width\n      )\n      transform.rotation = -90 * DEG_TO_RAD\n    }\n    return transform\n  }\n}","import { BaseTexture, Texture } from \"@pixi/core\"\nimport { TextureTransform } from \"../../texture/texture-transform\"\n\n/**\n * Represents a texture which can have a transform.\n */\nexport class StandardMaterialTexture extends Texture {\n  /** The transform to use for this texture. */\n  transform?: TextureTransform\n\n  /**\n   * Creates a new texture from the specified base texture.\n   * @param baseTexture The base texture.\n   * @param uvSet The uv set to use (0 or 1).\n   */\n  constructor(baseTexture: BaseTexture, public uvSet?: number) {\n    super(baseTexture)\n  }\n}","import { BaseTexture } from \"@pixi/core\"\nimport { StandardMaterialTexture } from \"./standard-material-texture\"\n\n/**\n * Represents a texture which holds specific data for a normal map.\n */\nexport class StandardMaterialNormalTexture extends StandardMaterialTexture {\n  /**\n   * Creates a new texture from the specified base texture.\n   * @param baseTexture The base texture.\n   * @param scale The scale of the normal.\n   * @param uvSet The uv set to use (0 or 1).\n   */\n  constructor(baseTexture: BaseTexture, public scale?: number, public uvSet?: number) {\n    super(baseTexture, uvSet)\n  }\n}","import { BaseTexture } from \"@pixi/core\"\nimport { StandardMaterialTexture } from \"./standard-material-texture\"\n\n/**\n * Represents a texture which holds specific data for a occlusion map.\n */\nexport class StandardMaterialOcclusionTexture extends StandardMaterialTexture {\n  /**\n   * Creates a new texture from the specified base texture.\n   * @param baseTexture The base texture.\n   * @param strength The strength of the occlusion.\n   * @param uvSet The uv set to use (0 or 1).\n   */\n  constructor(baseTexture: BaseTexture, public strength?: number, public uvSet?: number) {\n    super(baseTexture, uvSet)\n  }\n}","import { glTFMaterial } from \"../../gltf/gltf-material\"\nimport { glTFTexture } from \"../../gltf/gltf-texture\"\nimport { TextureTransform } from \"../../texture/texture-transform\"\nimport { MaterialRenderSortType } from \"../material-render-sort-type\"\nimport { Color } from \"../../color\"\nimport { StandardMaterial } from \"./standard-material\"\nimport { StandardMaterialAlphaMode } from \"./standard-material-alpha-mode\"\nimport { StandardMaterialNormalTexture } from \"./standard-material-normal-texture\"\nimport { StandardMaterialOcclusionTexture } from \"./standard-material-occlusion-texture\"\nimport { StandardMaterialTexture } from \"./standard-material-texture\"\n\nexport class StandardMaterialFactory {\n  create(source: unknown) {\n    let material = new StandardMaterial()\n    if (!(source instanceof glTFMaterial)) {\n      return material\n    }\n    material.baseColor = Color.from(source.baseColor)\n    if (source.baseColorTexture) {\n      material.baseColorTexture = new StandardMaterialTexture(\n        source.baseColorTexture.baseTexture, source.baseColorTexture.texCoord)\n      material.baseColorTexture.transform =\n        this.createTextureTransform(source.baseColorTexture)\n    }\n    material.metallic = source.metallic\n    material.roughness = source.roughness\n    if (source.metallicRoughnessTexture) {\n      material.metallicRoughnessTexture = new StandardMaterialTexture(\n        source.metallicRoughnessTexture.baseTexture, source.metallicRoughnessTexture.texCoord)\n      material.metallicRoughnessTexture.transform =\n        this.createTextureTransform(source.metallicRoughnessTexture)\n    }\n    material.emissive = Color.from(source.emissiveFactor)\n    if (source.emissiveTexture) {\n      material.emissiveTexture = new StandardMaterialTexture(\n        source.emissiveTexture.baseTexture, source.emissiveTexture.texCoord)\n      material.emissiveTexture.transform =\n        this.createTextureTransform(source.emissiveTexture)\n    }\n    switch (source.alphaMode) {\n      case \"BLEND\": {\n        material.alphaMode = StandardMaterialAlphaMode.blend\n        material.renderSortType = MaterialRenderSortType.transparent\n        break\n      }\n      case \"MASK\": {\n        material.alphaMode = StandardMaterialAlphaMode.mask\n        break\n      }\n      case \"OPAQUE\": {\n        // Even when the material is \"opaque\", the default value is set to\n        // \"blend\". This is to make it easier to render transparent objects\n        // without having to change the alpha mode.\n        material.alphaMode = StandardMaterialAlphaMode.blend\n        break\n      }\n    }\n    material.unlit = source.unlit\n    material.doubleSided = source.doubleSided\n    material.alphaCutoff = source.alphaCutoff\n    if (source.normalTexture) {\n      material.normalTexture = new StandardMaterialNormalTexture(\n        source.normalTexture.baseTexture, source.normalTexture.scale, source.normalTexture.texCoord)\n      material.normalTexture.transform =\n        this.createTextureTransform(source.normalTexture)\n    }\n    if (source.occlusionTexture) {\n      material.occlusionTexture = new StandardMaterialOcclusionTexture(\n        source.occlusionTexture.baseTexture, source.occlusionTexture.strength, source.occlusionTexture.texCoord)\n      material.occlusionTexture.transform =\n        this.createTextureTransform(source.occlusionTexture)\n    }\n    return material\n  }\n\n  createTextureTransform(texture: glTFTexture) {\n    if (texture.transform) {\n      const transform = new TextureTransform()\n      if (texture.transform.offset) {\n        transform.offset.x = texture.transform.offset[0]\n        transform.offset.y = texture.transform.offset[1]\n      }\n      if (texture.transform.rotation !== undefined) {\n        transform.rotation = texture.transform.rotation\n      }\n      if (texture.transform.scale) {\n        transform.scale.x = texture.transform.scale[0]\n        transform.scale.y = texture.transform.scale[1]\n      }\n      return transform\n    }\n  }\n}","import { Texture } from \"@pixi/core\"\nimport { MIPMAP_MODES } from \"@pixi/constants\"\nimport { Cubemap } from \"../cubemap/cubemap\"\n\nimport png from \"./assets/lut-ggx.png\"\n\n/**\n * Collection of components used for image-based lighting (IBL), a\n * rendering technique which involves capturing an omnidirectional representation\n * of real-world light information as an image.\n */\nexport class ImageBasedLighting {\n  private _diffuse: Cubemap\n  private _specular: Cubemap\n\n  /** The default BRDF integration map lookup texture. */\n  static defaultLookupBrdf = Texture.from(png, {\n    mipmap: MIPMAP_MODES.OFF\n  })\n\n  /** Cube texture used for the diffuse component. */\n  get diffuse() {\n    return this._diffuse\n  }\n\n  /** Cube mipmap texture used for the specular component. */\n  get specular() {\n    return this._specular\n  }\n\n  /** BRDF integration map lookup texture. */\n  lookupBrdf?: Texture\n\n  /**\n   * Creates a new image-based lighting object.\n   * @param diffuse Cubemap used for the diffuse component.\n   * @param specular Cubemap used for the specular component.\n   */\n  constructor(diffuse: Cubemap, specular: Cubemap) {\n    this._diffuse = diffuse\n    this._specular = specular\n  }\n\n  /**\n   * Value indicating if this object is valid to be used for rendering.\n   */\n  get valid() {\n    return this._diffuse.valid &&\n      this._specular.valid && (!this.lookupBrdf || this.lookupBrdf.valid)\n  }\n}","var img = \"data:image/png;base64,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\";\n  export default img;","import { Renderer, Shader } from \"@pixi/core\"\nimport { DEG_TO_RAD } from \"@pixi/math\"\nimport { LightType } from \"../../lighting/light-type\"\nimport { StandardMaterialFeatureSet } from \"./standard-material-feature-set\"\nimport { StandardShader } from \"./standard-shader\"\nimport { Material } from \"../material\"\nimport { Camera } from \"../../camera/camera\"\nimport { LightingEnvironment } from \"../../lighting/lighting-environment\"\nimport { Mesh3D } from \"../../mesh/mesh\"\nimport { StandardMaterialAlphaMode } from \"./standard-material-alpha-mode\"\nimport { StandardMaterialDebugMode } from \"./standard-material-debug-mode\"\nimport { ShadowCastingLight } from \"../../shadow/shadow-casting-light\"\nimport { StandardMaterialSkinUniforms } from \"./standard-material-skin-uniforms\"\nimport { Color } from \"../../color\"\nimport { InstancedStandardMaterial } from \"./instanced-standard-material\"\nimport { StandardMaterialOcclusionTexture } from \"./standard-material-occlusion-texture\"\nimport { StandardMaterialNormalTexture } from \"./standard-material-normal-texture\"\nimport { StandardMaterialTexture } from \"./standard-material-texture\"\nimport { StandardMaterialFactory } from \"./standard-material-factory\"\nimport { ImageBasedLighting } from \"../../lighting/image-based-lighting\"\nimport { TextureTransform } from \"../../texture/texture-transform\"\n\nconst shaders: { [features: string]: StandardShader } = {}\n\nconst getLightingEnvironmentConfigId = (env?: LightingEnvironment) => {\n  return env ? (env.lights.length + (env.imageBasedLighting ? 0.5 : 0)) : 0\n}\n\n/**\n * The standard material is using Physically-Based Rendering (PBR) which makes \n * it suitable to represent a wide range of different surfaces. It's the default \n * material when loading models from file.\n */\nexport class StandardMaterial extends Material {\n  private _lightingEnvironment?: LightingEnvironment\n  private _lightingEnvironmentConfigId = 0\n  private _unlit = false\n  private _alphaMode = StandardMaterialAlphaMode.blend\n  private _debugMode?: StandardMaterialDebugMode\n  private _baseColorTexture?: StandardMaterialTexture\n  private _baseColorFactor = new Float32Array(4)\n  private _normalTexture?: StandardMaterialNormalTexture\n  private _occlusionTexture?: StandardMaterialOcclusionTexture\n  private _emissiveTexture?: StandardMaterialTexture\n  private _metallicRoughnessTexture?: StandardMaterialTexture\n  private _shadowCastingLight?: ShadowCastingLight\n  private _instancingEnabled = false\n\n  private _skinUniforms = new StandardMaterialSkinUniforms()\n\n  /** The roughness of the material. */\n  roughness = 1\n\n  /** The metalness of the material. */\n  metallic = 1\n\n  /** The base color of the material. */\n  baseColor = new Color(1, 1, 1, 1)\n\n  /** The cutoff threshold when alpha mode is set to \"mask\". */\n  alphaCutoff = 0.5\n\n  /** The emissive color of the material. */\n  emissive = new Color(0, 0, 0)\n\n  /** The exposure (brightness) of the material. */\n  exposure = 1\n\n  /** The base color texture. */\n  get baseColorTexture() {\n    return this._baseColorTexture\n  }\n\n  set baseColorTexture(value: StandardMaterialTexture | undefined) {\n    if (value !== this._baseColorTexture) {\n      this.invalidateShader()\n      if (!value?.transform && value?.frame && !value?.noFrame) {\n        value.transform = TextureTransform.fromTexture(value)\n      }\n      this._baseColorTexture = value\n    }\n  }\n\n  /** The metallic-roughness texture. */\n  get metallicRoughnessTexture() {\n    return this._metallicRoughnessTexture\n  }\n\n  set metallicRoughnessTexture(value: StandardMaterialTexture | undefined) {\n    if (value !== this._metallicRoughnessTexture) {\n      this.invalidateShader()\n      if (!value?.transform && value?.frame && !value?.noFrame) {\n        value.transform = TextureTransform.fromTexture(value)\n      }\n      this._metallicRoughnessTexture = value\n    }\n  }\n\n  /** The normal map texture. */\n  get normalTexture() {\n    return this._normalTexture\n  }\n\n  set normalTexture(value: StandardMaterialNormalTexture | undefined) {\n    if (value !== this._normalTexture) {\n      this.invalidateShader()\n      if (!value?.transform && value?.frame && !value?.noFrame) {\n        value.transform = TextureTransform.fromTexture(value)\n      }\n      this._normalTexture = value\n    }\n  }\n\n  /** The occlusion map texture. */\n  get occlusionTexture() {\n    return this._occlusionTexture\n  }\n\n  set occlusionTexture(value: StandardMaterialOcclusionTexture | undefined) {\n    if (value !== this._occlusionTexture) {\n      this.invalidateShader()\n      if (!value?.transform && value?.frame && !value?.noFrame) {\n        value.transform = TextureTransform.fromTexture(value)\n      }\n      this._occlusionTexture = value\n    }\n  }\n\n  /** The emissive map texture. */\n  get emissiveTexture() {\n    return this._emissiveTexture\n  }\n\n  set emissiveTexture(value: StandardMaterialTexture | undefined) {\n    if (value !== this._emissiveTexture) {\n      this.invalidateShader()\n      if (!value?.transform && value?.frame && !value?.noFrame) {\n        value.transform = TextureTransform.fromTexture(value)\n      }\n      this._emissiveTexture = value\n    }\n  }\n\n  /** The alpha rendering mode of the material. */\n  get alphaMode() {\n    return this._alphaMode\n  }\n\n  set alphaMode(value: StandardMaterialAlphaMode) {\n    if (this._alphaMode !== value) {\n      this._alphaMode = value\n      this.invalidateShader()\n    }\n  }\n\n  /** The shadow casting light of the material. */\n  get shadowCastingLight() {\n    return this._shadowCastingLight\n  }\n\n  set shadowCastingLight(value: ShadowCastingLight | undefined) {\n    if (value !== this._shadowCastingLight) {\n      this.invalidateShader()\n      this._shadowCastingLight = value\n    }\n  }\n\n  /** The debug rendering mode of the material. */\n  get debugMode() {\n    return this._debugMode\n  }\n\n  set debugMode(value: StandardMaterialDebugMode | undefined) {\n    if (this._debugMode !== value) {\n      this.invalidateShader()\n      this._debugMode = value\n    }\n  }\n\n  /**\n   * The camera used when rendering a mesh. If this value is not set, the main \n   * camera will be used by default.\n   */\n  camera?: Camera\n\n  /**\n   * Lighting environment used when rendering a mesh. If this value is not set, \n   * the main lighting environment will be used by default.\n   */\n  get lightingEnvironment() {\n    return this._lightingEnvironment\n  }\n\n  set lightingEnvironment(value: LightingEnvironment | undefined) {\n    if (value !== this._lightingEnvironment) {\n      this.invalidateShader()\n      this._lightingEnvironmentConfigId = getLightingEnvironmentConfigId(value)\n      this._lightingEnvironment = value\n    }\n  }\n\n  /**\n   * Value indicating if the material is unlit. If this value if set to true, \n   * all lighting is disabled and only the base color will be used.\n   */\n  get unlit() {\n    return this._unlit\n  }\n\n  set unlit(value: boolean) {\n    if (this._unlit !== value) {\n      this._unlit = value\n      this.invalidateShader()\n    }\n  }\n\n  destroy() {\n    this._baseColorTexture?.destroy()\n    this._normalTexture?.destroy()\n    this._emissiveTexture?.destroy()\n    this._occlusionTexture?.destroy()\n    this._metallicRoughnessTexture?.destroy()\n    this._skinUniforms.destroy()\n  }\n\n  /**\n   * Invalidates the shader so it can be rebuilt with the current features.\n   */\n  invalidateShader() {\n    this._shader = undefined\n  }\n\n  /**\n   * Creates a new standard material from the specified source.\n   * @param source Source from which the material is created.\n   */\n  static create(source: unknown) {\n    return new StandardMaterialFactory().create(source)\n  }\n\n  render(mesh: Mesh3D, renderer: Renderer) {\n    if (!this._instancingEnabled && mesh.instances.length > 0) {\n      // Invalidate shader when instancing was enabled.\n      this.invalidateShader()\n      this._instancingEnabled = true\n    }\n    if (this._instancingEnabled && mesh.instances.length === 0) {\n      // Invalidate shader when instancing was disabled.\n      this.invalidateShader()\n      this._instancingEnabled = false\n    }\n    let lighting = this.lightingEnvironment || LightingEnvironment.main\n    let configId = getLightingEnvironmentConfigId(lighting)\n    if (configId !== this._lightingEnvironmentConfigId) {\n      // Invalidate shader when the lighting config has changed.\n      this.invalidateShader()\n      this._lightingEnvironmentConfigId = configId\n    }\n    super.render(mesh, renderer)\n  }\n\n  get isInstancingSupported() {\n    return true\n  }\n\n  createInstance() {\n    return new InstancedStandardMaterial(this)\n  }\n\n  createShader(mesh: Mesh3D, renderer: Renderer) {\n    if (renderer.context.webGLVersion === 1) {\n      let extensions = [\"EXT_shader_texture_lod\", \"OES_standard_derivatives\"]\n      for (let ext of extensions) {\n        if (!renderer.gl.getExtension(ext)) {\n          // Log warning?\n        }\n      }\n    }\n    let lightingEnvironment = this.lightingEnvironment || LightingEnvironment.main\n    let features = StandardMaterialFeatureSet.build(renderer, mesh, mesh.geometry, this, lightingEnvironment)\n    if (!features) {\n      // The shader features couldn't be built, some resources may still be \n      // loading. Don't worry, we will retry creating shader at next render.\n      return undefined\n    }\n    if (mesh.skin && StandardMaterialFeatureSet.hasSkinningTextureFeature(features)) {\n      this._skinUniforms.enableJointMatrixTextures(mesh.skin.joints.length)\n    }\n    let checksum = features.join(\",\")\n    if (!shaders[checksum]) {\n      shaders[checksum] = StandardShader.build(renderer, features)\n    }\n    return shaders[checksum]\n  }\n\n  updateUniforms(mesh: Mesh3D, shader: Shader) {\n    for (let i = 0; i < 3; i++) {\n      this._baseColorFactor[i] = this.baseColor.rgba[i]\n    }\n    this._baseColorFactor[3] = this.baseColor.a * mesh.worldAlpha\n    let camera = this.camera || Camera.main\n    if (mesh.skin) {\n      this._skinUniforms.update(mesh, shader)\n    }\n    shader.uniforms.u_Camera = camera.worldTransform.position\n    shader.uniforms.u_ViewProjectionMatrix = camera.viewProjection\n    shader.uniforms.u_Exposure = this.exposure\n    shader.uniforms.u_MetallicFactor = this.metallic\n    shader.uniforms.u_RoughnessFactor = this.roughness\n    shader.uniforms.u_BaseColorFactor = this._baseColorFactor\n    shader.uniforms.u_ModelMatrix = mesh.worldTransform.array\n    shader.uniforms.u_NormalMatrix = mesh.transform.normalTransform.array\n    if (this._alphaMode === StandardMaterialAlphaMode.mask) {\n      shader.uniforms.u_AlphaCutoff = this.alphaCutoff\n    }\n    if (mesh.targetWeights) {\n      shader.uniforms.u_morphWeights = mesh.targetWeights\n    }\n    if (this.baseColorTexture?.valid) {\n      shader.uniforms.u_BaseColorSampler = this.baseColorTexture\n      shader.uniforms.u_BaseColorUVSet = this.baseColorTexture.uvSet || 0\n      if (this.baseColorTexture.transform) {\n        shader.uniforms.u_BaseColorUVTransform = this.baseColorTexture.transform.array\n      }\n    }\n    let lightingEnvironment = this.lightingEnvironment || LightingEnvironment.main\n    for (let i = 0; i < lightingEnvironment.lights.length; i++) {\n      let light = lightingEnvironment.lights[i]\n      let type = 0\n      switch (light.type) {\n        case LightType.point: type = 1; break\n        case LightType.directional: type = 0; break\n        case LightType.spot: type = 2; break\n      }\n      shader.uniforms[`u_Lights[${i}].type`] = type\n      shader.uniforms[`u_Lights[${i}].position`] = light.worldTransform.position\n      shader.uniforms[`u_Lights[${i}].direction`] = light.worldTransform.forward\n      shader.uniforms[`u_Lights[${i}].range`] = light.range\n      shader.uniforms[`u_Lights[${i}].color`] = light.color.rgb\n      shader.uniforms[`u_Lights[${i}].intensity`] = light.intensity\n      shader.uniforms[`u_Lights[${i}].innerConeCos`] = Math.cos(light.innerConeAngle * DEG_TO_RAD)\n      shader.uniforms[`u_Lights[${i}].outerConeCos`] = Math.cos(light.outerConeAngle * DEG_TO_RAD)\n    }\n    if (this._shadowCastingLight) {\n      shader.uniforms.u_ShadowSampler = this._shadowCastingLight.shadowTexture\n      shader.uniforms.u_LightViewProjectionMatrix = this._shadowCastingLight.lightViewProjection\n      shader.uniforms.u_ShadowLightIndex = lightingEnvironment.lights.indexOf(this._shadowCastingLight.light)\n    }\n    let imageBasedLighting = lightingEnvironment.imageBasedLighting\n    if (imageBasedLighting?.valid) {\n      shader.uniforms.u_DiffuseEnvSampler = imageBasedLighting.diffuse\n      shader.uniforms.u_SpecularEnvSampler = imageBasedLighting.specular\n      shader.uniforms.u_brdfLUT = imageBasedLighting.lookupBrdf || ImageBasedLighting.defaultLookupBrdf\n      shader.uniforms.u_MipCount = imageBasedLighting.specular.levels - 1\n    }\n    if (this.emissiveTexture?.valid) {\n      shader.uniforms.u_EmissiveSampler = this.emissiveTexture\n      shader.uniforms.u_EmissiveUVSet = this.emissiveTexture.uvSet || 0\n      shader.uniforms.u_EmissiveFactor = this.emissive.rgb\n      if (this.emissiveTexture.transform) {\n        shader.uniforms.u_EmissiveUVTransform = this.emissiveTexture.transform.array\n      }\n    }\n    if (this.normalTexture?.valid) {\n      shader.uniforms.u_NormalSampler = this.normalTexture\n      shader.uniforms.u_NormalScale = this.normalTexture.scale || 1\n      shader.uniforms.u_NormalUVSet = this.normalTexture.uvSet || 0\n      if (this.normalTexture.transform) {\n        shader.uniforms.u_NormalUVTransform = this.normalTexture.transform.array\n      }\n    }\n    if (this.metallicRoughnessTexture?.valid) {\n      shader.uniforms.u_MetallicRoughnessSampler = this.metallicRoughnessTexture\n      shader.uniforms.u_MetallicRoughnessUVSet = this.metallicRoughnessTexture.uvSet || 0\n      if (this.metallicRoughnessTexture.transform) {\n        shader.uniforms.u_MetallicRoughnessUVTransform = this.metallicRoughnessTexture.transform.array\n      }\n    }\n    if (this.occlusionTexture?.valid) {\n      shader.uniforms.u_OcclusionSampler = this.occlusionTexture\n      shader.uniforms.u_OcclusionStrength = this.occlusionTexture.strength || 1\n      shader.uniforms.u_OcclusionUVSet = this.occlusionTexture.uvSet || 0\n      if (this.occlusionTexture.transform) {\n        shader.uniforms.u_OcclusionUVTransform = this.occlusionTexture.transform.array\n      }\n    }\n  }\n}","import { ObservablePoint3D } from \"../transform/observable-point\"\n\n/**\n * Axis-aligned bounding box.\n */\nexport class AABB {\n  private _onChanged = () => {\n    this._center.set(\n      (this._min.x + this._max.x) / 2,\n      (this._min.y + this._max.y) / 2,\n      (this._min.z + this._max.z) / 2\n    )\n    this._extents.set(\n      Math.abs(this._max.x - this._center.x),\n      Math.abs(this._max.y - this._center.y),\n      Math.abs(this._max.z - this._center.z),\n    )\n    this._size.set(\n      this._extents.x * 2,\n      this._extents.y * 2,\n      this._extents.z * 2,\n    )\n  }\n\n  private _min = new ObservablePoint3D(this._onChanged, this)\n  private _max = new ObservablePoint3D(this._onChanged, this)\n  private _center = new ObservablePoint3D(() => { }, this)\n  private _size = new ObservablePoint3D(() => { }, this)\n  private _extents = new ObservablePoint3D(() => { }, this)\n\n  /** The minimal point of the bounding box. */\n  get min() {\n    return this._min\n  }\n\n  set min(value: ObservablePoint3D) {\n    this._min.copyFrom(value)\n  }\n\n  /** The maximal point of the bounding box. */\n  get max() {\n    return this._max\n  }\n\n  set max(value: ObservablePoint3D) {\n    this._max.copyFrom(value)\n  }\n\n  /** The center of the bounding box. */\n  get center() {\n    return this._center\n  }\n\n  /** The size of the bounding box. */\n  get size() {\n    return this._size\n  }\n\n  /** The extents of the bounding box. */\n  get extents() {\n    return this._extents\n  }\n\n  /**\n   * Creates a new bounding box from the specified source.\n   * @param source The source to create the bounding box from.\n   */\n  static from(source: { min: Float32Array, max: Float32Array }) {\n    let aabb = new AABB()\n    aabb.min.setFrom(source.min)\n    aabb.max.setFrom(source.max)\n    return aabb\n  }\n\n  /**\n   * Grows the bounding box to include the point.\n   * @param point The point to include.\n   */\n  encapsulate(point: { x: number, y: number, z: number }) {\n    this._min.x = Math.min(this._min.x, point.x)\n    this._min.y = Math.min(this._min.y, point.y)\n    this._min.z = Math.min(this._min.z, point.z)\n    this._max.x = Math.max(this._max.x, point.x)\n    this._max.y = Math.max(this._max.y, point.y)\n    this._max.z = Math.max(this._max.z, point.z)\n  }\n}","import { Renderer, ObjectRenderer } from \"@pixi/core\"\nimport { PlaneGeometry } from \"./geometry/plane-geometry\"\nimport { CubeGeometry } from \"./geometry/cube-geometry\"\nimport { MeshGeometry3D } from \"./geometry/mesh-geometry\"\nimport { Container3D } from \"../container\"\nimport { QuadGeometry } from \"./geometry/quad-geometry\"\nimport { Skin } from \"../skinning/skin\"\nimport { InstancedMesh3D } from \"./instanced-mesh\"\nimport { Material } from \"../material/material\"\nimport { StandardMaterial } from \"../material/standard/standard-material\"\nimport { MeshDestroyOptions } from \"./mesh-destroy-options\"\nimport { Vec3 } from \"../math/vec3\"\nimport { AABB } from \"../math/aabb\"\nimport { SphereGeometry, SphereGeometryOptions } from \"./geometry/sphere-geometry\"\n\n/**\n * Represents a mesh which contains geometry and has a material.\n */\nexport class Mesh3D extends Container3D {\n\n  /** The name of the plugin used for rendering the mesh. */\n  pluginName = \"pipeline\"\n\n  /** Array of weights used for morphing between geometry targets. */\n  targetWeights?: number[]\n\n  /** The skin used for vertex skinning. */\n  skin?: Skin\n\n  /** The enabled render passes for this mesh. */\n  enabledRenderPasses: { [name: string]: unknown } = { \"material\": {} }\n\n  /** Used for sorting the mesh before render. */\n  renderSortOrder = 0\n\n  /**\n   * Creates a new mesh with the specified geometry and material.\n   * @param geometry The geometry for the mesh.\n   * @param material The material for the mesh. If the material is empty the mesh won't be rendered.\n   */\n  constructor(public geometry: MeshGeometry3D, public material?: Material) {\n    super()\n    if (!geometry) {\n      throw new Error(\"PIXI3D: Geometry is required when creating a mesh.\")\n    }\n  }\n\n  private _instances: InstancedMesh3D[] = []\n\n  /** An array of instances created from this mesh. */\n  get instances() {\n    return this._instances\n  }\n\n  /**\n   * Creates a new instance of this mesh.\n   */\n  createInstance() {\n    if (this.material && !this.material.isInstancingSupported) {\n      throw new Error(\"PIXI3D: Can't create instance of mesh, material does not support instancing.\")\n    }\n    return this._instances[\n      this._instances.push(new InstancedMesh3D(this, this.material?.createInstance())) - 1\n    ]\n  }\n\n  /**\n   * Removes an instance from this mesh.\n   * @param instance The instance to remove.\n   */\n  removeInstance(instance: InstancedMesh3D) {\n    const index = this._instances.indexOf(instance)\n    if (index >= 0) {\n      this._instances.splice(index, 1)\n    }\n  }\n\n  /**\n   * Enables the render pass with the specified name.\n   * @param name The name of the render pass to enable.\n   */\n  enableRenderPass(name: string, options?: unknown) {\n    if (!this.enabledRenderPasses[name]) {\n      this.enabledRenderPasses[name] = options || {}\n    }\n  }\n\n  /**\n   * Disables the render pass with the specified name.\n   * @param name The name of the render pass to disable.\n   * @param options The options for the render pass.\n   */\n  disableRenderPass(name: string) {\n    if (this.enabledRenderPasses[name]) {\n      delete this.enabledRenderPasses[name]\n    }\n  }\n\n  /**\n   * Returns a value indicating if the specified render pass is enabled.\n   * @param name The name of the render pass to check.\n   */\n  isRenderPassEnabled(name: string) {\n    return !!this.enabledRenderPasses[name]\n  }\n\n  /**\n   * Destroys the mesh and it's used resources.\n   */\n  destroy(options?: boolean | MeshDestroyOptions) {\n    if (options === true || (options && options.geometry)) {\n      this.geometry.destroy()\n    }\n    if (options === true || (options && options.material)) {\n      if (this.material) {\n        this.material.destroy()\n      }\n    }\n    super.destroy(options)\n  }\n\n  _render(renderer: Renderer) {\n    renderer.batch.setObjectRenderer(\n      <ObjectRenderer>(<any>renderer.plugins)[this.pluginName]\n    );\n    if (this.skin) {\n      this.skin.calculateJointMatrices()\n    }\n    <ObjectRenderer>(<any>renderer.plugins)[this.pluginName].render(this)\n  }\n\n  /**\n   * Calculates and returns a axis-aligned bounding box of the mesh in world space.\n   */\n  getBoundingBox() {\n    if (!this.geometry.positions?.min) {\n      return undefined\n    }\n    if (!this.geometry.positions?.max) {\n      return undefined\n    }\n    let min = Vec3.transformMat4(\n      <any>this.geometry.positions.min, this.worldTransform.array)\n    let max = Vec3.transformMat4(\n      <any>this.geometry.positions.max, this.worldTransform.array)\n    for (let i = 0; i < 3; i++) {\n      let temp = min[i]\n      min[i] = Math.min(min[i], max[i])\n      max[i] = Math.max(temp, max[i])\n    }\n    return AABB.from({ min, max })\n  }\n\n  /**\n   * Creates a new quad (flat square) mesh with the specified material.\n   * @param material The material to use.\n   */\n  static createQuad(material: Material = new StandardMaterial()) {\n    return new Mesh3D(QuadGeometry.create(), material)\n  }\n\n  /**\n   * Creates a new cube (six faces) mesh with the specified material.\n   * @param material The material to use.\n   */\n  static createCube(material: Material = new StandardMaterial()) {\n    return new Mesh3D(CubeGeometry.create(), material)\n  }\n\n  /**\n   * Creates a new plane (flat square) mesh with the specified material.\n   * @param material The material to use.\n   */\n  static createPlane(material: Material = new StandardMaterial()) {\n    return new Mesh3D(PlaneGeometry.create(), material)\n  }\n\n  /**\n   * Creates a new uv sphere mesh with the specified material.\n   * @param material The material to use.\n   * @param options The options used when creating the geometry.\n   */\n  static createSphere(material: Material = new StandardMaterial(), options?: SphereGeometryOptions) {\n    return new Mesh3D(SphereGeometry.create(options), material)\n  }\n}","import { Ticker } from '@pixi/ticker';\nimport { EventEmitter } from '@pixi/utils';\n\n/**\n * Represents an animation.\n */\nexport abstract class Animation extends EventEmitter {\n  private _ticker?: Ticker\n  private _update?: (...params: any[]) => void\n\n  /** The duration (in seconds) of this animation. */\n  abstract readonly duration: number\n\n  /** The current position (in seconds) of this animation. */\n  abstract position: number\n\n  /** The speed that the animation will play at. */\n  speed = 1\n\n  /** A value indicating if the animation is looping. */\n  loop = false\n\n  /**\n   * Creates a new animation with the specified name.\n   * @param name Name for the animation.\n   */\n  constructor(public name?: string) {\n    super()\n  }\n\n  /**\n   * Starts playing the animation using the specified ticker.\n   * @param ticker The ticker to use for updating the animation. If a ticker \n   * is not given, the shared ticker will be used.\n   */\n  play(ticker = Ticker.shared) {\n    this.position = 0\n    if (!this._ticker) {\n      this._update = () => {\n        this.update(ticker.deltaMS / 1000 * this.speed)\n      }\n      this._ticker = ticker.add(this._update)\n    }\n  }\n\n  /**\n   * Stops playing the animation.\n   */\n  stop() {\n    if (this._ticker && this._update) {\n      this._ticker.remove(this._update)\n      this._ticker = this._update = undefined\n    }\n  }\n\n  /**\n   * Updates the animation by the specified delta time.\n   * @param delta The time in seconds since last frame.\n   */\n  update(delta: number) {\n    this.position += delta\n    if (this.position < this.duration) {\n      return\n    }\n    if (this.loop) {\n      if (this.position > this.duration) {\n        this.position = this.position % this.duration\n      }\n    }\n    else {\n      this.position = this.duration\n      this.stop()\n    }\n    this.emit(\"complete\")\n  }\n}","import { Animation } from \"../../animation\"\nimport { glTFChannel } from \"./gltf-channel\"\n\n/**\n * Represents an animation loaded from a glTF model.\n */\nexport class glTFAnimation extends Animation {\n  private _duration = 0\n  private _position = 0\n  private _channels: glTFChannel[] = []\n\n  /**\n   * Creates a new glTF animation.\n   * @param channels The channels used by this animation.\n   * @param name The name for the animation.\n   */\n  constructor(channels: glTFChannel[], name?: string) {\n    super(name)\n    for (let channel of channels) {\n      this._duration = Math.max(this._duration, channel.duration)\n    }\n    this._channels = channels\n  }\n\n  /** The duration (in seconds) of this animation. */\n  get duration() {\n    return this._duration\n  }\n\n  /** The current position (in seconds) of this animation. */\n  get position() {\n    return this._position\n  }\n\n  set position(value: number) {\n    this._position = value\n    for (let channel of this._channels) {\n      channel.position = this._position\n    }\n  }\n}\n\n","/**\n * Represents data for a specific geometry attribute.\n */\nexport class glTFAttribute {\n  constructor(public buffer: Uint32Array | Float32Array | Int8Array | Uint8Array | Int16Array | Uint16Array, public componentType: number, public stride = 0, public min?: number[], public max?: number[]) {\n  }\n\n  static from(componentType: number, buffer: ArrayBuffer, offset: number, size: number, stride?: number, min?: number[], max?: number[]) {\n    switch (componentType) {\n      case 5125: return new glTFAttribute(\n        new Uint32Array(buffer, offset, size), componentType, stride, min, max)\n      case 5126: return new glTFAttribute(\n        new Float32Array(buffer, offset, size), componentType, stride, min, max)\n      case 5120: return new glTFAttribute(\n        new Int8Array(buffer, offset, size), componentType, stride, min, max)\n      case 5121: return new glTFAttribute(\n        new Uint8Array(buffer, offset, size), componentType, stride, min, max)\n      case 5122: return new glTFAttribute(\n        new Int16Array(buffer, offset, size), componentType, stride, min, max)\n      case 5123: return new glTFAttribute(\n        new Uint16Array(buffer, offset, size), componentType, stride, min, max)\n      default: {\n        throw new Error(`PIXI3D: Unknown component type \"${componentType}\".`)\n      }\n    }\n  }\n}","import { Joint } from \"./joint\"\nimport { Container3D } from \"../container\"\nimport { Mat4 } from \"../math/mat4\"\n\n/**\n * Represents a skin used for vertex skinning.\n */\nexport class Skin {\n  private _jointMatrices: Float32Array[] = []\n  private _jointNormalMatrices: Float32Array[] = []\n  private _transformIds: number[] = []\n\n  /** The joint normal matrices which has been calculated. */\n  jointNormalMatrices = new Float32Array(this.joints.length * 16)\n\n  /** The joint matrices which has been calculated. */\n  jointMatrices = new Float32Array(this.joints.length * 16)\n\n  /**\n   * Creates a new skin.\n   * @param parent The parent container node for the skin.\n   * @param joints The array of joints included in the skin.\n   */\n  constructor(readonly parent: Container3D, readonly joints: Joint[]) {\n    for (let i = 0; i < joints.length; i++) {\n      this._transformIds.push(-1)\n      this._jointMatrices.push(\n        new Float32Array(this.jointMatrices.buffer, 16 * 4 * i, 16))\n      this._jointNormalMatrices.push(\n        new Float32Array(this.jointNormalMatrices.buffer, 16 * 4 * i, 16))\n    }\n  }\n\n  /**\n   * Calculates the joint matrices.\n   */\n  calculateJointMatrices() {\n    for (let i = 0; i < this.joints.length; i++) {\n      if (this.joints[i].transform._worldID === this._transformIds[i]) {\n        // The joint transform hasn't changed, no need to calculate.\n        continue\n      }\n      this._transformIds[i] = this.joints[i].transform._worldID\n      Mat4.multiply(this.joints[i].worldTransform.array,\n        this.joints[i].inverseBindMatrix, this._jointMatrices[i])\n      Mat4.multiply(this.parent.transform.inverseWorldTransform.array,\n        this._jointMatrices[i], this._jointMatrices[i])\n      Mat4.invert(this._jointMatrices[i], this._jointNormalMatrices[i])\n      Mat4.transpose(\n        this._jointNormalMatrices[i], this._jointNormalMatrices[i])\n    }\n  }\n}\n","import { Container3D } from \"../container\"\n\n/**\n * Represents a joint used for vertex skinning.\n */\nexport class Joint extends Container3D {\n  /**\n   * Creates a new joint.\n   * @param inverseBindMatrix The inverse of the global transform matrix.\n   */\n  constructor(readonly inverseBindMatrix: Float32Array) {\n    super()\n  }\n}\n","import { glTFInterpolation } from \"./gltf-interpolation\"\n\nexport class glTFLinear implements glTFInterpolation {\n  private _data: Float32Array\n\n  constructor(private _output: ArrayLike<number>, private _stride: number) {\n    this._data = new Float32Array(_stride)\n  }\n\n  interpolate(frame: number, position: number) {\n    let pos1 = (frame + 0) * this._stride\n    let pos2 = (frame + 1) * this._stride\n    for (let i = 0; i < this._stride; i++) {\n      if (this._output.length > pos2) {\n        this._data[i] = (1 - position) * this._output[pos1 + i] + position * this._output[pos2 + i]\n      } else {\n        this._data[i] = this._output[pos1 + i]\n      }\n    }\n    return this._data\n  }\n}","import { glTFInterpolation } from \"./gltf-interpolation\"\n\nexport class glTFCubicSpline implements glTFInterpolation {\n  private _data: Float32Array\n\n  constructor(private _input: ArrayLike<number>, private _output: ArrayLike<number>, private _stride: number) {\n    this._data = new Float32Array(_stride)\n  }\n\n  interpolate(frame: number, position: number) {\n    const diff = this._input[frame + 1] - this._input[frame]\n    const pos1 = (frame + 0) * this._stride * 3\n    const pos2 = (frame + 1) * this._stride * 3\n    for (let i = 0; i < this._stride; i++) {\n      this._data[i] = glTFCubicSpline.calculate(\n        position, this._output[pos1 + i + 1 * this._stride], this._output[pos2 + i + 1 * this._stride], diff * this._output[pos2 + i], diff * this._output[pos1 + i + 2 * this._stride])\n    }\n    return this._data\n  }\n\n  static calculate(t: number, p0: number, p1: number, m0: number, m1: number) {\n    return ((2 * (t ** 3) - 3 * (t ** 2) + 1) * p0) + (((t ** 3) - 2 * (t ** 2) + t) * m0) + ((-2 * (t ** 3) + 3 * (t ** 2)) * p1) + (((t ** 3) - (t ** 2)) * m1)\n  }\n}\n\n","import { glTFInterpolation } from \"./gltf-interpolation\"\n\nexport class glTFStep implements glTFInterpolation {\n  private _data: Float32Array\n\n  constructor(private _output: ArrayLike<number>, private _stride: number) {\n    this._data = new Float32Array(_stride)\n  }\n\n  interpolate(frame: number) {\n    for (let i = 0; i < this._stride; i++) {\n      this._data[i] = this._output[frame * this._stride + i]\n    }\n    return this._data\n  }\n}","import { glTFLinear } from \"./gltf-linear\"\nimport { glTFCubicSpline } from \"./gltf-cubic-spline\"\nimport { glTFStep } from \"./gltf-step\"\n\nexport abstract class glTFInterpolationFactory {\n  static create(type: string, input: ArrayLike<number>, output: ArrayLike<number>, stride: number) {\n    switch (type) {\n      case \"LINEAR\": {\n        return new glTFLinear(output, stride)\n      }\n      case \"CUBICSPLINE\": {\n        return new glTFCubicSpline(input, output, stride)\n      }\n      case \"STEP\": {\n        return new glTFStep(output, stride)\n      }\n    }\n    throw new Error(`PIXI3D: Unknown interpolation type \"${type}\"`)\n  }\n}","import { glTFInterpolation } from \"./gltf-interpolation\"\n\n/**\n * Represents an glTF animation channel which targets a specific node.\n */\nexport abstract class glTFChannel {\n  private _position = 0\n  private _frame = 0\n  private _interpolation: glTFInterpolation\n  private _input: ArrayLike<number>\n\n  /**\n   * Creates a new channel with the specified input and interpolation.\n   * @param input An array of inputs representing linear time in seconds.\n   * @param interpolation The interpolation method to use.\n   */\n  constructor(input: ArrayLike<number>, interpolation: glTFInterpolation) {\n    this._input = input\n    this._interpolation = interpolation\n  }\n\n  /** The position (in seconds) for this channel. */\n  get position() {\n    return this._position\n  }\n\n  set position(value: number) {\n    this.setPosition(value)\n  }\n\n  /** The duration (in seconds) for this channel. */\n  get duration() {\n    return this._input[this._input.length - 1]\n  }\n\n  /** The current frame for this channel. */\n  get frame() {\n    return this._frame\n  }\n\n  /** The number of frames for this channel. */\n  get length() {\n    return this._input.length\n  }\n\n  /**\n   * Sets the position and updates the current frame and animation.\n   * @param position The position to set for this channel.\n   */\n  setPosition(position: number) {\n    this._position = position\n    this._frame = this.calculateFrame(this._position)\n    this.updateTarget(\n      this._interpolation.interpolate(\n        this._frame, this.calculateFramePosition(this._frame, this._position)))\n  }\n\n  abstract updateTarget(data: ArrayLike<number>): void\n\n  /**\n   * Updates the channel with the specified delta time in seconds.\n   * @param delta The time (in seconds) since last frame.\n   */\n  update(delta: number) {\n    this.position += delta\n  }\n\n  /**\n   * Calculates the position within the specified frame.\n   * @param frame The frame to calculate the position in.\n   * @param position The position of this channel.\n   */\n  calculateFramePosition(frame: number, position: number) {\n    if (frame === this._input.length - 1) {\n      return 1\n    }\n    return (position - this._input[frame]) / (this._input[frame + 1] - this._input[frame])\n  }\n\n  /**\n   * Calculates the current frame for the specified position.\n   * @param position The position of this channel.\n   */\n  calculateFrame(position: number) {\n    if (position < this._input[0]) {\n      return 0\n    }\n    for (let i = 0; i < this._input.length - 1; i++) {\n      if (position >= this._input[i] && position < this._input[i + 1]) {\n        return i\n      }\n    }\n    return this._input.length - 1\n  }\n}","import { glTFChannel } from \"./gltf-channel\"\nimport { glTFInterpolation } from \"./gltf-interpolation\"\nimport { Transform3D } from \"../../transform/transform\"\n\nexport class glTFRotation extends glTFChannel {\n  private _transform: Transform3D\n\n  constructor(transform: Transform3D, input: ArrayLike<number>, interpolation: glTFInterpolation) {\n    super(input, interpolation)\n    this._transform = transform\n  }\n\n  updateTarget(data: ArrayLike<number>) {\n    this._transform.rotationQuaternion.set(data[0], data[1], data[2], data[3])\n  }\n}","import { glTFChannel } from \"./gltf-channel\"\nimport { glTFInterpolation } from \"./gltf-interpolation\"\nimport { Transform3D } from \"../../transform/transform\"\n\nexport class glTFScale extends glTFChannel {\n  private _transform: Transform3D\n\n  constructor(transform: Transform3D, input: ArrayLike<number>, interpolation: glTFInterpolation) {\n    super(input, interpolation)\n    this._transform = transform\n  }\n\n  updateTarget(data: ArrayLike<number>) {\n    this._transform.scale.set(data[0], data[1], data[2])\n  }\n}","import { Quat } from \"../../math/quat\"\nimport { glTFInterpolation } from \"./gltf-interpolation\"\n\nexport class glTFSphericalLinear implements glTFInterpolation {\n  private _data: Float32Array\n\n  constructor(private _output: ArrayLike<number>) {\n    this._data = new Float32Array(4)\n  }\n\n  interpolate(frame: number, position: number) {\n    let pos1 = (frame + 0) * 4\n    let pos2 = (frame + 1) * 4\n    let a = Quat.set(\n      this._output[pos1], this._output[pos1 + 1], this._output[pos1 + 2], this._output[pos1 + 3], new Float32Array(4)\n    )\n    if (this._output.length <= pos2) {\n      return Quat.normalize(a, this._data)\n    }\n    let b = Quat.set(\n      this._output[pos2], this._output[pos2 + 1], this._output[pos2 + 2], this._output[pos2 + 3], new Float32Array(4)\n    )\n    return <Float32Array>Quat.normalize(\n      Quat.slerp(a, b, position, this._data), this._data)\n  }\n}","import { glTFChannel } from \"./gltf-channel\"\nimport { glTFInterpolation } from \"./gltf-interpolation\"\nimport { Transform3D } from \"../../transform/transform\"\n\nexport class glTFTranslation extends glTFChannel {\n  private _transform: Transform3D\n\n  constructor(transform: Transform3D, input: ArrayLike<number>, interpolation: glTFInterpolation) {\n    super(input, interpolation)\n    this._transform = transform\n  }\n\n  updateTarget(data: ArrayLike<number>) {\n    this._transform.position.set(data[0], data[1], data[2])\n  }\n}","import { glTFChannel } from \"./gltf-channel\"\nimport { glTFInterpolation } from \"./gltf-interpolation\"\n\nexport class glTFWeights extends glTFChannel {\n  private _weights: number[]\n\n  constructor(weights: number[], input: ArrayLike<number>, interpolation: glTFInterpolation) {\n    super(input, interpolation)\n    this._weights = weights\n  }\n\n  updateTarget(data: ArrayLike<number>) {\n    for (let i = 0; i < data.length; i++) {\n      this._weights[i] = data[i]\n    }\n  }\n}","import { Mesh3D } from \"../../mesh/mesh\"\nimport { Container3D } from \"../../container\"\nimport { glTFInterpolationFactory } from \"./gltf-interpolation-factory\"\nimport { glTFRotation } from \"./gltf-rotation\"\nimport { glTFScale } from \"./gltf-scale\"\nimport { glTFSphericalLinear } from \"./gltf-spherical-linear\"\nimport { glTFTranslation } from \"./gltf-translation\"\nimport { glTFWeights } from \"./gltf-weights\"\n\nexport abstract class glTFChannelFactory {\n  static create(input: ArrayLike<number>, output: ArrayLike<number>, interpolation: string, path: string, target: Container3D) {\n    if (path === \"translation\") {\n      return new glTFTranslation(target.transform, input,\n        glTFInterpolationFactory.create(interpolation, input, output, 3))\n    }\n    if (path === \"scale\") {\n      return new glTFScale(target.transform, input,\n        glTFInterpolationFactory.create(interpolation, input, output, 3))\n    }\n    if (path === \"rotation\") {\n      if (interpolation === \"LINEAR\") {\n        return new glTFRotation(target.transform, input,\n          new glTFSphericalLinear(output))\n      }\n      return new glTFRotation(target.transform, input,\n        glTFInterpolationFactory.create(interpolation, input, output, 4))\n    }\n    if (path === \"weights\") {\n      let weights = (<Mesh3D>target.children[0]).targetWeights\n      if (!weights) {\n        return undefined\n      }\n      return new glTFWeights(weights, input,\n        glTFInterpolationFactory.create(interpolation, input, output, weights.length))\n    }\n    throw new Error(`PIXI3D: Unknown channel path \"${path}\"`)\n  }\n}","import { Texture, BaseTexture } from \"@pixi/core\"\nimport { ALPHA_MODES, WRAP_MODES } from \"@pixi/constants\"\n\nimport { glTFChannel } from \"./animation/gltf-channel\"\nimport { glTFAsset } from \"./gltf-asset\"\nimport { glTFAnimation } from \"./animation/gltf-animation\"\nimport { glTFAttribute } from \"./gltf-attribute\"\nimport { glTFMaterial } from \"./gltf-material\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { Container3D } from \"../container\"\nimport { Material } from \"../material/material\"\nimport { MaterialFactory } from \"../material/material-factory\"\nimport { MeshGeometry3D } from \"../mesh/geometry/mesh-geometry\"\nimport { Model } from \"../model\"\nimport { Matrix4 } from \"../transform/matrix4\"\nimport { Skin } from \"../skinning/skin\"\nimport { Joint } from \"../skinning/joint\"\nimport { StandardMaterialFactory } from \"../material/standard/standard-material-factory\"\nimport { glTFChannelFactory } from \"./animation/gltf-channel-factory\"\n\n/**\n * Parses glTF assets and creates models and meshes.\n */\nexport class glTFParser {\n  private _asset: glTFAsset\n  private _materialFactory: MaterialFactory\n  private _descriptor: any\n  private _textures: Texture[] = []\n\n  /**\n   * Creates a new parser using the specified asset.\n   * @param asset The asset to parse.\n   * @param materialFactory The material factory to use.\n   */\n  constructor(asset: glTFAsset, materialFactory?: MaterialFactory) {\n    this._asset = asset\n    this._materialFactory = materialFactory || new StandardMaterialFactory()\n    this._descriptor = this._asset.descriptor\n    for (let i = 0; i < this._descriptor.textures?.length; i++) {\n      this._textures.push(this.parseTexture(i))\n    }\n  }\n\n  /**\n   * Creates a model from the specified asset.\n   * @param asset The asset to create the model from.\n   * @param materialFactory The material factory to use.\n   */\n  static createModel(asset: glTFAsset, materialFactory?: MaterialFactory) {\n    return new glTFParser(asset, materialFactory).parseModel()\n  }\n\n  /**\n   * Creates a mesh from the specified asset.\n   * @param asset The asset to create the mesh from.\n   * @param materialFactory The material factory to use.\n   * @param mesh The mesh index in the JSON descriptor.\n   */\n  static createMesh(asset: glTFAsset, materialFactory?: MaterialFactory, mesh = 0) {\n    return new glTFParser(asset, materialFactory).parseMesh(mesh)\n  }\n\n  /**\n   * Creates a new buffer view from the specified accessor.\n   * @param accessor The accessor object or index.\n   */\n  parseBuffer(accessor: any) {\n    if (accessor === undefined) { return undefined }\n    if (typeof accessor === \"number\") {\n      accessor = this._asset.descriptor.accessors[accessor]\n    }\n    let bufferView = this._descriptor.bufferViews[accessor.bufferView || 0]\n    let offset = accessor.byteOffset || 0\n    if (bufferView.byteOffset !== undefined) {\n      offset += bufferView.byteOffset\n    }\n    let size = accessor.count * componentCount[accessor.type]\n    if (bufferView.byteStride !== undefined && bufferView.byteStride !== 0) {\n      size = bufferView.byteStride / componentSize[accessor.componentType] * (accessor.count - 1) + componentCount[accessor.type]\n    }\n    let buffer = this._asset.buffers[bufferView.buffer]\n\n    return glTFAttribute.from(\n      accessor.componentType, buffer, offset, size, bufferView.byteStride, accessor.min, accessor.max)\n  }\n\n  /**\n   * Creates an animation from the specified animation.\n   * @param animation The source animation object or index.\n   * @param nodes The array of nodes which are potential targets for the animation.\n   */\n  parseAnimation(animation: any, nodes: Container3D[]) {\n    if (typeof animation === \"number\") {\n      animation = this._asset.descriptor.animations[animation]\n    }\n    let channels: glTFChannel[] = []\n    for (let channel of animation.channels) {\n      let sampler = animation.samplers[channel.sampler]\n      let input = this.parseBuffer(sampler.input)\n      if (input === undefined) {\n        continue\n      }\n      let output = this.parseBuffer(sampler.output)\n      if (output === undefined) {\n        continue\n      }\n      let animationChannel = glTFChannelFactory.create(\n        input.buffer, output.buffer, sampler.interpolation || \"LINEAR\", channel.target.path, nodes[channel.target.node])\n      if (animationChannel) {\n        channels.push(animationChannel)\n      }\n    }\n    return new glTFAnimation(channels, animation.name)\n  }\n\n  /**\n   * Creates a material from the specified source.\n   * @param material The source material object or index.\n   */\n  parseMaterial(material?: any) {\n    if (typeof material === \"number\") {\n      material = this._asset.descriptor.materials[material]\n    }\n    let result = new glTFMaterial()\n    if (!material) {\n      return this._materialFactory.create(result)\n    }\n    if (material.occlusionTexture !== undefined) {\n      result.occlusionTexture = this._textures[material.occlusionTexture.index].clone()\n      result.occlusionTexture.strength = material.occlusionTexture.strength\n      result.occlusionTexture.texCoord = material.occlusionTexture.texCoord\n      if (material.occlusionTexture.extensions && material.occlusionTexture.extensions.KHR_texture_transform) {\n        result.occlusionTexture.transform = material.occlusionTexture.extensions.KHR_texture_transform\n        if (material.occlusionTexture.extensions.KHR_texture_transform.texCoord !== undefined) {\n          result.occlusionTexture.texCoord = material.occlusionTexture.extensions.KHR_texture_transform.texCoord\n        }\n      }\n    }\n    if (material.normalTexture !== undefined) {\n      result.normalTexture = this._textures[material.normalTexture.index].clone()\n      result.normalTexture.scale = material.normalTexture.scale || 1\n      result.normalTexture.texCoord = material.normalTexture.texCoord\n      if (material.normalTexture.extensions && material.normalTexture.extensions.KHR_texture_transform) {\n        result.normalTexture.transform = material.normalTexture.extensions.KHR_texture_transform\n        if (material.normalTexture.extensions.KHR_texture_transform.texCoord !== undefined) {\n          result.normalTexture.texCoord = material.normalTexture.extensions.KHR_texture_transform.texCoord\n        }\n      }\n    }\n    if (material.emissiveTexture !== undefined) {\n      result.emissiveTexture = this._textures[material.emissiveTexture.index].clone()\n      result.emissiveTexture.texCoord = material.emissiveTexture.texCoord\n      if (material.emissiveTexture.extensions && material.emissiveTexture.extensions.KHR_texture_transform) {\n        result.emissiveTexture.transform = material.emissiveTexture.extensions.KHR_texture_transform\n        if (material.emissiveTexture.extensions.KHR_texture_transform.texCoord !== undefined) {\n          result.emissiveTexture.texCoord = material.emissiveTexture.extensions.KHR_texture_transform.texCoord\n        }\n      }\n    }\n    if (material.doubleSided !== undefined) {\n      result.doubleSided = material.doubleSided\n    }\n    if (material.emissiveFactor) {\n      result.emissiveFactor = material.emissiveFactor\n    }\n    if (material.alphaMode) {\n      result.alphaMode = material.alphaMode\n    }\n    if (material.alphaCutoff !== undefined) {\n      result.alphaCutoff = material.alphaCutoff\n    }\n    let pbr = material.pbrMetallicRoughness\n    if (pbr?.metallicRoughnessTexture !== undefined) {\n      result.metallicRoughnessTexture = this._textures[pbr.metallicRoughnessTexture.index].clone()\n      result.metallicRoughnessTexture.texCoord = pbr.metallicRoughnessTexture.texCoord\n      if (pbr.metallicRoughnessTexture.extensions && pbr.metallicRoughnessTexture.extensions.KHR_texture_transform) {\n        result.metallicRoughnessTexture.transform = pbr.metallicRoughnessTexture.extensions.KHR_texture_transform\n        if (pbr.metallicRoughnessTexture.extensions.KHR_texture_transform.texCoord !== undefined) {\n          result.metallicRoughnessTexture.texCoord = pbr.metallicRoughnessTexture.extensions.KHR_texture_transform.texCoord\n        }\n      }\n    }\n    if (pbr?.baseColorFactor) {\n      result.baseColor = pbr.baseColorFactor\n    }\n    if (pbr?.baseColorTexture !== undefined) {\n      result.baseColorTexture = this._textures[pbr.baseColorTexture.index].clone()\n      result.baseColorTexture.texCoord = pbr.baseColorTexture.texCoord\n      if (pbr.baseColorTexture.extensions && pbr.baseColorTexture.extensions.KHR_texture_transform) {\n        result.baseColorTexture.transform = pbr.baseColorTexture.extensions.KHR_texture_transform\n        if (pbr.baseColorTexture.extensions.KHR_texture_transform.texCoord !== undefined) {\n          result.baseColorTexture.texCoord = pbr.baseColorTexture.extensions.KHR_texture_transform.texCoord\n        }\n      }\n    }\n    if (pbr?.metallicFactor !== undefined) {\n      result.metallic = pbr.metallicFactor\n    }\n    if (pbr?.roughnessFactor !== undefined) {\n      result.roughness = pbr.roughnessFactor\n    }\n    if (material.extensions) {\n      result.unlit = material.extensions[\"KHR_materials_unlit\"] !== undefined\n    }\n    return this._materialFactory.create(result)\n  }\n\n  /**\n   * Returns the texture used by the specified object.\n   * @param source The source object or index.\n   */\n  parseTexture(index: number) {\n    const texture = this._descriptor.textures[index]\n    const image = this._asset.images[texture.source]\n    const result = new Texture(new BaseTexture(image.baseTexture.resource, {\n      wrapMode: WRAP_MODES.REPEAT,\n      // Went back and forth about NO_PREMULTIPLIED_ALPHA. The default in\n      // PixiJS is to have premultiplied alpha textures, but this may not work\n      // so well when rendering objects as opaque (which have alpha equal to 0).\n      // In that case it's impossible to retrieve the original RGB values, \n      // because they are all zero when using premultiplied alpha. Both the glTF\n      // Sample Viewer and Babylon.js uses NO_PREMULTIPLIED_ALPHA so decided to\n      // do the same.\n      alphaMode: ALPHA_MODES.NO_PREMULTIPLIED_ALPHA\n    }))\n    if (this._descriptor.samplers && texture.sampler !== undefined) {\n      const sampler = this._descriptor.samplers[texture.sampler]\n      switch (sampler.wrapS) {\n        case 10497: result.baseTexture.wrapMode = WRAP_MODES.REPEAT; break\n        case 33648: result.baseTexture.wrapMode = WRAP_MODES.MIRRORED_REPEAT; break\n        case 33071: result.baseTexture.wrapMode = WRAP_MODES.CLAMP; break\n      }\n    }\n    return result\n  }\n\n  /**\n   * Creates an array of meshes from the specified mesh.\n   * @param mesh The source mesh object or index.\n   * @returns An array which contain arrays of meshes. This is because of the \n   * structure used in glTF, where each mesh contain a number of primitives. \n   * Read more about this in discussion at https://github.com/KhronosGroup/glTF/issues/821\n   */\n  parseMesh(mesh: any) {\n    if (typeof mesh === \"number\") {\n      mesh = this._asset.descriptor.meshes[mesh]\n    }\n    let weights = mesh.weights || []\n    return <Mesh3D[]>mesh.primitives.map((primitive: any) => {\n      return Object.assign<Mesh3D, Partial<Mesh3D>>(this.parsePrimitive(primitive), {\n        name: mesh.name,\n        targetWeights: weights\n      })\n    })\n  }\n\n  /**\n   * Creates a skin from the specified source.\n   * @param skin The source skin object or index.\n   * @param target The target container for the skin.\n   * @param nodes The array of nodes which are potential targets for the animation.\n   */\n  parseSkin(skin: any, target: Container3D, nodes: Container3D[]) {\n    if (typeof skin === \"number\") {\n      skin = this._asset.descriptor.skins[skin]\n    }\n    return new Skin(target,\n      skin.joints.map((joint: number) => <Joint>nodes[joint]))\n  }\n\n  /**\n   * Creates a mesh from the specified primitive.\n   * @param primitive The source primitive object.\n   */\n  parsePrimitive(primitive: any) {\n    let { attributes, targets } = primitive\n    let geometry = Object.assign<MeshGeometry3D, Partial<MeshGeometry3D>>(new MeshGeometry3D(), {\n      indices: this.parseBuffer(primitive.indices),\n      positions: this.parseBuffer(attributes[\"POSITION\"]),\n      normals: this.parseBuffer(attributes[\"NORMAL\"]),\n      tangents: this.parseBuffer(attributes[\"TANGENT\"]),\n      joints: this.parseBuffer(attributes[\"JOINTS_0\"]),\n      weights: this.parseBuffer(attributes[\"WEIGHTS_0\"]),\n      colors: this.parseBuffer(attributes[\"COLOR_0\"])\n    })\n    for (let i = 0; true; i++) {\n      let buffer = this.parseBuffer(attributes[`TEXCOORD_${i}`])\n      if (buffer === undefined) {\n        break\n      }\n      geometry.uvs = geometry.uvs || []\n      geometry.uvs.push(buffer)\n    }\n    if (targets) {\n      for (let i = 0; i < targets.length; i++) {\n        geometry.targets = geometry.targets || []\n        geometry.targets.push({\n          positions: this.parseBuffer(targets[i][\"POSITION\"]),\n          normals: this.parseBuffer(targets[i][\"NORMAL\"]),\n          tangents: this.parseBuffer(targets[i][\"TANGENT\"])\n        })\n      }\n    }\n    let material: Material\n    if (primitive.material !== undefined) {\n      material = this.parseMaterial(\n        this._asset.descriptor.materials[primitive.material])\n    } else {\n      material = this.parseMaterial()\n    }\n    return new Mesh3D(geometry, material)\n  }\n\n  /**\n   * Creates a container or joint from the specified node index.\n   * @param node The index of the node.\n   */\n  parseNode(index: number) {\n    const node = this._asset.descriptor.nodes[index]\n    let joint: Joint | undefined\n    for (let skin of this._asset.descriptor.skins || []) {\n      const i = skin.joints.indexOf(index)\n      if (i >= 0) {\n        // This node is a joint\n        const inverseBindMatrices = this.parseBuffer(skin.inverseBindMatrices)\n        const inverseBindMatrix = <Float32Array>inverseBindMatrices?.buffer.slice(i * 16, i * 16 + 16)\n        joint = Object.assign<Joint, Partial<Joint>>(new Joint(inverseBindMatrix), {\n          name: node.name\n        })\n      }\n    }\n    let container = joint || Object.assign<Container3D, Partial<Container3D>>(new Container3D(), {\n      name: node.name\n    })\n    if (node.translation) {\n      container.position.set(\n        node.translation[0], node.translation[1], node.translation[2]\n      )\n    }\n    if (node.rotation) {\n      container.rotationQuaternion.set(\n        node.rotation[0], node.rotation[1], node.rotation[2], node.rotation[3]\n      )\n    }\n    if (node.scale) {\n      container.scale.set(node.scale[0], node.scale[1], node.scale[2])\n    }\n    if (node.matrix) {\n      container.transform.setFromMatrix(new Matrix4(node.matrix))\n    }\n    return <Container3D>container\n  }\n\n  parseModel() {\n    let nodes = <Container3D[]>this._descriptor.nodes.map((n: any, i: number) => {\n      return this.parseNode(i)\n    })\n    let scene = this._descriptor.scenes[this._asset.descriptor.scene || 0]\n    let model = new Model()\n\n    let createHierarchy = (parent: Container3D, node: number) => {\n      let mesh = this._asset.descriptor.nodes[node].mesh\n      let skin: Skin | undefined\n      if (this._asset.descriptor.nodes[node].skin !== undefined) {\n        skin = this.parseSkin(this._asset.descriptor.nodes[node].skin, nodes[node], nodes)\n      }\n\n      if (mesh !== undefined) {\n        for (let primitive of this.parseMesh(mesh)) {\n          model.meshes.push(nodes[node].addChild(primitive))\n          model.meshes[model.meshes.length - 1].skin = skin\n        }\n      }\n      parent.addChild(nodes[node])\n      if (!this._asset.descriptor.nodes[node].children) {\n        return\n      }\n      for (let child of this._asset.descriptor.nodes[node].children) {\n        createHierarchy(nodes[node], child)\n      }\n    }\n    for (let node of scene.nodes) {\n      createHierarchy(model, node)\n    }\n    if (this._asset.descriptor.animations) {\n      for (let animation of this._asset.descriptor.animations) {\n        model.animations.push(this.parseAnimation(animation, nodes))\n      }\n    }\n    return model\n  }\n}\n\nconst componentCount: { [name: string]: number } = {\n  SCALAR: 1, VEC2: 2, VEC3: 3, VEC4: 4, MAT2: 4, MAT3: 9, MAT4: 16\n}\n\nconst componentSize: { [name: number]: number } = {\n  [5120]: 1, [5121]: 1, [5122]: 2, [5123]: 2, [5125]: 4, [5126]: 4\n}","import { Container3D } from \"./container\"\nimport { InstancedMesh3D } from \"./mesh/instanced-mesh\"\nimport { Model } from \"./model\"\nimport { Mesh3D } from \"./mesh/mesh\"\n\nfunction clone(node: Container3D, parent: Container3D, meshes: InstancedMesh3D[]) {\n  for (let child of node.children) {\n    if (child instanceof Mesh3D) {\n      const mesh = child.createInstance()\n      mesh.name = child.name\n      meshes.push(parent.addChild(mesh))\n    }\n    else if (child instanceof Container3D) {\n      const copy = parent.addChild(new Container3D())\n      copy.name = node.name\n      copy.position = child.position\n      copy.scale = child.scale\n      copy.rotationQuaternion = child.rotationQuaternion\n      clone(child, copy, meshes)\n    }\n  }\n}\n\n/**\n * Represents an instance of a model.\n */\nexport class InstancedModel extends Container3D {\n  /** The meshes included in the model. */\n  meshes: InstancedMesh3D[] = []\n\n  /**\n   * Creates a new model instance from the specified model.\n   * @param model The model to create instance from.\n   */\n  constructor(model: Model) {\n    super()\n    clone(model, this, this.meshes)\n  }\n}","import { glTFParser } from \"./gltf/gltf-parser\"\nimport { glTFAsset } from \"./gltf/gltf-asset\"\nimport { MaterialFactory } from \"./material/material-factory\"\nimport { Mesh3D } from \"./mesh/mesh\"\nimport { Animation } from \"./animation\"\nimport { Container3D } from \"./container\"\nimport { InstancedModel } from \"./instanced-model\"\nimport { AABB } from \"./math/aabb\"\n\n/**\n * Represents a model which has been loaded from a file. Contains a hierarchy of meshes and animations.\n */\nexport class Model extends Container3D {\n  /** The animations included in the model. */\n  animations: Animation[] = []\n\n  /**\n   * The meshes included in the model. Note that this array and the actual \n   * childen are not automatically synchronized after the model has been loaded.\n   */\n  meshes: Mesh3D[] = []\n\n  /**\n   * Creates a new model from a source.\n   * @param source The source to create the model from.\n   * @param materialFactory The factory to use for creating materials.\n   */\n  static from(source: glTFAsset, materialFactory?: MaterialFactory) {\n    return glTFParser.createModel(source, materialFactory)\n  }\n\n  /**\n   * Creates a new instance of this model.\n   */\n  createInstance() {\n    return new InstancedModel(this)\n  }\n\n  /**\n   * Calculates and returns a axis-aligned bounding box of the model in world\n   * space. The bounding box will encapsulate the meshes included in the model.\n   */\n  getBoundingBox() {\n    this.updateTransform()\n\n    let aabb = new AABB()\n    let mesh = this.meshes[0].getBoundingBox()\n    if (mesh) {\n      aabb.min = mesh.min\n      aabb.max = mesh.max\n    }\n    for (let i = 1; i < this.meshes.length; i++) {\n      let mesh = this.meshes[i].getBoundingBox()\n      if (mesh) {\n        aabb.encapsulate(mesh.min)\n        aabb.encapsulate(mesh.max)\n      }\n    }\n    return aabb\n  }\n}","import { Color } from \"../color\"\nimport { Container3D } from \"../container\"\nimport { LightType } from \"./light-type\"\n\nexport class Light extends Container3D {\n  /** The type of the light. */\n  type = LightType.point\n\n  /** The color of the light. */\n  color = new Color(1, 1, 1)\n\n  /** The range of the light. */\n  range = 10\n\n  /** The intensity of the light. */\n  intensity = 10\n\n  /** The inner cone angle specified in degrees. */\n  innerConeAngle = 0\n\n  /** The outer cone angle specified in degrees. */\n  outerConeAngle = 45\n}","import { Color } from \"../color\"\nimport { RenderTexture, Renderer } from \"@pixi/core\"\nimport { RenderPass } from \"./render-pass\"\nimport { Mesh3D } from \"../mesh/mesh\"\n\n/**\n * Pass used for rendering materials.\n */\nexport class MaterialRenderPass implements RenderPass {\n  private _renderTexture?: RenderTexture\n\n  /** The color (r,g,b,a) used for clearing the render texture. If this value is empty, the render texture will not be cleared. */\n  clearColor?= new Color(0, 0, 0, 0)\n\n  /** The texture used when rendering to a texture. */\n  get renderTexture() {\n    return this._renderTexture\n  }\n\n  set renderTexture(value: RenderTexture | undefined) {\n    this._renderTexture = value\n  }\n\n  /**\n   * Creates a new material render pass.\n   * @param renderer The renderer to use.\n   * @param name The name of the render pass.\n   */\n  constructor(public renderer: Renderer, public name: string) { }\n\n  clear() {\n    if (this._renderTexture && this.clearColor) {\n      const current = this.renderer.renderTexture.current\n      this.renderer.renderTexture.bind(this._renderTexture)\n      this.renderer.renderTexture.clear(Array.from(this.clearColor.rgba))\n      this.renderer.renderTexture.bind(current || undefined)\n    }\n  }\n\n  render(meshes: Mesh3D[]) {\n    const current = this.renderer.renderTexture.current\n    if (this._renderTexture) {\n      this.renderer.renderTexture.bind(this._renderTexture)\n    }\n    for (let mesh of meshes) {\n      if (mesh.material) {\n        mesh.material.render(mesh, this.renderer)\n      }\n    }\n    if (this._renderTexture) {\n      this.renderer.renderTexture.bind(current || undefined)\n    }\n  }\n}\n","export var Shader = {\"source\":\"#version 100\\n\\nattribute vec3 a_Position;\\nattribute vec2 a_UV1;\\n\\nvarying vec2 v_UV1;\\n\\nvoid main() {\\n  v_UV1 = a_UV1;\\n  gl_Position = vec4(a_Position, 1.0);\\n}\"};","export var Shader = {\"source\":\"#version 100\\n\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\n  precision highp float;\\n#else\\n  precision mediump float;\\n#endif\\n\\nvarying vec2 v_UV1;\\n\\nuniform vec2 u_BlurScale;\\nuniform sampler2D u_FilterSampler;\\n\\nvoid main() {\\n  vec4 color = vec4(0.0);\\n\\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-3.0) * u_BlurScale.xy)) * (1.0/64.0);\\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-2.0) * u_BlurScale.xy)) * (6.0/64.0);\\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-1.0) * u_BlurScale.xy)) * (15.0/64.0);\\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+0.0) * u_BlurScale.xy)) * (20.0/64.0);\\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+1.0) * u_BlurScale.xy)) * (15.0/64.0);\\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+2.0) * u_BlurScale.xy)) * (6.0/64.0);\\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+3.0) * u_BlurScale.xy)) * (1.0/64.0);\\n\\n  gl_FragColor = color;\\n}\"};","import { Renderer, Program, RenderTexture } from \"@pixi/core\"\nimport { MeshShader } from \"../mesh/mesh-shader\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { ShadowCastingLight } from \"./shadow-casting-light\"\nimport { Shader as Vertex } from \"./shader/gaussian-blur.vert\"\nimport { Shader as Fragment } from \"./shader/gaussian-blur.frag\"\n\nexport class ShadowFilter {\n  private _gaussianBlurShader: MeshShader\n  private _mesh: Mesh3D\n\n  constructor(public renderer: Renderer) {\n    this._mesh = Mesh3D.createQuad()\n    this._gaussianBlurShader = new MeshShader(Program.from(Vertex.source, Fragment.source))\n  }\n\n  applyGaussianBlur(light: ShadowCastingLight) {\n    this.applyBlurScale(light.shadowTexture, light.filterTexture,\n      new Float32Array([0, light.softness / light.shadowTexture.height]))\n    this.applyBlurScale(light.filterTexture, light.shadowTexture,\n      new Float32Array([light.softness / light.shadowTexture.width, 0]))\n  }\n\n  applyBlurScale(input: RenderTexture, output: RenderTexture, scale: Float32Array) {\n    this.renderer.renderTexture.bind(output)\n    this.renderer.renderTexture.clear()\n\n    this._gaussianBlurShader.uniforms.u_FilterSampler = input\n    this._gaussianBlurShader.uniforms.u_BlurScale = scale\n    this._gaussianBlurShader.render(this._mesh, this.renderer)\n\n    this.renderer.renderTexture.bind(undefined)\n  }\n}","export var Shader = {\"source\":\"#version 100\\n\\n#define FEATURES\\n\\nattribute vec3 a_Position;\\n\\n#ifdef USE_SKINNING\\nattribute vec4 a_Joint1;\\nattribute vec4 a_Weight1;\\n#endif\\n\\nuniform mat4 u_ViewProjectionMatrix;\\nuniform mat4 u_ModelMatrix;\\n\\n#ifdef USE_SKINNING\\n  #ifdef USE_SKINNING_TEXTURE\\n    uniform sampler2D u_jointMatrixSampler;\\n  #else\\n    uniform mat4 u_jointMatrix[MAX_JOINT_COUNT];\\n  #endif\\n#endif\\n\\n// these offsets assume the texture is 4 pixels across\\n#define ROW0_U ((0.5 + 0.0) / 4.0)\\n#define ROW1_U ((0.5 + 1.0) / 4.0)\\n#define ROW2_U ((0.5 + 2.0) / 4.0)\\n#define ROW3_U ((0.5 + 3.0) / 4.0)\\n\\n#ifdef USE_SKINNING\\nmat4 getJointMatrix(float boneNdx) {\\n    #ifdef USE_SKINNING_TEXTURE\\n    float v = (boneNdx + 0.5) / float(MAX_JOINT_COUNT);\\n    return mat4(\\n        texture2D(u_jointMatrixSampler, vec2(ROW0_U, v)),\\n        texture2D(u_jointMatrixSampler, vec2(ROW1_U, v)),\\n        texture2D(u_jointMatrixSampler, vec2(ROW2_U, v)),\\n        texture2D(u_jointMatrixSampler, vec2(ROW3_U, v))\\n    );\\n    #else\\n    return u_jointMatrix[int(boneNdx)];\\n    #endif\\n}\\n\\nmat4 getSkinningMatrix()\\n{\\n    mat4 skin = mat4(0);\\n    skin +=\\n        a_Weight1.x * getJointMatrix(a_Joint1.x) +\\n        a_Weight1.y * getJointMatrix(a_Joint1.y) +\\n        a_Weight1.z * getJointMatrix(a_Joint1.z) +\\n        a_Weight1.w * getJointMatrix(a_Joint1.w);\\n    return skin;\\n}\\n#endif\\n\\nvoid main() {\\n  vec4 pos = vec4(a_Position, 1.0);\\n  #ifdef USE_SKINNING\\n    pos = getSkinningMatrix() * pos;\\n  #endif\\n  gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * pos;\\n}\"};","export var Shader = {\"source\":\"#version 100\\n\\n#extension GL_OES_standard_derivatives : enable\\n\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\n  precision highp float;\\n#else\\n  precision mediump float;\\n#endif\\n\\nvoid main() {\\n  float depth = gl_FragCoord.z;\\n  float dx = 0.0;\\n  float dy = 0.0;\\n\\n  #ifdef GL_OES_standard_derivatives\\n    dx = dFdx(depth);\\n    dy = dFdy(depth);\\n  #endif\\n\\n  float moment2 = depth * depth + 0.25 * (dx * dx + dy * dy);\\n  gl_FragColor = vec4(1.0 - depth, 1.0 - moment2, 0.0, 0.0);\\n}\"};","import { Renderer, Program, Geometry, Buffer } from \"@pixi/core\"\nimport { MeshGeometry3D } from \"../mesh/geometry/mesh-geometry\"\nimport { MeshShader } from \"../mesh/mesh-shader\"\nimport { StandardShaderSource } from \"../material/standard/standard-shader-source\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { ShadowCastingLight } from \"./shadow-casting-light\"\nimport { Shader as Vertex } from \"./shader/shadow.vert\"\nimport { Shader as Fragment } from \"./shader/shadow.frag\"\n\nexport class ShadowShader extends MeshShader {\n  constructor(renderer: Renderer, features: string[] = []) {\n    super(Program.from(\n      StandardShaderSource.build(Vertex.source, features, renderer),\n      StandardShaderSource.build(Fragment.source, features, renderer)))\n  }\n\n  get maxSupportedJoints() {\n    return 0\n  }\n\n  createShaderGeometry(geometry: MeshGeometry3D) {\n    let result = new Geometry()\n    if (geometry.indices) {\n      if (geometry.indices.buffer.BYTES_PER_ELEMENT === 1) {\n        // PIXI seems to have problems with Uint8Array, let's convert to UNSIGNED_SHORT.\n        result.addIndex(new Buffer(new Uint16Array(geometry.indices.buffer)))\n      } else {\n        result.addIndex(new Buffer(geometry.indices.buffer))\n      }\n    }\n    if (geometry.positions) {\n      result.addAttribute(\"a_Position\", new Buffer(geometry.positions.buffer),\n        3, false, geometry.positions.componentType, geometry.positions.stride)\n    }\n    return result\n  }\n\n  get name() {\n    return \"shadow-shader\"\n  }\n\n  updateUniforms(mesh: Mesh3D, shadowCastingLight: ShadowCastingLight) {\n    this.uniforms.u_ModelMatrix = mesh.worldTransform.array\n    this.uniforms.u_ViewProjectionMatrix = shadowCastingLight.lightViewProjection\n  }\n}","import { Renderer, Buffer } from \"@pixi/core\"\nimport { MeshGeometry3D } from \"../mesh/geometry/mesh-geometry\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { Capabilities } from \"../capabilities\"\nimport { ShadowCastingLight } from \"./shadow-casting-light\"\nimport { ShadowShader } from \"./shadow-shader\"\n\nexport class SkinningShader extends ShadowShader {\n  private _maxSupportedJoints: number\n\n  get maxSupportedJoints() {\n    return this._maxSupportedJoints\n  }\n\n  static getMaxJointCount(renderer: Renderer) {\n    let uniformsRequiredForOtherFeatures = 8\n    let availableVertexUniforms =\n      Capabilities.getMaxVertexUniformVectors(renderer) - uniformsRequiredForOtherFeatures\n    let uniformsRequiredPerJoint = 4\n    return Math.floor(availableVertexUniforms / uniformsRequiredPerJoint)\n  }\n\n  constructor(renderer: Renderer) {\n    // When setting the MAX_JOINT_COUNT, it needs to be subtracted by 1 for\n    // some reason. Otherwise it will exceeed maximum vertex uniforms.\n    const maxJointCount = SkinningShader.getMaxJointCount(renderer) - 1\n    super(renderer, [\"USE_SKINNING 1\", \"MAX_JOINT_COUNT \" + maxJointCount])\n    this._maxSupportedJoints = maxJointCount\n  }\n\n  createShaderGeometry(geometry: MeshGeometry3D) {\n    let result = super.createShaderGeometry(geometry)\n    if (geometry.joints) {\n      result.addAttribute(\"a_Joint1\", new Buffer(geometry.joints.buffer),\n        4, false, geometry.joints.componentType, geometry.joints.stride)\n    }\n    if (geometry.weights) {\n      result.addAttribute(\"a_Weight1\", new Buffer(geometry.weights.buffer),\n        4, false, geometry.weights.componentType, geometry.weights.stride)\n    }\n    return result\n  }\n\n  get name() {\n    return \"skinned-shadow-shader\"\n  }\n\n  updateUniforms(mesh: Mesh3D, shadowCastingLight: ShadowCastingLight) {\n    super.updateUniforms(mesh, shadowCastingLight)\n    if (!mesh.skin) {\n      return\n    }\n    this.uniforms.u_jointMatrix = mesh.skin.jointMatrices\n  }\n}","import { Renderer, Buffer } from \"@pixi/core\"\nimport { MeshGeometry3D } from \"../mesh/geometry/mesh-geometry\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { ShadowCastingLight } from \"./shadow-casting-light\"\nimport { ShadowShader } from \"./shadow-shader\"\nimport { StandardMaterialMatrixTexture } from \"../material/standard/standard-material-matrix-texture\"\n\nconst MAX_SUPPORTED_JOINTS = 256\n\nexport class TextureShader extends ShadowShader {\n  private _jointMatrixTexture: StandardMaterialMatrixTexture\n\n  static isSupported(renderer: Renderer) {\n    return StandardMaterialMatrixTexture.isSupported(renderer)\n  }\n\n  get maxSupportedJoints() {\n    return MAX_SUPPORTED_JOINTS\n  }\n\n  constructor(renderer: Renderer) {\n    super(renderer, [\n      \"USE_SKINNING 1\", \"USE_SKINNING_TEXTURE 1\", \"MAX_JOINT_COUNT \" + MAX_SUPPORTED_JOINTS\n    ])\n    this._jointMatrixTexture =\n      new StandardMaterialMatrixTexture(MAX_SUPPORTED_JOINTS)\n  }\n\n  createShaderGeometry(geometry: MeshGeometry3D) {\n    let result = super.createShaderGeometry(geometry)\n    if (geometry.joints) {\n      result.addAttribute(\"a_Joint1\", new Buffer(geometry.joints.buffer),\n        4, false, geometry.joints.componentType, geometry.joints.stride)\n    }\n    if (geometry.weights) {\n      result.addAttribute(\"a_Weight1\", new Buffer(geometry.weights.buffer),\n        4, false, geometry.weights.componentType, geometry.weights.stride)\n    }\n    return result\n  }\n\n  get name() {\n    return \"skinned-shadow-shader\"\n  }\n\n  updateUniforms(mesh: Mesh3D, shadowCastingLight: ShadowCastingLight) {\n    super.updateUniforms(mesh, shadowCastingLight)\n    if (!mesh.skin) {\n      return\n    }\n    this._jointMatrixTexture.updateBuffer(mesh.skin.jointMatrices)\n    this.uniforms.u_jointMatrixSampler = this._jointMatrixTexture\n  }\n}","import { State, Renderer } from \"@pixi/core\"\nimport { BLEND_MODES } from \"@pixi/constants\"\nimport { ShadowShader } from \"./shadow-shader\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { ShadowCastingLight } from \"./shadow-casting-light\"\nimport { SkinningShader } from \"./skinning-shader\"\nimport { TextureShader } from \"./texture-shader\"\nimport { Debug } from \"../debug\"\nimport { Message } from \"../message\"\n\nexport class ShadowRenderer {\n  private _state = Object.assign(new State(), {\n    depthTest: true, clockwiseFrontFace: false, culling: true, blendMode: BLEND_MODES.NONE\n  })\n  private _shadowShader: ShadowShader\n  private _skinningShader?: SkinningShader\n  private _textureShader?: TextureShader\n\n  constructor(public renderer: Renderer) {\n    this._shadowShader = new ShadowShader(this.renderer)\n  }\n\n  getSkinningShader() {\n    if (this._textureShader || this._skinningShader) {\n      return this._textureShader || this._skinningShader\n    }\n    if (TextureShader.isSupported(this.renderer)) {\n      this._textureShader = new TextureShader(this.renderer)\n    } else {\n      Debug.warn(Message.meshVertexSkinningFloatingPointTexturesNotSupported)\n      this._skinningShader = new SkinningShader(this.renderer)\n    }\n    return this._textureShader || this._skinningShader\n  }\n\n  render(mesh: Mesh3D, shadowCastingLight: ShadowCastingLight) {\n    let shader: ShadowShader | undefined = this._shadowShader\n    if (mesh.skin) {\n      let skinningShader = this.getSkinningShader()\n      if (skinningShader && mesh.skin.joints.length > skinningShader.maxSupportedJoints) {\n        Debug.error(Message.meshVertexSkinningNumberOfJointsNotSupported, {\n          joints: mesh.skin.joints.length,\n          maxJoints: skinningShader.maxSupportedJoints\n        })\n      } else {\n        shader = skinningShader\n      }\n    }\n    if (shader) {\n      shader.updateUniforms(mesh, shadowCastingLight)\n      shader.render(mesh, this.renderer, this._state)\n    }\n  }\n}","import { Renderer } from \"@pixi/core\"\nimport { RenderPass } from \"../pipeline/render-pass\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { ShadowFilter } from \"./shadow-filter\"\nimport { ShadowCastingLight } from \"./shadow-casting-light\"\nimport { ShadowRenderer } from \"./shadow-renderer\"\n\n/**\n * Pass used for rendering shadows.\n */\nexport class ShadowRenderPass implements RenderPass {\n  private _lights: ShadowCastingLight[] = []\n  private _filter: ShadowFilter\n  private _shadow: ShadowRenderer\n\n  /**\n   * Creates a new shadow render pass using the specified renderer.\n   * @param renderer The renderer to use.\n   * @param name The name for the render pass.\n   */\n  constructor(public renderer: Renderer, public name = \"shadow\") {\n    this._filter = new ShadowFilter(renderer)\n    this._shadow = new ShadowRenderer(renderer)\n  }\n\n  /**\n   * Adds a shadow casting light.\n   * @param shadowCastingLight The light to add.\n   */\n  addShadowCastingLight(shadowCastingLight: ShadowCastingLight) {\n    if (this._lights.indexOf(shadowCastingLight) < 0) {\n      this._lights.push(shadowCastingLight)\n    }\n  }\n\n  /**\n   * Removes a shadow casting light.\n   * @param shadowCastingLight The light to remove.\n   */\n  removeShadowCastingLight(shadowCastingLight: ShadowCastingLight) {\n    const index = this._lights.indexOf(shadowCastingLight)\n    if (index >= 0) {\n      this._lights.splice(index, 1)\n    }\n  }\n\n  clear() {\n    for (let shadowCastingLight of this._lights) {\n      shadowCastingLight.clear()\n    }\n  }\n\n  render(meshes: Mesh3D[]) {\n    if (meshes.length === 0 || this._lights.length === 0) {\n      return\n    }\n    const current = this.renderer.renderTexture.current\n    for (let shadowCastingLight of this._lights) {\n      this.renderer.renderTexture.bind(shadowCastingLight.shadowTexture)\n      shadowCastingLight.updateLightViewProjection()\n      for (let mesh of meshes) {\n        this._shadow.render(mesh, shadowCastingLight)\n      }\n      if (shadowCastingLight.softness > 0) {\n        this._filter.applyGaussianBlur(shadowCastingLight)\n      }\n    }\n    this.renderer.renderTexture.bind(current || undefined)\n  }\n}","import { RenderTexture, Renderer } from \"@pixi/core\"\nimport { DisplayObject, IDestroyOptions } from \"@pixi/display\"\nimport { Sprite } from \"@pixi/sprite\"\nimport { Ticker } from \"@pixi/ticker\"\nimport { Compatibility } from \"../compatibility/compatibility\"\n\nexport interface PostProcessingSpriteOptions {\n  /**\n   * The width of the texture for the sprite.\n   */\n  width?: number,\n  /**\n   * The height of the texture for the sprite.\n   */\n  height?: number,\n  /**\n   * The object to render. When set, it will automatically be rendered to the \n   * sprite's texture each frame.\n   */\n  objectToRender?: DisplayObject,\n  /**\n   * The resolution of the texture for the sprite.\n   */\n  resolution?: number\n}\n\n/**\n * Represents a sprite which can have post processing effects. Can be used for \n * rendering 3D objects as 2D sprites.\n */\nexport class PostProcessingSprite extends Sprite {\n  private _tickerRender = () => { }\n  private _renderTexture: RenderTexture\n\n  /** The render texture. */\n  get renderTexture() {\n    return this._renderTexture\n  }\n\n  /** The depth texture. */\n  get depthTexture() {\n    if (this._renderTexture) {\n      return this._renderTexture.baseTexture.framebuffer.depthTexture\n    }\n  }\n\n  /**\n   * Creates a new post processing sprite using the specified options.\n   * @param renderer The renderer to use.\n   * @param options The options for the render texture. If both width and height\n   * has not been set, it will automatically be resized to the renderer size.\n   */\n  constructor(public renderer: Renderer, options?: PostProcessingSpriteOptions) {\n    super()\n\n    let {\n      width = 512, height = 512, objectToRender, resolution = 1\n    } = options || {}\n\n    this._renderTexture = RenderTexture.create({ width, height, resolution })\n    /* When rendering to a texture, it's flipped vertically for some reason.\n    This will flip it back to it's expected orientation. */\n    this._renderTexture.rotate = 8\n    this._renderTexture.baseTexture.framebuffer.addDepthTexture()\n    this._texture = this._renderTexture\n\n    if (!options || !options.width || !options.height) {\n      renderer.on(\"prerender\", () => {\n        this._renderTexture.resize(renderer.screen.width, renderer.screen.height)\n      })\n    }\n    if (objectToRender) {\n      this._tickerRender = () => {\n        if (!renderer.gl) {\n          // The renderer was probably destroyed.\n          Ticker.shared.remove(this._tickerRender); return\n        }\n        if (this.worldVisible && this.worldAlpha > 0 && this.renderable) {\n          objectToRender && this.renderObject(objectToRender)\n        }\n      }\n      Ticker.shared.add(this._tickerRender)\n    }\n  }\n\n  /**\n   * Sets the resolution of the render texture.\n   * @param resolution The resolution to set.\n   */\n  setResolution(resolution: number) {\n    this._renderTexture.setResolution(resolution)\n    this._renderTexture.resize(\n      this._renderTexture.width, this._renderTexture.height, true)\n  }\n\n  destroy(options?: boolean | IDestroyOptions) {\n    Ticker.shared.remove(this._tickerRender); super.destroy(options)\n  }\n\n  /**\n   * Updates the sprite's texture by rendering the specified object to it.\n   * @param object The object to render.\n   */\n  renderObject(object: DisplayObject) {\n    Compatibility.render(this.renderer, object, this.renderTexture)\n  }\n}","import { BatchGeometry } from \"@pixi/core\"\nimport { TYPES } from \"@pixi/constants\"\n\nexport class SpriteBatchGeometry extends BatchGeometry {\n  constructor() {\n    super()\n\n    this.addAttribute(\"aMatrix0\", this._buffer, 4, false, TYPES.FLOAT)\n    this.addAttribute(\"aMatrix1\", this._buffer, 4, false, TYPES.FLOAT)\n    this.addAttribute(\"aMatrix2\", this._buffer, 4, false, TYPES.FLOAT)\n    this.addAttribute(\"aMatrix3\", this._buffer, 4, false, TYPES.FLOAT)\n  }\n}","export var Shader = {\"source\":\"precision highp float;\\n\\nattribute vec2 aVertexPosition;\\n\\nattribute vec4 aMatrix0;\\nattribute vec4 aMatrix1;\\nattribute vec4 aMatrix2;\\nattribute vec4 aMatrix3;\\n\\nattribute vec2 aTextureCoord;\\nattribute vec4 aColor;\\nattribute float aTextureId;\\n\\nuniform vec4 tint;\\n\\nvarying vec2 vTextureCoord;\\nvarying vec4 vColor;\\nvarying float vTextureId;\\n\\nvoid main(void) {\\n  mat4 modelMatrix = mat4(aMatrix0, aMatrix1, aMatrix2, aMatrix3);\\n\\n  gl_Position = modelMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);\\n\\n  vTextureCoord = vec2(aTextureCoord.x, aTextureCoord.y);\\n  vTextureId = aTextureId;\\n  vColor = aColor * tint;\\n}\"};","export var Shader = {\"source\":\"varying vec2 vTextureCoord;\\nvarying vec4 vColor;\\nvarying float vTextureId;\\n\\nuniform sampler2D uSamplers[%count%];\\n\\nvoid main(void){\\n    vec4 color;\\n    %forloop%\\n    gl_FragColor = vColor * vec4(color.rgb, color.a);\\n}\"};","import { Renderer, AbstractBatchRenderer, BatchShaderGenerator, IBatchableElement, ViewableBuffer } from \"@pixi/core\"\nimport { premultiplyTint } from \"@pixi/utils\"\nimport { SpriteBatchGeometry } from \"./sprite-batch-geometry\"\nimport { Shader as Vertex } from \"./shader/sprite.vert\"\nimport { Shader as Fragment } from \"./shader/sprite.frag\"\nimport { Compatibility } from \"../compatibility/compatibility\"\n\nexport class SpriteBatchRenderer extends AbstractBatchRenderer {\n  constructor(renderer: Renderer) {\n    super(renderer)\n\n    this.shaderGenerator = new BatchShaderGenerator(Vertex.source, Fragment.source)\n    this.geometryClass = SpriteBatchGeometry\n\n    // The vertex size when rendering 2D sprites is 6. Here, 16 is being added \n    // to hold the model matrix.\n    this.vertexSize = 6 + 16\n\n    Object.assign(this.state, {\n      culling: false, clockwiseFrontFace: false, depthTest: true\n    })\n  }\n\n  packInterleavedGeometry(element: IBatchableElement, attributeBuffer: ViewableBuffer, indexBuffer: Uint16Array, aIndex: number, iIndex: number) {\n    const { uint32View, float32View } = attributeBuffer\n    const packedVertices = aIndex / this.vertexSize\n    const uvs = element.uvs\n    const indicies = element.indices\n    const vertexData = element.vertexData\n    const textureId = element._texture.baseTexture._batchLocation\n\n    const alpha = Math.min(element.worldAlpha, 1.0)\n    const argb = (alpha < 1.0\n      && element._texture.baseTexture.alphaMode)\n      ? premultiplyTint(element._tintRGB, alpha)\n      : element._tintRGB + (alpha * 255 << 24)\n\n    for (let i = 0; i < vertexData.length; i += 2) {\n      float32View[aIndex++] = vertexData[i]\n      float32View[aIndex++] = vertexData[i + 1]\n      float32View[aIndex++] = uvs[i]\n      float32View[aIndex++] = uvs[i + 1]\n      uint32View[aIndex++] = argb\n      float32View[aIndex++] = textureId\n      for (let j = 0; j < 16; j++) {\n        // @ts-ignore\n        float32View[aIndex++] = element.modelViewProjection[j]\n      }\n    }\n    for (let i = 0; i < indicies.length; i++) {\n      indexBuffer[iIndex++] = packedVertices + indicies[i]\n    }\n  }\n}\n\nCompatibility.installRendererPlugin(\"sprite3d\", SpriteBatchRenderer)","import { ObjectRenderer, Renderer } from \"@pixi/core\"\nimport { MaterialRenderPass } from \"./material-render-pass\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { ShadowRenderPass } from \"../shadow/shadow-render-pass\"\nimport { PostProcessingSprite, PostProcessingSpriteOptions } from \"../sprite/post-processing-sprite\"\nimport { Model } from \"../model\"\nimport { ShadowCastingLight } from \"../shadow/shadow-casting-light\"\nimport { RenderPass } from \"./render-pass\"\nimport { StandardMaterial } from \"../material/standard/standard-material\"\nimport { MaterialRenderSortType } from \"../material/material-render-sort-type\"\nimport { Compatibility } from \"../compatibility/compatibility\"\nimport { SpriteBatchRenderer } from \"../sprite/sprite-batch-renderer\"\nimport { ProjectionSprite } from \"../sprite/projection-sprite\"\n\n/**\n * The standard pipeline renders meshes using the set render passes. It's\n * created and used by default.\n */\nexport class StandardPipeline extends ObjectRenderer {\n  protected _spriteRenderer: SpriteBatchRenderer\n  protected _meshes: Mesh3D[] = []\n  protected _sprites: ProjectionSprite[] = []\n\n  /** The pass used for rendering materials. */\n  materialPass = new MaterialRenderPass(this.renderer, \"material\")\n\n  /** The pass used for rendering shadows. */\n  shadowPass = new ShadowRenderPass(this.renderer, \"shadow\")\n\n  /** The array of render passes. Each mesh will be rendered with these passes (if it has been enabled on that mesh). */\n  renderPasses: RenderPass[] = [\n    this.shadowPass, this.materialPass,\n  ]\n\n  /**\n   * Creates a new standard pipeline using the specified renderer.\n   * @param renderer The renderer to use.\n   */\n  constructor(public renderer: Renderer) {\n    super(renderer)\n\n    renderer.on(\"prerender\", () => {\n      for (let pass of this.renderPasses) {\n        if (pass.clear) { pass.clear() }\n      }\n    })\n\n    this._spriteRenderer = new SpriteBatchRenderer(renderer)\n  }\n\n  /**\n   * Creates a new post processing sprite and sets the material pass to render\n   * to it's texture.\n   * @param options The options when creating the sprite.\n   */\n  createPostProcessingSprite(options?: PostProcessingSpriteOptions) {\n    const sprite =\n      new PostProcessingSprite(this.renderer, options)\n    this.materialPass.renderTexture = sprite.renderTexture\n    return sprite\n  }\n\n  /**\n   * Adds an object to be rendered.\n   * @param object The object to render.\n   */\n  render(object: Mesh3D | ProjectionSprite) {\n    if (object.isSprite) {\n      this._sprites.push(<ProjectionSprite>object)\n    } else {\n      this._meshes.push(<Mesh3D>object)\n    }\n  }\n\n  /**\n   * Renders the added meshes using the specified render passes.\n   */\n  flush() {\n    this.sort()\n    for (let pass of this.renderPasses) {\n      pass.render(this._meshes.filter(mesh => mesh.isRenderPassEnabled(pass.name)))\n    }\n    this._meshes = []\n\n    if (this._sprites.length > 0) {\n      this._spriteRenderer.start()\n      for (let sprite of this._sprites) {\n        // @ts-ignore\n        this._spriteRenderer.render(sprite)\n      }\n      this._spriteRenderer.stop()\n      this._sprites = []\n    }\n  }\n\n  /**\n   * Sorts the meshes by rendering order.\n   */\n  sort() {\n    this._meshes.sort((a, b) => {\n      if (!a.material || !b.material) {\n        return 0\n      }\n      if (a.material.renderSortType !== b.material.renderSortType) {\n        return a.material.renderSortType === MaterialRenderSortType.transparent ? 1 : -1\n      }\n      if (a.renderSortOrder === b.renderSortOrder) {\n        return 0\n      }\n      return a.renderSortOrder < b.renderSortOrder ? -1 : 1\n    })\n\n    this._sprites.sort((a, b) => {\n      if (a.zIndex !== b.zIndex) {\n        return a.zIndex - b.zIndex;\n      }\n      return b.distanceFromCamera - a.distanceFromCamera;\n    })\n  }\n\n  /**\n   * Enables shadows for the specified object. Adds the shadow render pass to \n   * the specified object and enables the standard material to use the casting \n   * light.\n   * @param object The mesh or model to enable shadows for.\n   * @param light The shadow casting light to associate with the \n   * object when using the standard material.\n   */\n  enableShadows(object: Mesh3D | Model, light?: ShadowCastingLight) {\n    let meshes = object instanceof Model ? object.meshes : [object]\n    for (let mesh of meshes) {\n      if (light && mesh.material instanceof StandardMaterial) {\n        mesh.material.shadowCastingLight = light\n      }\n      mesh.enableRenderPass(this.shadowPass.name)\n    }\n    if (light) {\n      this.shadowPass.addShadowCastingLight(light)\n    }\n  }\n\n  /**\n   * Disables shadows for the specified object.\n   * @param object The mesh or model to disable shadows for.\n   */\n  disableShadows(object: Mesh3D | Model) {\n    let meshes = object instanceof Model ? object.meshes : [object]\n    for (let mesh of meshes) {\n      if (mesh.material instanceof StandardMaterial) {\n        mesh.material.shadowCastingLight = undefined\n      }\n      mesh.disableRenderPass(this.shadowPass.name)\n    }\n  }\n}\n\nCompatibility.installRendererPlugin(\"pipeline\", StandardPipeline)","import * as PixiCore from \"@pixi/core\"\nimport { CompatibilityAccess } from \"./compatibility-access\"\n\nexport const ArrayResource: typeof PixiCore.ArrayResource =\n  CompatibilityAccess.get(PixiCore, \"ArrayResource\") ||\n  //@ts-ignore \n  CompatibilityAccess.get(PixiCore, \"resources\").ArrayResource","import * as PixiCore from \"@pixi/core\"\nimport { CompatibilityAccess } from \"./compatibility-access\"\n\nexport const BaseImageResource: typeof PixiCore.BaseImageResource =\n  CompatibilityAccess.get(PixiCore, \"BaseImageResource\") ||\n  //@ts-ignore \n  CompatibilityAccess.get(PixiCore, \"resources\").BaseImageResource","import { ArrayResource } from \"../compatibility/array-resource\"\nimport { FORMATS, TYPES, ALPHA_MODES } from \"@pixi/constants\"\nimport { Texture, BaseTexture, Renderer } from \"@pixi/core\"\nimport { BaseImageResource } from \"../compatibility/base-image-resource\"\nimport { BufferResource } from \"../compatibility/buffer-resource\"\n\nexport class MipmapResource extends ArrayResource {\n  constructor(source: (string | Texture)[], public target: number) {\n    super(source)\n  }\n\n  upload(renderer: Renderer, baseTexture: BaseTexture) {\n    renderer.gl.pixelStorei(renderer.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,\n      baseTexture.alphaMode === ALPHA_MODES.UNPACK)\n\n    for (let i = 0; i < this.items.length; i++) {\n      const resource = this.items[i].resource\n      if (resource instanceof BufferResource) {\n        renderer.gl.texImage2D(this.target, i, <FORMATS>baseTexture.format,\n          resource.width, resource.height, 0, <FORMATS>baseTexture.format, <TYPES>baseTexture.type, resource.data)\n      }\n      if (resource instanceof BaseImageResource) {\n        renderer.gl.texImage2D(this.target, i, <FORMATS>baseTexture.format,\n          <FORMATS>baseTexture.format, <TYPES>baseTexture.type, resource.source)\n      }\n    }\n    return true\n  }\n}","import { CubeResource } from \"../compatibility/cube-resource\"\nimport { Renderer } from \"@pixi/core\"\nimport { MipmapResource } from \"./mipmap-resource\"\n\nexport type MipmapResourceArray = [\n  MipmapResource,\n  MipmapResource,\n  MipmapResource,\n  MipmapResource,\n  MipmapResource,\n  MipmapResource\n]\n\nexport class CubemapResource extends CubeResource {\n  constructor(source: MipmapResourceArray, public levels = 1) {\n    super(source)\n  }\n\n  style(renderer: Renderer) {\n    let gl = renderer.gl\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n    if (this.levels > 1) {\n      gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR)\n    } else {\n      gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR)\n    }\n    return true\n  }\n}","import * as PixiCore from \"@pixi/core\"\nimport { CompatibilityAccess } from \"./compatibility-access\"\n\nexport const CubeResource: typeof PixiCore.CubeResource =\n  CompatibilityAccess.get(PixiCore, \"CubeResource\") ||\n  //@ts-ignore \n  CompatibilityAccess.get(PixiCore, \"resources\").CubeResource","import { TARGETS, TYPES, FORMATS, ALPHA_MODES } from \"@pixi/constants\"\nimport { BaseTexture, Texture } from \"@pixi/core\"\nimport { MipmapResource } from \"./mipmap-resource\"\nimport { CubemapResource, MipmapResourceArray } from \"./cubemap-resource\"\nimport { Color } from \"../color\"\nimport { CubemapFaces } from \"./cubemap-faces\"\nimport { BufferResource } from \"../compatibility/buffer-resource\"\n\n/**\n * Cubemap which supports multiple user specified mipmaps.\n */\nexport class Cubemap extends BaseTexture<CubemapResource> {\n\n  /** Returns an array of faces. */\n  static get faces(): [\"posx\", \"negx\", \"posy\", \"negy\", \"posz\", \"negz\"] {\n    return [\"posx\", \"negx\", \"posy\", \"negy\", \"posz\", \"negz\"]\n  }\n\n  /** Returns the number of mipmap levels. */\n  get levels() {\n    return this.resource.levels\n  }\n\n  /**\n   * Creates a new cubemap from the specified faces.\n   * @param faces The faces to create the cubemap from.\n   */\n  static fromFaces(faces: CubemapFaces | CubemapFaces[]) {\n    const array = Array.isArray(faces) ? faces : [faces]\n    const resources = <MipmapResourceArray>Cubemap.faces.map((face, index) => {\n      return new MipmapResource(array.map(f => f[face]),\n        TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X + index)\n    })\n    return new Cubemap(\n      new CubemapResource(resources, array.length))\n  }\n\n  /**\n   * Creates a new cubemap from the specified colors.\n   * @param posx The color for positive x.\n   * @param negx The color for negative x.\n   * @param posy The color for positive y.\n   * @param negy The color for negative y.\n   * @param posz The color for positive z.\n   * @param negz The color for negative z.\n   */\n  static fromColors(posx: Color, negx = posx, posy = posx, negy = posx, posz = posx, negz = posx) {\n    const resources: MipmapResource[] = []\n    const colors = [posx, negx, posy, negy, posz, negz]\n\n    for (let i = 0; i < colors.length; i++) {\n      let resource = new BufferResource(\n        new Uint8Array(colors[i].rgba.map(c => c * 255)), { width: 1, height: 1 })\n      let texture = new Texture(new BaseTexture(resource, {\n        type: TYPES.UNSIGNED_BYTE,\n        format: FORMATS.RGB,\n        alphaMode: ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,\n      }))\n      resources.push(new MipmapResource([texture],\n        TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X + i))\n    }\n    return new Cubemap(\n      new CubemapResource(<MipmapResourceArray>resources, 1))\n  }\n}","import { Loader, LoaderResource } from \"@pixi/loaders\"\nimport { Texture } from \"@pixi/core\"\nimport { Cubemap } from \"../cubemap/cubemap\"\nimport { CubemapFaces } from \"../cubemap/cubemap-faces\"\nimport { Compatibility } from \"../compatibility/compatibility\"\n\nexport const CubemapLoader = {\n  use: function (resource: any, next: () => void) {\n    if (resource.extension !== \"cubemap\") {\n      return next()\n    }\n    let loader = <Loader><unknown>this\n\n    const mipmaps = (<string[]>resource.data).map(mipmap => {\n      return Cubemap.faces.map(face => {\n        return resource.url.substring(0, resource.url.lastIndexOf(\"/\") + 1) + mipmap.replace(\"{{face}}\", face)\n      })\n    })\n\n    // The list of urls (faces and mipmaps) which needs to be loaded before the \n    // cubemap should be created.\n    let urls = mipmaps.reduce((acc, val) => acc.concat(val), [])\n\n    loader.add(urls.filter(url => !loader.resources[url]).map((url) => {\n      return { parentResource: resource, url: url }\n    }))\n    let completed = 0\n\n    // Listen for resources being loaded.\n    let binding = loader.onLoad.add((loader: any, res: any) => {\n      if (urls.includes(res.url)) {\n        if (++completed === urls.length) {\n          // All resources used by cubemap has been loaded.\n          const textures = mipmaps.map(face => {\n            return <CubemapFaces>{\n              posx: Texture.from(face[0]),\n              negx: Texture.from(face[1]),\n              posy: Texture.from(face[2]),\n              negy: Texture.from(face[3]),\n              posz: Texture.from(face[4]),\n              negz: Texture.from(face[5]),\n            }\n          })\n          resource.cubemap = Cubemap.fromFaces(textures)\n          binding.detach(); next()\n        }\n      }\n    })\n  },\n  add: function () {\n    LoaderResource.setExtensionXhrType(\n      \"cubemap\", LoaderResource.XHR_RESPONSE_TYPE.JSON)\n  }\n}\n\nCompatibility.installLoaderPlugin(\"cubemap\", CubemapLoader)","import { LoaderResource } from \"@pixi/loaders\"\nimport { Compatibility } from \"../compatibility/compatibility\"\n\nconst EXTENSIONS = [\"glsl\", \"vert\", \"frag\"]\n\nexport const ShaderSourceLoader = {\n  use: (resource: any, next: () => void) => {\n    next()\n  },\n  add: function () {\n    for (let ext of EXTENSIONS) {\n      LoaderResource.setExtensionXhrType(\n        ext, LoaderResource.XHR_RESPONSE_TYPE.TEXT)\n    }\n  }\n}\n\nCompatibility.installLoaderPlugin(\"shader\", ShaderSourceLoader)","export var Shader = {\"source\":\"attribute vec3 a_Position;\\n\\nvarying vec3 v_Position;\\n\\nuniform mat4 u_ModelMatrix;\\nuniform mat4 u_View;\\nuniform mat4 u_Projection;\\n\\nvoid main() {\\n  v_Position = a_Position.xyz;\\n\\n  // Converting the view to 3x3 matrix and then back to 4x4 matrix \\n  // removes the translation. We do this because we want the skybox to \\n  // be centered around the camera.\\n  gl_Position = u_Projection * mat4(mat3(u_View)) * u_ModelMatrix * vec4(a_Position, 1.0);\\n}\"};","export namespace PickingId {\n  let id = 0\n  export function next() {\n    id++\n    return new Uint8Array([\n      (id >> 16) & 255, (id >> 8) & 255, id & 255\n    ])\n  }\n}","export var Shader = {\"source\":\"varying vec3 v_Position;\\n\\nuniform samplerCube u_EnvironmentSampler;\\n\\nvoid main() {\\n  gl_FragColor = vec4(textureCube(u_EnvironmentSampler, v_Position).rgb, 1.0);\\n}\"};","import { State, Renderer, Program } from \"@pixi/core\"\nimport { Cubemap } from \"../cubemap/cubemap\"\nimport { MeshShader } from \"../mesh/mesh-shader\"\nimport { Camera } from \"../camera/camera\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { Material } from \"../material/material\"\nimport { Shader as Vertex } from \"./shader/skybox.vert\"\nimport { Shader as Fragment } from \"./shader/skybox.frag\"\n\nexport class SkyboxMaterial extends Material {\n  private _cubemap: Cubemap\n\n  get cubemap() {\n    return this._cubemap\n  }\n\n  set cubemap(value: Cubemap) {\n    if (value !== this._cubemap) {\n      if (!this._cubemap.valid) {\n        // Remove the shader so it can be rebuilt with the current features. \n        // It may happen that we set a texture which is not yet valid, in that \n        // case we don't want to render the skybox until it has become valid.\n        this._shader = undefined\n      }\n      this._cubemap = value\n    }\n  }\n\n  camera?: Camera\n\n  constructor(cubemap: Cubemap) {\n    super()\n    this._cubemap = cubemap\n    this.state = Object.assign(new State(), {\n      culling: true, clockwiseFrontFace: true, depthTest: true, depthMask: false\n    })\n  }\n\n  updateUniforms(mesh: Mesh3D, shader: MeshShader) {\n    let camera = this.camera || Camera.main\n\n    shader.uniforms.u_ModelMatrix = mesh.worldTransform.array\n    shader.uniforms.u_View = camera.view\n    shader.uniforms.u_Projection = camera.projection\n    shader.uniforms.u_EnvironmentSampler = this.cubemap\n  }\n\n  render(mesh: Mesh3D, renderer: Renderer) {\n    // Disable writing to the depth buffer. This is because we want all other \n    // objects to be in-front of the skybox.\n    renderer.gl.depthMask(false)\n    super.render(mesh, renderer)\n    renderer.gl.depthMask(true)\n  }\n\n  createShader() {\n    if (this.cubemap.valid) {\n      return new MeshShader(Program.from(Vertex.source, Fragment.source))\n    }\n  }\n}","import { SkyboxMaterial } from \"./skybox-material\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { Container3D } from \"../container\"\nimport { Cubemap } from \"../cubemap/cubemap\"\nimport { Camera } from \"../camera/camera\"\nimport { CubemapFaces } from \"../cubemap/cubemap-faces\"\n\n/**\n * A skybox is a method of creating backgrounds in a 3D scene. It consists of\n * a cubemap texture which has six sides. Note that the skybox should be rendered \n * before all other objects in the scene.\n */\nexport class Skybox extends Container3D {\n  private _mesh: Mesh3D\n\n  /**\n   * Creates a new skybox using the specified cubemap.\n   * @param cubemap Cubemap to use for rendering.\n   */\n  constructor(cubemap: Cubemap) {\n    super()\n    this._mesh = this.addChild(Mesh3D.createCube(new SkyboxMaterial(cubemap)))\n    this._mesh.renderSortOrder = -1\n  }\n\n  /**\n   * Camera used when rendering. If this value is not set, the main camera will \n   * be used by default.\n   */\n  get camera() {\n    return (<SkyboxMaterial>this._mesh.material).camera\n  }\n\n  set camera(value: Camera | undefined) {\n    (<SkyboxMaterial>this._mesh.material).camera = value\n  }\n\n  /**\n   * The cubemap texture used when rendering.\n   */\n  get cubemap() {\n    return (<SkyboxMaterial>this._mesh.material).cubemap\n  }\n\n  set cubemap(value: Cubemap) {\n    (<SkyboxMaterial>this._mesh.material).cubemap = value\n  }\n\n  /**\n   * Creates a new skybox from the specified source.\n   * @param source The source to create the skybox from.\n   */\n  static from(source: CubemapFaces) {\n    return new Skybox(Cubemap.fromFaces(source))\n  }\n}","export var Shader = {\"source\":\"#version 100\\n\\nattribute vec3 a_Position;\\n\\nuniform mat4 u_ModelViewProjection;\\n\\nvoid main() {\\n  gl_Position = u_ModelViewProjection * vec4(a_Position, 1.0);\\n}\"};","export var Shader = {\"source\":\"#version 100\\n\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\n  precision highp float;\\n#else\\n  precision mediump float;\\n#endif\\n\\nuniform vec3 u_Id;\\n\\nvoid main() {\\n  gl_FragColor = vec4(u_Id / 255.0, 1.0);\\n}\"};","import { PickingHitArea } from \"./picking-hitarea\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { Camera } from \"../camera/camera\"\nimport { RenderTexture, Renderer, Program } from \"@pixi/core\"\nimport { Mat4 } from \"../math/mat4\"\nimport { MeshShader } from \"../mesh/mesh-shader\"\nimport { Shader as Vertex } from \"./shader/picking.vert\"\nimport { Shader as Fragment } from \"./shader/picking.frag\"\n\nexport class PickingMap {\n  private _pixels: Uint8Array\n  private _output: RenderTexture\n  private _shader: MeshShader\n  private _update = 0\n\n  constructor(private _renderer: Renderer, size: number) {\n    this._pixels = new Uint8Array(size * size * 4)\n    this._output = RenderTexture.create({ width: size, height: size, resolution: 1 })\n    this._shader = new MeshShader(Program.from(Vertex.source, Fragment.source))\n    this._output.framebuffer.addDepthTexture()\n  }\n\n  destroy() {\n    this._output.destroy(true)\n    this._shader.destroy()\n  }\n\n  resizeToAspect() {\n    const aspect = this._renderer.width / this._renderer.height\n    const aspectWidth = Math.floor(this._output.height * aspect)\n    if (this._output.width !== aspectWidth) {\n      this._pixels = new Uint8Array(aspectWidth * this._output.height * 4)\n      this._output.resize(aspectWidth, this._output.height)\n    }\n  }\n\n  containsId(x: number, y: number, id: Uint8Array) {\n    const { width, height } = this._renderer.screen\n\n    x = Math.floor(x / width * this._output.width)\n    y = Math.floor((height - y) / height * this._output.height)\n    for (let i = 0; i < 3; i++) {\n      if (id[i] !== this._pixels[(y * this._output.width + x) * 4 + i]) {\n        return false\n      }\n    }\n    return true\n  }\n\n  update(hitAreas: PickingHitArea[]) {\n    this._renderer.renderTexture.bind(this._output)\n    if (this._update++ % 2 === 0) {\n      // For performance reasons, the update method alternates between rendering \n      // the meshes and reading the pixels from the rendered texture.\n      this._renderer.renderTexture.clear()\n      for (let hitArea of hitAreas) {\n        this.renderHitArea(hitArea)\n      }\n    } else {\n      const gl = this._renderer.gl\n      gl.readPixels(0, 0, this._output.width, this._output.height, gl.RGBA, gl.UNSIGNED_BYTE, this._pixels)\n    }\n    this._renderer.renderTexture.bind(undefined)\n  }\n\n  private _matrix = new Float32Array(16)\n\n  renderHitArea(hitArea: PickingHitArea) {\n    const uniforms = this._shader.uniforms\n    const meshes = hitArea.object instanceof Mesh3D ? [hitArea.object] : hitArea.object.meshes\n    const camera = hitArea.camera || Camera.main\n    for (let mesh of meshes) {\n      uniforms.u_Id = hitArea.id\n      uniforms.u_ModelViewProjection = Mat4.multiply(\n        camera.viewProjection, mesh.transform.worldTransform.array, this._matrix)\n      this._shader.render(mesh, this._renderer)\n    }\n  }\n}","import { Ticker, UPDATE_PRIORITY } from \"@pixi/ticker\"\nimport { IRendererPlugin, Renderer } from \"@pixi/core\"\nimport { Point } from \"@pixi/math\"\nimport { PickingMap } from \"./picking-map\"\nimport { PickingHitArea } from \"./picking-hitarea\"\nimport { Compatibility } from \"../compatibility/compatibility\"\n\n/**\n * Manages the picking hit areas by keeping track on which hit areas needs to \n * be checked for interaction. Renders the hit area meshes to a texture which\n * is then used to map a mesh to a x/y coordinate. The picking manager is \n * registered as a renderer plugin.\n */\nexport class PickingInteraction implements IRendererPlugin {\n  private _map: PickingMap\n  private _hitAreas: PickingHitArea[] = []\n\n  /**\n   * Creates a new picking manager using the specified renderer.\n   * @param renderer The renderer to use.\n   */\n  constructor(public renderer: Renderer) {\n    this._map = new PickingMap(this.renderer, 128)\n    Ticker.shared.add(this._update, this, UPDATE_PRIORITY.LOW)\n    if (!PickingInteraction.main) {\n      PickingInteraction.main = this\n    }\n  }\n\n  /** The main picking interaction which is used by default. */\n  static main: PickingInteraction\n\n  private _update() {\n    if (!this.renderer.plugins) {\n      return\n    }\n    // Because of how PixiJS interaction works and the design of the picking,\n    // the \"hitTest\" function needs to be called. Otherwise, in some \n    // circumstances; the picking is affected by in which order the interaction \n    // object was added to the heirarchy.\n    this.renderer.plugins.interaction.hitTest(new Point(0, 0))\n    if (this._hitAreas.length > 0) {\n      this._map.resizeToAspect()\n      this._map.update(this._hitAreas); this._hitAreas = []\n    }\n  }\n\n  destroy() {\n    if (this === PickingInteraction.main) {\n      // @ts-ignore It's ok, main picking interaction was destroyed.\n      PickingInteraction.main = undefined\n    }\n    Ticker.shared.remove(this._update, this)\n  }\n\n  /**\n   * Hit tests a area using the specified x/y coordinates.\n   * @param x The x coordinate.\n   * @param y The y coordinate.\n   * @param hitArea The hit area to test.\n   */\n  containsHitArea(x: number, y: number, hitArea: PickingHitArea) {\n    if (this._hitAreas.indexOf(hitArea) < 0) {\n      this._hitAreas.push(hitArea)\n    }\n    return this._map.containsId(x, y, hitArea.id)\n  }\n}\n\nCompatibility.installRendererPlugin(\"picking\", PickingInteraction)","import { Renderer } from \"@pixi/core\"\nimport { IHitArea } from \"@pixi/interaction\"\nimport { PickingInteraction } from \"./picking-interaction\"\nimport { Mesh3D } from \"../mesh/mesh\"\nimport { Model } from \"../model\"\nimport { PickingId } from \"./picking-id\"\nimport { Camera } from \"../camera/camera\"\n\n/**\n * Hit area which uses the shape of an object to determine interaction.\n */\nexport class PickingHitArea implements IHitArea {\n  \n  /** The id which maps to the object. */\n  id = PickingId.next()\n\n  /**\n   * Creates a new hitarea using the specified object.\n   * @param renderer Not used, accepts any value. Only here for compatibility reasons.\n   * @param object The model or mesh to use as the shape for hit testing.\n   * @param camera The camera to use when rendering the object picking shape.\n   * If not set, the main camera will be used as default.\n   */\n  constructor(renderer: Renderer | undefined, public object: Mesh3D | Model, public camera?: Camera) {\n  }\n\n  contains(x: number, y: number) {\n    return PickingInteraction.main.containsHitArea(x, y, this)\n  }\n\n  /**\n   * Creates a new hitarea using the specified object.\n   * @param object The model or mesh to use as the shape for hit testing.\n   */\n  static fromObject(object: Mesh3D | Model) {\n    return new PickingHitArea(undefined, object)\n  }\n}\n","export enum ShadowQuality {\n  /**\n   * Low quality (8-bit) shadows.\n   */\n  low  = \"low\",\n  /**\n   * Medium quality (16-bit) shadows.\n   */\n  medium = \"medium\",\n  /**\n   * High quality (32-bit) shadows.\n   */\n  high = \"high\"\n}","import { Renderer, RenderTexture } from \"@pixi/core\"\nimport { SCALE_MODES, TYPES } from \"@pixi/constants\"\nimport { Capabilities } from \"../capabilities\"\nimport { ShadowQuality } from \"./shadow-quality\"\n\nexport namespace ShadowTexture {\n  export function create(renderer: Renderer, size: number, quality: ShadowQuality) {\n    let type = getSupportedType(renderer, quality)\n    return RenderTexture.create({\n      width: size, height: size, type: type, scaleMode: getSupportedScaleMode(renderer)\n    })\n  }\n\n  function getSupportedScaleMode(renderer: Renderer) {\n    if (Capabilities.supportsFloatLinear(renderer)) {\n      return SCALE_MODES.LINEAR\n    }\n    return SCALE_MODES.NEAREST\n  }\n\n  function getSupportedType(renderer: Renderer, quality: ShadowQuality) {\n    if (quality === ShadowQuality.high) {\n      if (Capabilities.isFloatFramebufferSupported(renderer)) {\n        return TYPES.FLOAT\n      }\n      if (Capabilities.isHalfFloatFramebufferSupported(renderer)) {\n        return TYPES.HALF_FLOAT\n      }\n    }\n    if (quality === ShadowQuality.medium && Capabilities.isHalfFloatFramebufferSupported(renderer)) {\n      return TYPES.HALF_FLOAT\n    }\n    return TYPES.UNSIGNED_BYTE\n  }\n}","import { DEG_TO_RAD } from \"@pixi/math\"\nimport { ShadowCastingLight } from \"./shadow-casting-light\"\nimport { Mat4 } from \"../math/mat4\"\nimport { LightType } from \"../lighting/light-type\"\nimport { Vec3 } from \"../math/vec3\"\nimport { Quat } from \"../math/quat\"\nimport { Camera } from \"../camera/camera\"\n\nexport namespace ShadowMath {\n\n  const _lightProjection = new Float32Array(16)\n  const _lightView = new Float32Array(16)\n  const _conjugateRotation = new Float32Array(4)\n  const _lightSpacePosition = new Float32Array(3)\n  const _lightSpaceForward = new Float32Array(3)\n  const _cameraTarget = new Float32Array(3)\n  const _cameraForward = new Float32Array(3)\n\n  export function calculateDirectionalLightViewProjection(shadowCastingLight: ShadowCastingLight) {\n    if (shadowCastingLight.light.type !== LightType.directional) {\n      return\n    }\n    let halfShadowArea = shadowCastingLight.shadowArea / 2\n    let worldTexelSize = (halfShadowArea * 2) / shadowCastingLight.shadowArea\n    let lightProjection = Mat4.ortho(-halfShadowArea, halfShadowArea,\n      -halfShadowArea, halfShadowArea, -halfShadowArea, halfShadowArea, _lightProjection)\n    let light = shadowCastingLight.light\n    let camera = shadowCastingLight.camera || Camera.main\n\n    if (camera && shadowCastingLight.followCamera) {\n      Vec3.scale(camera.worldTransform.forward, halfShadowArea, _cameraForward)\n      Vec3.add(camera.worldTransform.position, _cameraForward, _cameraTarget)\n      Vec3.transformQuat(_cameraTarget, Quat.conjugate(\n        shadowCastingLight.light.worldTransform.rotation, _conjugateRotation), _lightSpacePosition)\n\n      _lightSpacePosition[0] = worldTexelSize *\n        Math.floor(_lightSpacePosition[0] / worldTexelSize)\n      _lightSpacePosition[1] = worldTexelSize *\n        Math.floor(_lightSpacePosition[1] / worldTexelSize)\n\n      Vec3.transformQuat(_lightSpacePosition, light.worldTransform.rotation, _lightSpacePosition)\n      Vec3.add(_lightSpacePosition, light.worldTransform.forward, _lightSpaceForward)\n      Mat4.lookAt(_lightSpacePosition, _lightSpaceForward, light.worldTransform.up, _lightView)\n      Mat4.multiply(lightProjection, _lightView, shadowCastingLight.lightViewProjection)\n    } else {\n      Vec3.add(light.worldTransform.position,\n        shadowCastingLight.light.worldTransform.forward, _cameraTarget)\n      Mat4.lookAt(light.worldTransform.position,\n        _cameraTarget, light.worldTransform.up, _lightView)\n      Mat4.multiply(lightProjection, _lightView, shadowCastingLight.lightViewProjection)\n    }\n  }\n\n  export function calculateSpotLightViewProjection(shadowCastingLight: ShadowCastingLight) {\n    if (shadowCastingLight.light.type !== LightType.spot) {\n      return\n    }\n    let light = shadowCastingLight.light\n\n    Mat4.perspective(light.outerConeAngle * DEG_TO_RAD * 2, 1, 2, light.range, _lightProjection)\n    Vec3.add(light.worldTransform.position, light.worldTransform.forward, _cameraTarget)\n    Mat4.lookAt(light.worldTransform.position, _cameraTarget, light.worldTransform.up, _lightView)\n    Mat4.multiply(_lightProjection, _lightView, shadowCastingLight.lightViewProjection)\n  }\n}","import { RenderTexture, Renderer } from \"@pixi/core\"\nimport { Light } from \"../lighting/light\"\nimport { LightType } from \"../lighting/light-type\"\nimport { Camera } from \"../camera/camera\"\nimport { Capabilities } from \"../capabilities\"\nimport { ShadowTexture } from \"./shadow-texture\"\nimport { ShadowMath } from \"./shadow-math\"\nimport { ShadowQuality } from \"./shadow-quality\"\n\nexport interface ShadowCastingLightOptions {\n  /**\n   * The quality (precision) of the shadow. If the quality is not supported by\n   * current platform, a lower quality will be selected instead.\n   */\n  quality?: ShadowQuality\n  /**\n   * The size (both width and height) in pixels for the shadow texture. \n   * Increasing the size will improve the quality of the shadow.\n   */\n  shadowTextureSize?: number\n}\n\n/**\n * Contains the required components used for rendering a shadow casted by a light.\n */\nexport class ShadowCastingLight {\n  private _shadowTexture: RenderTexture\n  private _filterTexture: RenderTexture\n  private _lightViewProjection = new Float32Array(16)\n\n  /** The softness of the edges for the shadow. */\n  softness = 0\n\n  /**\n   * The area in units of the shadow when using directional lights. Reducing\n   * the area will improve the quality of the shadow.\n   */\n  shadowArea = 50\n\n  /** The light view projection matrix. */\n  get lightViewProjection() {\n    return this._lightViewProjection\n  }\n\n  /** The camera to follow when using directional lights. */\n  camera?: Camera\n\n  /**\n   * Value indicating if the shadow should follow the specified camera. If the \n   * camera is not set, the main camera will be used as default. Only available \n   * when using directional lights.\n   */\n  followCamera = true\n\n  /**\n   * The rendered shadow texture.\n   */\n  get shadowTexture() {\n    return this._shadowTexture\n  }\n\n  /**\n   * The rendered filter texture.\n   */\n  get filterTexture() {\n    return this._filterTexture\n  }\n\n  /**\n   * Creates a new shadow casting light used for rendering a shadow texture.\n   * @param renderer The renderer to use.\n   * @param light The light which is casting the shadow.\n   * @param options The options to use when creating the shadow texture.\n   */\n  constructor(public renderer: Renderer, public light: Light, options?: ShadowCastingLightOptions) {\n    if (light.type === LightType.point) {\n      throw new Error(\"PIXI3D: Only directional and spot lights are supported as shadow casters.\")\n    }\n    const { shadowTextureSize = 1024, quality = ShadowQuality.medium } = options || {}\n\n    this._shadowTexture = ShadowTexture.create(renderer, shadowTextureSize, quality)\n    this._shadowTexture.baseTexture.framebuffer.addDepthTexture()\n    this._filterTexture = ShadowTexture.create(renderer, shadowTextureSize, quality)\n  }\n\n  /**\n   * Destroys the shadow casting light and it's used resources.\n   */\n  destroy() {\n    this._shadowTexture.destroy(true)\n    this._filterTexture.destroy(true)\n  }\n\n  /**\n   * Clears the rendered shadow texture.\n   */\n  clear() {\n    this.renderer.renderTexture.bind(this._shadowTexture)\n    this.renderer.renderTexture.clear([0, 0, 0, 0], this.renderer.gl.COLOR_BUFFER_BIT | this.renderer.gl.DEPTH_BUFFER_BIT)\n    this.renderer.renderTexture.bind(undefined)\n  }\n\n  /**\n   * Updates the light view projection matrix.\n   */\n  updateLightViewProjection() {\n    if (this.light.type === LightType.directional) {\n      ShadowMath.calculateDirectionalLightViewProjection(this)\n    } else if (this.light.type === LightType.spot) {\n      ShadowMath.calculateSpotLightViewProjection(this)\n    }\n  }\n\n  /**\n   * Returns a value indicating if medium quality (16-bit precision) shadows is \n   * supported by current platform.\n   * @param renderer The renderer to use.\n   */\n  static isMediumQualitySupported(renderer: Renderer) {\n    return Capabilities.isHalfFloatFramebufferSupported(renderer)\n  }\n\n  /**\n   * Returns a value indicating if high quality (32-bit precision) shadows is \n   * supported by current platform.\n   * @param renderer The renderer to use.\n   */\n  static isHighQualitySupported(renderer: Renderer) {\n    return Capabilities.isFloatFramebufferSupported(renderer)\n  }\n}","import { Ray } from \"./ray\"\nimport { Vec3 } from \"./vec3\"\n\nfunction approximately(a: number, b: number) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\n\nconst EPSILON = 0.000001\n\nexport class Plane {\n  private _normal = new Float32Array(3)\n\n  constructor(normal: Float32Array, public distance: number) {\n    Vec3.normalize(normal, this._normal)\n  }\n\n  get normal() {\n    return this._normal\n  }\n\n  rayCast(ray: Ray) {\n    const vdot = Vec3.dot(ray.direction, this.normal)\n    if (approximately(vdot, 0)) {\n      return 0\n    }\n    const ndot = -Vec3.dot(ray.origin, this.normal) - this.distance\n    return ndot / vdot\n  }\n}","/**\n * Represents different billboard types.\n */\nexport enum SpriteBillboardType {\n  /**\n   * Sprite will be rotated towards the viewer on both the x-plane and y-plane.\n   */\n  spherical = \"spherical\",\n  /**\n   * Sprite will be rotated towards the viewer on the y-plane.\n   */\n  cylindrical = \"cylindrical\",\n}","import { Sprite } from \"@pixi/sprite\"\nimport { Texture, Resource } from \"@pixi/core\"\nimport { settings } from \"@pixi/settings\"\n\nexport class ProjectionSprite extends Sprite {\n  private _pixelsPerUnit = 100\n\n  distanceFromCamera = 0\n  modelViewProjection = new Float32Array(16)\n\n  constructor(texture?: Texture<Resource>) {\n    super(texture)\n    this.pluginName = \"pipeline\"\n  }\n\n  get pixelsPerUnit() {\n    return this._pixelsPerUnit\n  }\n\n  set pixelsPerUnit(value: number) {\n    if (value !== this._pixelsPerUnit) {\n      // @ts-ignore\n      this._transformID = -1\n      this._pixelsPerUnit = value\n    }\n  }\n\n  calculateVertices() {\n    const texture = this._texture\n    // @ts-ignore\n    if (this._transformID === this.transform._worldID && this._textureID === texture._updateID) {\n      return\n    }\n    if (this._textureID !== texture._updateID) {\n      this.uvs = this._texture._uvs.uvsFloat32\n    }\n    // @ts-ignore\n    this._transformID = this.transform._worldID\n    this._textureID = texture._updateID\n\n    const wt = this.transform.worldTransform;\n    const orig = texture.orig\n    const anchor = this._anchor\n\n    const w1 = texture.trim ? texture.trim.x - (anchor._x * orig.width) : -anchor._x * orig.width\n    const w0 = texture.trim ? w1 + texture.trim.width : w1 + orig.width\n    const h1 = texture.trim ? texture.trim.y - (anchor._y * orig.height) : -anchor._y * orig.height\n    const h0 = texture.trim ? h1 + texture.trim.height : h1 + orig.height\n\n    this.vertexData[0] = ((wt.a * w1) + (wt.c * -h1)) / this._pixelsPerUnit\n    this.vertexData[1] = ((wt.d * -h1) + (wt.b * w1)) / this._pixelsPerUnit\n\n    this.vertexData[2] = ((wt.a * w0) + (wt.c * -h1)) / this._pixelsPerUnit\n    this.vertexData[3] = ((wt.d * -h1) + (wt.b * w0)) / this._pixelsPerUnit\n\n    this.vertexData[4] = ((wt.a * w0) + (wt.c * -h0)) / this._pixelsPerUnit\n    this.vertexData[5] = ((wt.d * -h0) + (wt.b * w0)) / this._pixelsPerUnit\n\n    this.vertexData[6] = ((wt.a * w1) + (wt.c * -h0)) / this._pixelsPerUnit\n    this.vertexData[7] = ((wt.d * -h0) + (wt.b * w1)) / this._pixelsPerUnit\n\n    if (this.roundPixels) {\n      const resolution = settings.RESOLUTION\n      for (var i = 0; i < this.vertexData.length; ++i) {\n        this.vertexData[i] = Math.round((this.vertexData[i] * resolution | 0) / resolution)\n      }\n    }\n  }\n}","import { Renderer, Texture, Resource } from \"@pixi/core\"\nimport { IDestroyOptions } from \"@pixi/display\"\nimport { BLEND_MODES } from \"@pixi/constants\"\nimport { ObservablePoint } from \"@pixi/math\"\nimport { Camera } from \"../camera/camera\"\nimport { Mat4 } from \"../math/mat4\"\nimport { Vec3 } from \"../math/vec3\"\nimport { SpriteBillboardType } from \"./sprite-billboard-type\"\nimport { Container3D } from \"../container\"\nimport { ProjectionSprite } from \"./projection-sprite\"\n\nconst vec3 = new Float32Array(3)\n\n/**\n * Represents a sprite in 3D space.\n */\nexport class Sprite3D extends Container3D {\n  private _sprite: ProjectionSprite\n  private _modelView = new Float32Array(16)\n  private _cameraTransformId?: number\n  private _billboardType?: SpriteBillboardType\n  private _parentID?: number\n\n  /**\n   * The camera used when rendering the sprite. Uses main camera by default.\n   */\n  camera?: Camera\n\n  /**\n   * Creates a new sprite using the specified texture.\n   * @param texture The texture to use.\n   */\n  constructor(texture: Texture<Resource>) {\n    super()\n    this._sprite = new ProjectionSprite(texture)\n    this._sprite.anchor.set(0.5)\n  }\n\n  /**\n   * The billboard type to use when rendering the sprite. Used for making the \n   * sprite always face the viewer.\n   */\n  get billboardType() {\n    return this._billboardType\n  }\n\n  set billboardType(value: SpriteBillboardType | undefined) {\n    if (value !== this._billboardType) {\n      this._billboardType = value\n      this._cameraTransformId = undefined\n    }\n  }\n\n  /** Defines the size of the sprite relative to a unit in world space. */\n  get pixelsPerUnit() {\n    return this._sprite.pixelsPerUnit\n  }\n\n  set pixelsPerUnit(value: number) {\n    this._sprite.pixelsPerUnit = value\n  }\n\n  /**\n   * The tint applied to the sprite. This is a hex value. A value of 0xFFFFFF \n   * will remove any tint effect.\n   */\n  get tint() {\n    return this._sprite.tint\n  }\n\n  set tint(value: number) {\n    this._sprite.tint = value\n  }\n\n  /**\n   * Destroys this sprite and optionally its texture and children.\n   */\n  destroy(options?: boolean | IDestroyOptions) {\n    super.destroy(options)\n    this._sprite.destroy(options)\n  }\n\n  /**\n   * Renders the sprite.\n   * @param renderer The renderer to use.\n   */\n  _render(renderer: Renderer) {\n    const camera = this.camera || Camera.main\n    const update = camera.transformId !== this._cameraTransformId ||\n      this._parentID !== this.transform._worldID\n\n    if (update) {\n      const scaling = this.worldTransform.scaling\n      Mat4.multiply(camera.view, this.worldTransform.array, this._modelView)\n      switch (this._billboardType) {\n        case SpriteBillboardType.spherical: {\n          this._modelView[0] = scaling[0]\n          this._modelView[1] = 0\n          this._modelView[2] = 0\n          this._modelView[3] = 0\n          this._modelView[4] = 0\n          this._modelView[5] = scaling[1]\n          this._modelView[6] = 0\n          this._modelView[7] = 0\n          break\n        }\n        case SpriteBillboardType.cylindrical: {\n          this._modelView[0] = scaling[0]\n          this._modelView[1] = 0\n          this._modelView[2] = 0\n          this._modelView[3] = 0\n          this._modelView[8] = 0\n          this._modelView[9] = 0\n          this._modelView[10] = 1\n          this._modelView[11] = 0\n          break\n        }\n      }\n      Mat4.multiply(camera.projection,\n        this._modelView, this._sprite.modelViewProjection)\n      this._parentID = this.transform._worldID\n      this._cameraTransformId = camera.transformId\n      const dir = Vec3.subtract(camera.worldTransform.position, this.worldTransform.position, vec3)\n      const projection = Vec3.scale(camera.worldTransform.forward,\n        Vec3.dot(dir, camera.worldTransform.forward), vec3)\n      this._sprite.distanceFromCamera = Vec3.squaredMagnitude(projection)\n    }\n    this._sprite.worldAlpha = this.worldAlpha\n    this._sprite.render(renderer)\n  }\n\n  /**\n   * The anchor sets the origin point of the sprite.\n   */\n  get anchor() {\n    return this._sprite.anchor\n  }\n\n  set anchor(value: ObservablePoint) {\n    this._sprite.anchor = value\n  }\n\n  /** The texture used when rendering the sprite. */\n  get texture() {\n    return this._sprite.texture\n  }\n\n  set texture(value: Texture<Resource>) {\n    this._sprite.texture = value\n  }\n\n  /** The blend used when rendering the sprite. */\n  get blendMode() {\n    return this._sprite.blendMode\n  }\n\n  set blendMode(value: BLEND_MODES) {\n    this._sprite.blendMode = value\n  }\n}"],"names":["Version530","prototype","installRendererPlugin","name","plugin","Renderer","registerPlugin","installLoaderPlugin","Loader","render","renderer","object","renderTexture","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","call","__extends","TypeError","String","__","this","constructor","create","__values","o","s","Symbol","iterator","m","i","length","next","value","done","__read","n","r","e","ar","push","error","__spreadArray","to","from","pack","arguments","l","slice","concat","CompatibilityAccess","Version600","_super","get","obj","key","Version650","extension","type","PixiCore","RendererPlugin","add","Compatibility","glTFAsset","descriptor","buffers","images","load","loader","cb","asset","loadBuffers","forEach","buffer","loadImages","image","isValidBuffer","header","Uint32Array","isEmbeddedResource","uri","startsWith","fromBuffer","data","chunks","offset","byteLength","json","Uint8Array","JSON","parse","TextDecoder","decode","embeddedImages","filter","img","bufferView","map","index","externalImages","bufferImages","Texture","Error","loadExternalImage","resource","texture","loadBufferImage","view","bufferViews","array","byteOffset","blob","Blob","mimeType","reader","FileReader","onload","result","readAsDataURL","loadImageFromBuffer","externalImagesCount","bufferImagesCount","embeddedBuffers","atob","split","c","charCodeAt","externalBuffers","loadExternalBuffer","externalBuffersCount","glTFLoader","use","glTFExternalResourceLoader","gltf","assign","LoaderResource","setExtensionXhrType","XHR_RESPONSE_TYPE","BUFFER","_loader","_resource","onComplete","url","substring","lastIndexOf","resources","binding_1","onProgress","_","detach","parentResource","glTFBinaryLoader","ObservablePoint3D","scope","x","y","z","_this","_array","Float32Array","set","defineProperty","setFrom","clone","copyFrom","copyTo","equals","ObservablePoint","EPSILON","ARRAY_TYPE","identity","out","getScaling","mat","m11","m12","m13","m21","m22","m23","m31","m32","m33","Math","hypot","glMatrix.ARRAY_TYPE","a","fromValues","normalize","len","sqrt","dot","cross","ax","ay","az","bx","by","bz","w","slerp","t","omega","cosom","sinom","scale0","scale1","aw","bw","glMatrix.EPSILON","acos","sin","vec","vec4.fromValues","vec4.set","vec3.create","vec3.fromValues","Quat","quat.set","quat.fromValues","quat.create","quat.normalize","quat.slerp","fromEuler","halfToRad","PI","sx","cx","cos","sy","cy","sz","cz","quat.fromEuler","conjugate","quat.conjugate","rotateX","rad","quat.rotateX","rotateY","quat.rotateY","rotateZ","quat.rotateZ","ObservableQuaternion","setEulerAngles","Mat4","getTranslation","mat4.getTranslation","mat4.create","translate","v","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","mat4.translate","mat4.getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","mat4.getRotation","copy","mat4.copy","fromQuat","q","x2","y2","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","mat4.fromQuat","fromRotationTranslationScale","xy","xz","yz","mat4.fromRotationTranslationScale","fromRotation","axis","mat4.fromRotation","fromScaling","mat4.fromScaling","fromTranslation","mat4.fromTranslation","multiply","a30","a31","a32","a33","b0","b1","b2","b3","mat4.multiply","lookAt","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","abs","mat4.lookAt","mat4.identity","perspective","fovy","aspect","near","far","nf","f","tan","Infinity","mat4.perspective","ortho","left","right","bottom","top","lr","bt","mat4.ortho","invert","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","mat4.invert","transpose","mat4.transpose","targetTo","target","mat4.targetTo","mat4.rotateX","mat4.rotateY","mat4.rotateZ","rotate","b12","b20","b21","b22","mat4.rotate","scale","mat4.scale","Vec3","vec3.set","vec3.add","transformQuat","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","vec3.transformQuat","subtract","vec3.subtract","vec3.scale","vec3.dot","vec3.normalize","vec3.cross","transformMat4","vec3.transformMat4","vec3.copy","magnitude","vec3.length","squaredMagnitude","vec3.squaredLength","inverse","vec3.inverse","negate","vec3.negate","vec3.multiply","distance","vec3.distance","squaredDistance","vec3.squaredDistance","lerp","vec3.lerp","Vec4","vec4.transformMat4","MatrixComponent","_parent","size","_update","_id","transformId","Matrix4","_transformId","toArray","_position","_scaling","_rotation","matrix_1","_b","_c","col","_up","_down","_right","_left","forward","_forward","_backward","matrix","setFromRotationPositionScale","rotation","position","Matrix","Transform3D","apply","onChange","rotationQuaternion","worldTransform","localTransform","inverseWorldTransform","normalTransform","updateLocalTransform","_localID","_currentLocalID","_parentID","setFromMatrix","updateTransform","parentTransform","_worldID","point","rot","Transform","Container3D","transform","Container","Ray","origin","direction","_direction","_origin","getPoint","vec3","mat4","vec4","Camera","_orthographic","_orthographicSize","_obliqueness","undefined","_fieldOfView","_near","_far","width","height","localID","on","_aspect","parent","main","destroy","options","screenToRay","viewSize","screen","screenToWorld","orthographic","_a","invertedViewProjection","viewProjection","clipSpace","worldSpace","worldToScreen","Point","projection","_projection","DEG_TO_RAD","_view","_viewProjection","PlaneGeometry","CubeGeometry","QuadGeometry","CameraOrbitControl","element","camera","_distance","_grabbed","_angles","min","max","allowControl","updateCamera","plugins","interaction","stopped","addEventListener","event","buttons","movementY","movementX","deltaY","preventDefault","dir","pos","Number","MAX_SAFE_INTEGER","MeshGeometry3D","_shaderGeometry","getShaderGeometry","shader","addShaderGeometry","instanced","createShaderGeometry","hasShaderGeometry","name_1","positions","indices","normals","uvs","tangents","LightType","StandardMaterialAlphaMode","StandardMaterialDebugMode","Capabilities","InstancedMesh3D","mesh","material","removeInstance","exports","_maxVertexUniformVectors","_isFloatTextureSupported","_isHalfFloatFramebufferSupported","_isFloatFramebufferSupported","_isFloatLinearSupported","_isInstancingSupported","getMaxVertexUniformVectors","gl","getParameter","MAX_VERTEX_UNIFORM_VECTORS","isFloatingPointTextureSupported","context","webGLVersion","getExtension","isHalfFloatFramebufferSupported","ext","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","HALF_FLOAT_OES","fb","createFramebuffer","bindFramebuffer","FRAMEBUFFER","attachmentPoint","COLOR_ATTACHMENT0","framebufferTexture2D","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","isFloatFramebufferSupported","FLOAT","supportsFloatLinear","isShaderTextureLodSupported","isInstancingSupported","Message","StandardMaterialFeatureSet","BufferResource","StandardMaterialMatrixTexture","matrixCount","BaseTexture","mipmap","MIPMAP_MODES","OFF","wrapMode","WRAP_MODES","CLAMP","scaleMode","SCALE_MODES","NEAREST","format","FORMATS","TYPES","alphaMode","ALPHA_MODES","NO_PREMULTIPLIED_ALPHA","resolution","_buffer","isSupported","updateBuffer","baseTexture","update","Debug","messages","eventEmitter","EventEmitter","formatMessage","message","args","match","formatted","exec","replace","fn","warn","includes","console","emit","build","geometry","lightingEnvironment","features","instances","colors","targets","targetWeights","joints","weights","skin","uniformsRequiredForOtherFeatures","availableVertexUniforms","uniformsRequiredPerJoint","maxJointCount","floor","uniformsSupported","addFeatureSetForUniforms","addFeatureSetForTextures","settings","PREFER_UNIFORMS_WHEN_UPLOADING_SKIN_JOINTS","meshVertexSkinningNumberOfJointsNotSupported","maxJoints","meshVertexSkinningFloatingPointTexturesNotSupported","addSkinningFeatures","unlit","lights","imageBasedLighting","valid","imageBasedLightingShaderTextureLodNotSupported","shadowCastingLight","baseColorTexture","emissiveTexture","normalTexture","metallicRoughnessTexture","occlusionTexture","opaque","mask","debugMode","alpha","emissive","f0","metallic","normal","occlusion","roughness","hasSkinningTextureFeature","StandardShaderSource","MeshShader","_state","State","culling","clockwiseFrontFace","depthTest","Geometry","BYTES_PER_ELEMENT","addIndex","Buffer","Uint16Array","addAttribute","componentType","stride","state","drawMode","DRAW_MODES","TRIANGLES","instanceCount","worldVisible","renderable","instancing","bind","draw","Shader","StandardShaderInstancing","_maxInstances","_modelMatrix","_normalMatrix","_baseColor","expandBuffers","updateBuffers","bufferIndex","j","model","baseColor","rgba","addGeometryAttributes","source","join","MaterialRenderSortType","StandardShader","_instancing","Program","Primitive","MetallicRoughness","filteredInstances","instance","Material","_renderSortType","renderSortType","depthMask","blendMode","createShader","updateUniforms","createInstance","_shader","vertexSrc","fragmentSrc","LightingEnvironment","light","SphereGeometry","StandardMaterialSkinUniforms","enableJointMatrixTextures","jointsCount","_jointMatrixTexture","_jointNormalTexture","jointMatrices","uniforms","u_jointMatrixSampler","u_jointMatrix","jointNormalMatrices","u_jointNormalMatrixSampler","u_jointNormalMatrix","Color","g","_array4","_array3","subarray","fromBytes","fromHex","hex","parseInt","InstancedStandardMaterial","glTFMaterial","alphaCutoff","doubleSided","emissiveFactor","Mat3","mat3.multiply","TextureTransform","_dirty","_translation","_rotate","fromTexture","frame","noFrame","StandardMaterialTexture","uvSet","StandardMaterialNormalTexture","StandardMaterialOcclusionTexture","strength","StandardMaterialFactory","StandardMaterial","texCoord","createTextureTransform","blend","transparent","ImageBasedLighting","diffuse","specular","_diffuse","_specular","lookupBrdf","defaultLookupBrdf","shaders","getLightingEnvironmentConfigId","env","_lightingEnvironmentConfigId","_unlit","_alphaMode","_baseColorFactor","_instancingEnabled","_skinUniforms","exposure","_baseColorTexture","invalidateShader","_metallicRoughnessTexture","_normalTexture","_occlusionTexture","_emissiveTexture","_shadowCastingLight","_debugMode","_lightingEnvironment","_d","_e","lighting","configId","extensions_1","extensions_1_1","checksum","worldAlpha","u_Camera","u_ViewProjectionMatrix","u_Exposure","u_MetallicFactor","u_RoughnessFactor","u_BaseColorFactor","u_ModelMatrix","u_NormalMatrix","u_AlphaCutoff","u_morphWeights","u_BaseColorSampler","u_BaseColorUVSet","u_BaseColorUVTransform","directional","spot","range","color","rgb","intensity","innerConeAngle","outerConeAngle","u_ShadowSampler","shadowTexture","u_LightViewProjectionMatrix","lightViewProjection","u_ShadowLightIndex","indexOf","u_DiffuseEnvSampler","u_SpecularEnvSampler","u_brdfLUT","u_MipCount","levels","u_EmissiveSampler","u_EmissiveUVSet","u_EmissiveFactor","u_EmissiveUVTransform","u_NormalSampler","u_NormalScale","u_NormalUVSet","u_NormalUVTransform","u_MetallicRoughnessSampler","u_MetallicRoughnessUVSet","u_MetallicRoughnessUVTransform","u_OcclusionSampler","u_OcclusionStrength","u_OcclusionUVSet","u_OcclusionUVTransform","AABB","_onChanged","_center","_min","_max","_extents","_size","aabb","encapsulate","radius","segments","rings","grid","iy","vertices","uOffset","ix","u","Mesh3D","pluginName","enabledRenderPasses","renderSortOrder","_instances","splice","enableRenderPass","disableRenderPass","isRenderPassEnabled","_render","batch","setObjectRenderer","calculateJointMatrices","getBoundingBox","temp","createQuad","createCube","createPlane","createSphere","Animation","speed","loop","play","ticker","Ticker","shared","_ticker","deltaMS","stop","remove","delta","duration","glTFAnimation","channels","_duration","_channels","channels_1","channels_1_1","channel","glTFAttribute","Int8Array","Int16Array","Skin","_jointMatrices","_jointNormalMatrices","_transformIds","inverseBindMatrix","Joint","glTFLinear","_output","_stride","_data","interpolate","pos1","pos2","glTFCubicSpline","_input","diff","calculate","p0","p1","m0","m1","pow","glTFStep","glTFInterpolationFactory","input","output","glTFChannel","interpolation","_frame","_interpolation","setPosition","calculateFrame","updateTarget","calculateFramePosition","glTFRotation","_transform","glTFScale","glTFSphericalLinear","glTFTranslation","glTFWeights","_weights","glTFChannelFactory","path","children","glTFParser","materialFactory","_textures","_asset","_materialFactory","_descriptor","textures","parseTexture","createModel","parseModel","createMesh","parseMesh","parseBuffer","accessor","accessors","count","componentCount","byteStride","componentSize","parseAnimation","animation","nodes","animations","sampler","samplers","animationChannel","node","parseMaterial","materials","extensions","KHR_texture_transform","pbr","pbrMetallicRoughness","baseColorFactor","metallicFactor","roughnessFactor","REPEAT","wrapS","MIRRORED_REPEAT","meshes","primitives","primitive","parsePrimitive","parseSkin","skins","joint","attributes","parseNode","inverseBindMatrices","container","translation","scene","scenes","Model","createHierarchy","addChild","_f","child","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","InstancedModel","mesh_1","Light","MaterialRenderPass","clearColor","_renderTexture","clear","current","meshes_1","meshes_1_1","ShadowFilter","_mesh","_gaussianBlurShader","Vertex","Fragment","applyGaussianBlur","applyBlurScale","filterTexture","softness","u_FilterSampler","u_BlurScale","ShadowShader","SkinningShader","getMaxJointCount","_maxSupportedJoints","TextureShader","ShadowRenderer","BLEND_MODES","NONE","_shadowShader","getSkinningShader","_textureShader","_skinningShader","skinningShader","maxSupportedJoints","ShadowRenderPass","_lights","_filter","_shadow","addShadowCastingLight","removeShadowCastingLight","updateLightViewProjection","e_3","PostProcessingSprite","_tickerRender","objectToRender","RenderTexture","framebuffer","addDepthTexture","_texture","resize","renderObject","depthTexture","setResolution","Sprite","SpriteBatchGeometry","BatchGeometry","SpriteBatchRenderer","shaderGenerator","BatchShaderGenerator","geometryClass","vertexSize","packInterleavedGeometry","attributeBuffer","indexBuffer","aIndex","iIndex","uint32View","float32View","packedVertices","indicies","vertexData","textureId","_batchLocation","argb","premultiplyTint","_tintRGB","modelViewProjection","AbstractBatchRenderer","StandardPipeline","_meshes","_sprites","materialPass","shadowPass","renderPasses","pass","_spriteRenderer","createPostProcessingSprite","sprite","isSprite","flush","sort","this_1","start","zIndex","distanceFromCamera","enableShadows","disableShadows","meshes_2","meshes_2_1","ObjectRenderer","ArrayResource","BaseImageResource","MipmapResource","upload","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK","items","CubemapResource","style","texParameteri","TEXTURE_CUBE_MAP","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","LINEAR","CubeResource","Cubemap","fromFaces","faces","isArray","face","TARGETS","TEXTURE_CUBE_MAP_POSITIVE_X","fromColors","posx","negx","posy","negy","posz","negz","UNSIGNED_BYTE","RGB","CubemapLoader","mipmaps","urls","reduce","acc","val","completed","binding","onLoad","res","cubemap","EXTENSIONS","ShaderSourceLoader","EXTENSIONS_1","EXTENSIONS_1_1","TEXT","PickingId","SkyboxMaterial","_cubemap","u_View","u_Projection","u_EnvironmentSampler","Skybox","PickingMap","_renderer","_matrix","_pixels","resizeToAspect","aspectWidth","containsId","id","hitAreas","hitAreas_1","hitAreas_1_1","hitArea","renderHitArea","readPixels","u_Id","u_ModelViewProjection","PickingInteraction","_hitAreas","_map","UPDATE_PRIORITY","LOW","hitTest","containsHitArea","ShadowQuality","ShadowTexture","ShadowMath","PickingHitArea","contains","fromObject","getSupportedScaleMode","quality","high","HALF_FLOAT","medium","getSupportedType","_lightProjection","_lightView","_conjugateRotation","_lightSpacePosition","_lightSpaceForward","_cameraTarget","_cameraForward","calculateDirectionalLightViewProjection","halfShadowArea","shadowArea","worldTexelSize","lightProjection","followCamera","calculateSpotLightViewProjection","ShadowCastingLight","_lightViewProjection","shadowTextureSize","_shadowTexture","_filterTexture","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","isMediumQualitySupported","isHighQualitySupported","SpriteBillboardType","Plane","_normal","rayCast","ray","vdot","ProjectionSprite","_pixelsPerUnit","_transformID","calculateVertices","_textureID","_updateID","_uvs","uvsFloat32","wt","orig","anchor","_anchor","w1","trim","_x","w0","h1","_y","h0","roundPixels","RESOLUTION","round","Sprite3D","_modelView","_sprite","_billboardType","_cameraTransformId","pixelsPerUnit","tint","spherical","cylindrical"],"mappings":"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"}